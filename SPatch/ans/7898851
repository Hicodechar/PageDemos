
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <title>[POC,61/83] switch obvious cases to get_free_page() - Patchwork</title>
  <link rel="stylesheet" type="text/css" href="/static/css/style.css"/>
  <script type="text/javascript" src="/static/js/common.js"></script>
  <script type="text/javascript" src="/static/js/jquery-1.10.1.min.js"></script>

 </head>
 <body>
  <div id="title">
  <h1 style="float: left;">
     <a
      href="/">Patchwork</a>
    [POC,61/83] switch obvious cases to get_free_page()</h1>
  <div id="auth">

     <a href="/user/login/">login</a>
     <br/>
     <a href="/register/">register</a>
     <br/>
     <a href="/mail/">mail settings</a>

   </div>
   <div style="clear: both;"></div>
  </div>
  <div id="nav">
   <div id="navleft">
   
    <strong>Project</strong>: LKML
     :
     <a href="/project/LKML/list/"
      >patches</a>
     :
     <a href="/project/LKML/"
      >project info</a>
    
     :
     <a href="/"
     >other projects</a>
     
    
   </div>
   <div id="navright">
    <a href="/help/about/">about</a>
   </div>
   <div style="clear: both"></div>
  </div>

  <div id="content">

<script language="JavaScript" type="text/javascript">
function toggle_headers(link_id, headers_id)
{
    var link = document.getElementById(link_id)
    var headers = document.getElementById(headers_id)

    var hidden = headers.style['display'] == 'none';

    if (hidden) {
        link.innerHTML = 'hide';
        headers.style['display'] = 'block';
    } else {
        link.innerHTML = 'show';
        headers.style['display'] = 'none';
    }

}
</script>

<table class="patchmeta">
 <tr>
  <th>Submitter</th>
  <td><a href="/project/LKML/list/?submitter=159">Al Viro</a></td>
 </tr>
 <tr>
  <th>Date</th>
  <td>Dec. 21, 2015, 11:47 p.m.</td>
 </tr>
 <tr>
  <th>Message ID</th>
  <td>&lt;1450741676-5865-61-git-send-email-viro@ZenIV.linux.org.uk&gt;</td>
 </tr>
 <tr>
  <th>Download</th>
  <td>
   <a href="/patch/7898851/mbox/"
   >mbox</a>
|
   <a href="/patch/7898851/raw/"
   >patch</a>

   </td>
 </tr>
 <tr>
  <th>Permalink</th>
  <td><a href="/patch/7898851/">/patch/7898851/</a>
 </tr>
  <tr>
   <th>State</th>
   <td>New</td>
  </tr>


 <tr>
  <th>Headers</th>
  <td><a id="togglepatchheaders"
   href="javascript:toggle_headers('togglepatchheaders', 'patchheaders')"
   >show</a>
   <div id="patchheaders" class="patchheaders" style="display:none;">
    <pre>Return-Path: &lt;linux-kernel-owner@kernel.org&gt;
X-Original-To: patchwork-LKML@patchwork.kernel.org
Delivered-To: patchwork-parsemail@patchwork1.web.kernel.org
Received: from mail.kernel.org (mail.kernel.org [198.145.29.136])
	by patchwork1.web.kernel.org (Postfix) with ESMTP id 3BDBA9F32E
	for &lt;patchwork-LKML@patchwork.kernel.org&gt;;
	Mon, 21 Dec 2015 23:51:58 +0000 (UTC)
Received: from mail.kernel.org (localhost [127.0.0.1])
	by mail.kernel.org (Postfix) with ESMTP id 0677220595
	for &lt;patchwork-LKML@patchwork.kernel.org&gt;;
	Mon, 21 Dec 2015 23:51:53 +0000 (UTC)
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.kernel.org (Postfix) with ESMTP id 7FC1B2058A
	for &lt;patchwork-LKML@patchwork.kernel.org&gt;;
	Mon, 21 Dec 2015 23:51:47 +0000 (UTC)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1753073AbbLUXvi (ORCPT
	&lt;rfc822;patchwork-LKML@patchwork.kernel.org&gt;);
	Mon, 21 Dec 2015 18:51:38 -0500
Received: from zeniv.linux.org.uk ([195.92.253.2]:33098 &quot;EHLO
	ZenIV.linux.org.uk&quot; rhost-flags-OK-OK-OK-OK) by vger.kernel.org
	with ESMTP id S1752356AbbLUXsK (ORCPT
	&lt;rfc822;linux-kernel@vger.kernel.org&gt;);
	Mon, 21 Dec 2015 18:48:10 -0500
Received: from viro by ZenIV.linux.org.uk with local (Exim 4.76 #1 (Red Hat
	Linux)) id 1aBABU-0001aw-Q0; Mon, 21 Dec 2015 23:48:08 +0000
From: Al Viro &lt;viro@ZenIV.linux.org.uk&gt;
To: linux-kernel@vger.kernel.org
Cc: Linus Torvalds &lt;torvalds@linux-foundation.org&gt;
Subject: [POC][PATCH 61/83] switch obvious cases to get_free_page()
Date: Mon, 21 Dec 2015 23:47:34 +0000
Message-Id: &lt;1450741676-5865-61-git-send-email-viro@ZenIV.linux.org.uk&gt;
X-Mailer: git-send-email 1.7.7.6
In-Reply-To: &lt;20151221234615.GW20997@ZenIV.linux.org.uk&gt;
References: &lt;20151221234615.GW20997@ZenIV.linux.org.uk&gt;
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: &lt;linux-kernel.vger.kernel.org&gt;
X-Mailing-List: linux-kernel@vger.kernel.org
X-Spam-Status: No, score=-6.9 required=5.0 tests=BAYES_00, RCVD_IN_DNSWL_HI, 
	RP_MATCHES_RCVD,
	UNPARSEABLE_RELAY autolearn=unavailable version=3.3.1
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on mail.kernel.org
X-Virus-Scanned: ClamAV using ClamSMTP
</pre>
   </div>
  </td>
 </tr>
</table>

<div class="patchforms">





 <div style="clear: both;">
 </div>
</div>



<h2>Comments</h2>

<div class="comment">
<div class="meta"><a href="/project/LKML/list/?submitter=159">Al Viro</a> - Dec. 21, 2015, 11:47 p.m.</div>
<pre class="content">
<span class="from">From: Al Viro &lt;viro@zeniv.linux.org.uk&gt;</span>
<span class="signed-off-by">
Signed-off-by: Al Viro &lt;viro@zeniv.linux.org.uk&gt;</span>
---
 arch/alpha/include/asm/pgalloc.h                  |  4 ++--
 arch/alpha/kernel/srm_env.c                       |  4 ++--
 arch/alpha/mm/init.c                              |  2 +-
 arch/arc/kernel/setup.c                           |  2 +-
 arch/arc/kernel/troubleshoot.c                    |  4 ++--
 arch/arm/include/asm/pgalloc.h                    |  2 +-
 arch/arm/kvm/arm.c                                |  2 +-
 arch/arm/kvm/mmu.c                                |  4 ++--
 arch/arm64/include/asm/pgalloc.h                  |  6 +++---
 arch/arm64/mm/mmu.c                               |  2 +-
 arch/arm64/mm/pgd.c                               |  2 +-
 arch/blackfin/kernel/dma-mapping.c                |  2 +-
 arch/cris/include/asm/pgalloc.h                   |  2 +-
 arch/frv/mm/pgalloc.c                             |  2 +-
 arch/hexagon/include/asm/pgalloc.h                |  4 ++--
 arch/m32r/include/asm/pgalloc.h                   |  4 ++--
 arch/m68k/include/asm/mcf_pgalloc.h               |  2 +-
 arch/m68k/include/asm/motorola_pgalloc.h          |  2 +-
 arch/metag/include/asm/pgalloc.h                  |  2 +-
 arch/microblaze/mm/pgtable.c                      |  2 +-
 arch/mn10300/mm/pgtable.c                         |  2 +-
 arch/openrisc/include/asm/pgalloc.h               |  2 +-
 arch/openrisc/mm/ioremap.c                        |  2 +-
 arch/parisc/include/asm/pgalloc.h                 |  2 +-
 arch/powerpc/include/asm/pgalloc-64.h             |  2 +-
 arch/powerpc/kvm/e500.c                           |  2 +-
 arch/powerpc/kvm/e500mc.c                         |  2 +-
 arch/powerpc/mm/hugetlbpage.c                     |  2 +-
 arch/powerpc/mm/pgtable_32.c                      |  2 +-
 arch/powerpc/platforms/pseries/cmm.c              |  6 ++----
 arch/powerpc/platforms/pseries/iommu.c            |  4 ++--
 arch/s390/crypto/aes_s390.c                       |  2 +-
 arch/s390/crypto/des_s390.c                       |  2 +-
 arch/s390/crypto/prng.c                           |  2 +-
 arch/s390/kernel/kprobes.c                        |  2 +-
 arch/s390/kernel/topology.c                       |  2 +-
 arch/s390/mm/cmm.c                                |  5 ++---
 arch/s390/mm/maccess.c                            |  4 ++--
 arch/s390/mm/pgtable.c                            |  3 +--
 arch/tile/mm/elf.c                                |  2 +-
 arch/um/kernel/mem.c                              |  6 +++---
 arch/unicore32/include/asm/pgalloc.h              |  2 +-
 arch/x86/kvm/mmu.c                                |  2 +-
 arch/x86/kvm/vmx.c                                | 21 +++++++++------------
 arch/x86/mm/pgtable.c                             |  8 ++++----
 arch/x86/pci/pcbios.c                             |  2 +-
 arch/x86/um/ldt.c                                 |  3 +--
 arch/x86/xen/mmu.c                                |  2 +-
 arch/x86/xen/p2m.c                                |  2 +-
 arch/xtensa/include/asm/pgalloc.h                 |  2 +-
 block/partitions/check.c                          |  2 +-
 crypto/blkcipher.c                                |  2 +-
 crypto/tcrypt.c                                   |  4 ++--
 crypto/testmgr.c                                  |  2 +-
 drivers/acpi/nvs.c                                |  2 +-
 drivers/block/cciss.c                             |  2 +-
 drivers/block/drbd/drbd_main.c                    |  4 ++--
 drivers/char/agp/amd-k7-agp.c                     |  2 +-
 drivers/char/agp/ati-agp.c                        |  2 +-
 drivers/char/agp/sworks-agp.c                     |  2 +-
 drivers/char/mem.c                                |  4 ++--
 drivers/char/tpm/xen-tpmfront.c                   |  2 +-
 drivers/char/xilinx_hwicap/xilinx_hwicap.c        |  2 +-
 drivers/firewire/ohci.c                           |  2 +-
 drivers/gpu/drm/via/via_dmablit.c                 |  3 +--
 drivers/ide/ide-proc.c                            |  2 +-
 drivers/infiniband/core/umem.c                    |  4 ++--
 drivers/infiniband/core/umem_odp.c                |  2 +-
 drivers/infiniband/hw/cxgb3/iwch_provider.c       |  2 +-
 drivers/infiniband/hw/cxgb4/device.c              |  3 +--
 drivers/infiniband/hw/cxgb4/mem.c                 |  2 +-
 drivers/infiniband/hw/mlx4/mr.c                   |  2 +-
 drivers/infiniband/hw/mlx5/odp.c                  |  2 +-
 drivers/infiniband/hw/mthca/mthca_provider.c      |  2 +-
 drivers/infiniband/hw/usnic/usnic_uiom.c          |  2 +-
 drivers/input/misc/xen-kbdfront.c                 |  2 +-
 drivers/macintosh/rack-meter.c                    |  2 +-
 drivers/media/pci/pt1/pt1.c                       |  2 +-
 drivers/media/pci/ttpci/av7110_ca.c               |  2 +-
 drivers/misc/cxl/pci.c                            |  2 +-
 drivers/misc/ibmasm/ibmasmfs.c                    |  2 +-
 drivers/misc/lkdtm.c                              |  6 +++---
 drivers/mmc/host/tmio_mmc_dma.c                   |  2 +-
 drivers/net/ethernet/broadcom/bnx2x/bnx2x_cmn.c   |  2 +-
 drivers/net/ethernet/sfc/mcdi.c                   |  2 +-
 drivers/net/ethernet/toshiba/ps3_gelic_wireless.c | 12 ++++++------
 drivers/net/usb/kaweth.c                          |  2 +-
 drivers/pci/xen-pcifront.c                        |  3 +--
 drivers/platform/x86/dell-laptop.c                |  2 +-
 drivers/s390/block/dasd_eckd.c                    |  2 +-
 drivers/s390/block/xpram.c                        |  4 ++--
 drivers/s390/char/sclp_cmd.c                      |  2 +-
 drivers/s390/char/vmur.c                          |  4 ++--
 drivers/s390/char/zcore.c                         |  2 +-
 drivers/s390/cio/qdio_setup.c                     |  4 ++--
 drivers/s390/cio/scm.c                            |  2 +-
 drivers/s390/net/qeth_core_main.c                 |  2 +-
 drivers/scsi/cxlflash/main.c                      |  2 +-
 drivers/scsi/ipr.c                                |  2 +-
 drivers/scsi/scsi_devinfo.c                       |  2 +-
 drivers/scsi/scsi_proc.c                          |  4 ++--
 drivers/scsi/xen-scsifront.c                      |  2 +-
 drivers/spi/spi-sh-msiof.c                        |  4 ++--
 drivers/staging/lustre/lustre/llite/llite_lib.c   |  2 +-
 drivers/staging/unisys/visorbus/visorchannel.c    |  2 +-
 drivers/target/target_core_file.c                 |  2 +-
 drivers/tty/hvc/hvc_xen.c                         |  2 +-
 drivers/tty/hvc/hvcs.c                            |  2 +-
 drivers/tty/mxser.c                               |  2 +-
 drivers/tty/rocket.c                              |  2 +-
 drivers/tty/serial/68328serial.c                  |  2 +-
 drivers/tty/serial/men_z135_uart.c                |  2 +-
 drivers/tty/serial/pch_uart.c                     |  2 +-
 drivers/tty/vt/vc_screen.c                        |  4 ++--
 drivers/usb/atm/cxacru.c                          |  6 +++---
 drivers/usb/atm/speedtch.c                        |  2 +-
 drivers/usb/core/devio.c                          |  2 +-
 drivers/usb/misc/rio500.c                         |  4 ++--
 drivers/usb/serial/usb_wwan.c                     |  2 +-
 drivers/uwb/hwa-rc.c                              |  2 +-
 drivers/video/fbdev/xen-fbfront.c                 |  2 +-
 drivers/xen/events/events_base.c                  |  2 +-
 drivers/xen/events/events_fifo.c                  |  4 ++--
 drivers/xen/evtchn.c                              |  2 +-
 drivers/xen/grant-table.c                         |  4 ++--
 fs/binfmt_misc.c                                  |  2 +-
 fs/fuse/dir.c                                     |  2 +-
 fs/fuse/file.c                                    |  2 +-
 fs/isofs/dir.c                                    |  2 +-
 fs/jfs/jfs_dtree.c                                |  2 +-
 fs/namespace.c                                    |  2 +-
 fs/nfs/namespace.c                                |  2 +-
 fs/nfs/nfs4namespace.c                            |  8 ++++----
 fs/nfs/super.c                                    |  2 +-
 fs/nfsd/vfs.c                                     |  2 +-
 fs/ocfs2/dlm/dlmdomain.c                          |  2 +-
 fs/ocfs2/dlm/dlmmaster.c                          |  2 +-
 fs/ocfs2/dlm/dlmrecovery.c                        |  2 +-
 fs/overlayfs/copy_up.c                            |  2 +-
 fs/proc/base.c                                    | 10 +++++-----
 fs/select.c                                       |  2 +-
 include/linux/quicklist.h                         |  2 +-
 kernel/groups.c                                   |  2 +-
 kernel/power/swap.c                               | 13 ++++++-------
 kernel/sysctl.c                                   |  6 +++---
 kernel/trace/trace_events.c                       |  4 ++--
 kernel/trace/trace_events_filter.c                |  2 +-
 kernel/trace/trace_events_trigger.c               |  2 +-
 kernel/user_namespace.c                           |  2 +-
 lib/scatterlist.c                                 |  2 +-
 mm/memory.c                                       |  4 ++--
 mm/migrate.c                                      |  2 +-
 mm/mincore.c                                      |  2 +-
 net/atm/mpoa_proc.c                               |  2 +-
 security/selinux/hooks.c                          |  2 +-
 security/selinux/selinuxfs.c                      |  2 +-
 sound/oss/msnd_pinnacle.c                         |  4 ++--
 157 files changed, 221 insertions(+), 233 deletions(-)
</pre>
</div>



<h2>Patch</h2>
<div class="patch">
<pre class="content">
<span class="p_header">diff --git a/arch/alpha/include/asm/pgalloc.h b/arch/alpha/include/asm/pgalloc.h</span>
<span class="p_header">index 078da57..001da1d 100644</span>
<span class="p_header">--- a/arch/alpha/include/asm/pgalloc.h</span>
<span class="p_header">+++ b/arch/alpha/include/asm/pgalloc.h</span>
<span class="p_chunk">@@ -40,7 +40,7 @@</span> <span class="p_context"> pgd_free(struct mm_struct *mm, pgd_t *pgd)</span>
 static inline pmd_t *
 pmd_alloc_one(struct mm_struct *mm, unsigned long address)
 {
<span class="p_del">-	pmd_t *ret = (pmd_t *)__get_free_page(GFP_KERNEL|__GFP_REPEAT|__GFP_ZERO);</span>
<span class="p_add">+	pmd_t *ret = get_free_page(GFP_KERNEL|__GFP_REPEAT|__GFP_ZERO);</span>
 	return ret;
 }
 
<span class="p_chunk">@@ -53,7 +53,7 @@</span> <span class="p_context"> pmd_free(struct mm_struct *mm, pmd_t *pmd)</span>
 static inline pte_t *
 pte_alloc_one_kernel(struct mm_struct *mm, unsigned long address)
 {
<span class="p_del">-	pte_t *pte = (pte_t *)__get_free_page(GFP_KERNEL|__GFP_REPEAT|__GFP_ZERO);</span>
<span class="p_add">+	pte_t *pte = get_free_page(GFP_KERNEL|__GFP_REPEAT|__GFP_ZERO);</span>
 	return pte;
 }
 
<span class="p_header">diff --git a/arch/alpha/kernel/srm_env.c b/arch/alpha/kernel/srm_env.c</span>
<span class="p_header">index a66f23b..14f8597 100644</span>
<span class="p_header">--- a/arch/alpha/kernel/srm_env.c</span>
<span class="p_header">+++ b/arch/alpha/kernel/srm_env.c</span>
<span class="p_chunk">@@ -82,7 +82,7 @@</span> <span class="p_context"> static int srm_env_proc_show(struct seq_file *m, void *v)</span>
 	unsigned long	id = (unsigned long)m-&gt;private;
 	char		*page;
 
<span class="p_del">-	page = (char *)__get_free_page(GFP_USER);</span>
<span class="p_add">+	page = get_free_page(GFP_USER);</span>
 	if (!page)
 		return -ENOMEM;
 
<span class="p_chunk">@@ -107,7 +107,7 @@</span> <span class="p_context"> static ssize_t srm_env_proc_write(struct file *file, const char __user *buffer,</span>
 {
 	int res;
 	unsigned long	id = (unsigned long)PDE_DATA(file_inode(file));
<span class="p_del">-	char		*buf = (char *) __get_free_page(GFP_USER);</span>
<span class="p_add">+	char		*buf = get_free_page(GFP_USER);</span>
 	unsigned long	ret1, ret2;
 
 	if (!buf)
<span class="p_header">diff --git a/arch/alpha/mm/init.c b/arch/alpha/mm/init.c</span>
<span class="p_header">index a1bea91..6a604df 100644</span>
<span class="p_header">--- a/arch/alpha/mm/init.c</span>
<span class="p_header">+++ b/arch/alpha/mm/init.c</span>
<span class="p_chunk">@@ -42,7 +42,7 @@</span> <span class="p_context"> pgd_alloc(struct mm_struct *mm)</span>
 {
 	pgd_t *ret, *init;
 
<span class="p_del">-	ret = (pgd_t *)__get_free_page(GFP_KERNEL | __GFP_ZERO);</span>
<span class="p_add">+	ret = get_free_page(GFP_KERNEL | __GFP_ZERO);</span>
 	init = pgd_offset(&amp;init_mm, 0UL);
 	if (ret) {
 #ifdef CONFIG_ALPHA_LARGE_VMALLOC
<span class="p_header">diff --git a/arch/arc/kernel/setup.c b/arch/arc/kernel/setup.c</span>
<span class="p_header">index 56fd4fc..39cae4a 100644</span>
<span class="p_header">--- a/arch/arc/kernel/setup.c</span>
<span class="p_header">+++ b/arch/arc/kernel/setup.c</span>
<span class="p_chunk">@@ -473,7 +473,7 @@</span> <span class="p_context"> static int show_cpuinfo(struct seq_file *m, void *v)</span>
 		goto done;
 	}
 
<span class="p_del">-	str = (char *)__get_free_page(GFP_TEMPORARY);</span>
<span class="p_add">+	str = get_free_page(GFP_TEMPORARY);</span>
 	if (!str)
 		goto done;
 
<span class="p_header">diff --git a/arch/arc/kernel/troubleshoot.c b/arch/arc/kernel/troubleshoot.c</span>
<span class="p_header">index eb3464d..f09d68d 100644</span>
<span class="p_header">--- a/arch/arc/kernel/troubleshoot.c</span>
<span class="p_header">+++ b/arch/arc/kernel/troubleshoot.c</span>
<span class="p_chunk">@@ -175,7 +175,7 @@</span> <span class="p_context"> void show_regs(struct pt_regs *regs)</span>
 	struct callee_regs *cregs;
 	char *buf;
 
<span class="p_del">-	buf = (char *)__get_free_page(GFP_TEMPORARY);</span>
<span class="p_add">+	buf = get_free_page(GFP_TEMPORARY);</span>
 	if (!buf)
 		return;
 
<span class="p_chunk">@@ -272,7 +272,7 @@</span> <span class="p_context"> static int fill_display_data(char *kbuf)</span>
 
 static int tlb_stats_open(struct inode *inode, struct file *file)
 {
<span class="p_del">-	file-&gt;private_data = (void *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	file-&gt;private_data = get_free_page(GFP_KERNEL);</span>
 	return 0;
 }
 
<span class="p_header">diff --git a/arch/arm/include/asm/pgalloc.h b/arch/arm/include/asm/pgalloc.h</span>
<span class="p_header">index 540647d..aafdebc 100644</span>
<span class="p_header">--- a/arch/arm/include/asm/pgalloc.h</span>
<span class="p_header">+++ b/arch/arm/include/asm/pgalloc.h</span>
<span class="p_chunk">@@ -85,7 +85,7 @@</span> <span class="p_context"> pte_alloc_one_kernel(struct mm_struct *mm, unsigned long addr)</span>
 {
 	pte_t *pte;
 
<span class="p_del">-	pte = (pte_t *)__get_free_page(PGALLOC_GFP);</span>
<span class="p_add">+	pte = get_free_page(PGALLOC_GFP);</span>
 	if (pte)
 		clean_pte_table(pte);
 
<span class="p_header">diff --git a/arch/arm/kvm/arm.c b/arch/arm/kvm/arm.c</span>
<span class="p_header">index 385bdce..56b066f 100644</span>
<span class="p_header">--- a/arch/arm/kvm/arm.c</span>
<span class="p_header">+++ b/arch/arm/kvm/arm.c</span>
<span class="p_chunk">@@ -1046,7 +1046,7 @@</span> <span class="p_context"> static int init_hyp_mode(void)</span>
 	 * Allocate stack pages for Hypervisor-mode
 	 */
 	for_each_possible_cpu(cpu) {
<span class="p_del">-		void *stack_page = (void *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+		void *stack_page = get_free_page(GFP_KERNEL);</span>
 		if (!stack_page) {
 			err = -ENOMEM;
 			goto out_free_stack_pages;
<span class="p_header">diff --git a/arch/arm/kvm/mmu.c b/arch/arm/kvm/mmu.c</span>
<span class="p_header">index 429b673..34c2de6 100644</span>
<span class="p_header">--- a/arch/arm/kvm/mmu.c</span>
<span class="p_header">+++ b/arch/arm/kvm/mmu.c</span>
<span class="p_chunk">@@ -131,7 +131,7 @@</span> <span class="p_context"> static int mmu_topup_memory_cache(struct kvm_mmu_memory_cache *cache,</span>
 	if (cache-&gt;nobjs &gt;= min)
 		return 0;
 	while (cache-&gt;nobjs &lt; max) {
<span class="p_del">-		page = (void *)__get_free_page(PGALLOC_GFP);</span>
<span class="p_add">+		page = get_free_page(PGALLOC_GFP);</span>
 		if (!page)
 			return -ENOMEM;
 		cache-&gt;objects[cache-&gt;nobjs++] = page;
<span class="p_chunk">@@ -1679,7 +1679,7 @@</span> <span class="p_context"> int kvm_mmu_init(void)</span>
 	}
 
 	if (__kvm_cpu_uses_extended_idmap()) {
<span class="p_del">-		merged_hyp_pgd = (pgd_t *)__get_free_page(GFP_KERNEL | __GFP_ZERO);</span>
<span class="p_add">+		merged_hyp_pgd = get_free_page(GFP_KERNEL | __GFP_ZERO);</span>
 		if (!merged_hyp_pgd) {
 			kvm_err(&quot;Failed to allocate extra HYP pgd\n&quot;);
 			goto out;
<span class="p_header">diff --git a/arch/arm64/include/asm/pgalloc.h b/arch/arm64/include/asm/pgalloc.h</span>
<span class="p_header">index ce9b3c0..5bfbe35 100644</span>
<span class="p_header">--- a/arch/arm64/include/asm/pgalloc.h</span>
<span class="p_header">+++ b/arch/arm64/include/asm/pgalloc.h</span>
<span class="p_chunk">@@ -33,7 +33,7 @@</span> <span class="p_context"></span>
 
 static inline pmd_t *pmd_alloc_one(struct mm_struct *mm, unsigned long addr)
 {
<span class="p_del">-	return (pmd_t *)__get_free_page(PGALLOC_GFP);</span>
<span class="p_add">+	return get_free_page(PGALLOC_GFP);</span>
 }
 
 static inline void pmd_free(struct mm_struct *mm, pmd_t *pmd)
<span class="p_chunk">@@ -53,7 +53,7 @@</span> <span class="p_context"> static inline void pud_populate(struct mm_struct *mm, pud_t *pud, pmd_t *pmd)</span>
 
 static inline pud_t *pud_alloc_one(struct mm_struct *mm, unsigned long addr)
 {
<span class="p_del">-	return (pud_t *)__get_free_page(PGALLOC_GFP);</span>
<span class="p_add">+	return get_free_page(PGALLOC_GFP);</span>
 }
 
 static inline void pud_free(struct mm_struct *mm, pud_t *pud)
<span class="p_chunk">@@ -75,7 +75,7 @@</span> <span class="p_context"> extern void pgd_free(struct mm_struct *mm, pgd_t *pgd);</span>
 static inline pte_t *
 pte_alloc_one_kernel(struct mm_struct *mm, unsigned long addr)
 {
<span class="p_del">-	return (pte_t *)__get_free_page(PGALLOC_GFP);</span>
<span class="p_add">+	return get_free_page(PGALLOC_GFP);</span>
 }
 
 static inline pgtable_t
<span class="p_header">diff --git a/arch/arm64/mm/mmu.c b/arch/arm64/mm/mmu.c</span>
<span class="p_header">index 873e363..753b6cb 100644</span>
<span class="p_header">--- a/arch/arm64/mm/mmu.c</span>
<span class="p_header">+++ b/arch/arm64/mm/mmu.c</span>
<span class="p_chunk">@@ -267,7 +267,7 @@</span> <span class="p_context"> static void *late_alloc(unsigned long size)</span>
 	void *ptr;
 
 	BUG_ON(size &gt; PAGE_SIZE);
<span class="p_del">-	ptr = (void *)__get_free_page(PGALLOC_GFP);</span>
<span class="p_add">+	ptr = get_free_page(PGALLOC_GFP);</span>
 	BUG_ON(!ptr);
 	return ptr;
 }
<span class="p_header">diff --git a/arch/arm64/mm/pgd.c b/arch/arm64/mm/pgd.c</span>
<span class="p_header">index a468648..d5574e5 100644</span>
<span class="p_header">--- a/arch/arm64/mm/pgd.c</span>
<span class="p_header">+++ b/arch/arm64/mm/pgd.c</span>
<span class="p_chunk">@@ -33,7 +33,7 @@</span> <span class="p_context"> static struct kmem_cache *pgd_cache;</span>
 pgd_t *pgd_alloc(struct mm_struct *mm)
 {
 	if (PGD_SIZE == PAGE_SIZE)
<span class="p_del">-		return (pgd_t *)__get_free_page(PGALLOC_GFP);</span>
<span class="p_add">+		return get_free_page(PGALLOC_GFP);</span>
 	else
 		return kmem_cache_alloc(pgd_cache, PGALLOC_GFP);
 }
<span class="p_header">diff --git a/arch/blackfin/kernel/dma-mapping.c b/arch/blackfin/kernel/dma-mapping.c</span>
<span class="p_header">index df437e5..aa71d9b 100644</span>
<span class="p_header">--- a/arch/blackfin/kernel/dma-mapping.c</span>
<span class="p_header">+++ b/arch/blackfin/kernel/dma-mapping.c</span>
<span class="p_chunk">@@ -27,7 +27,7 @@</span> <span class="p_context"> static void dma_alloc_init(unsigned long start, unsigned long end)</span>
 	spin_lock_init(&amp;dma_page_lock);
 	dma_initialized = 0;
 
<span class="p_del">-	dma_page = (unsigned long *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	dma_page = get_free_page(GFP_KERNEL);</span>
 	memset(dma_page, 0, PAGE_SIZE);
 	dma_base = PAGE_ALIGN(start);
 	dma_size = PAGE_ALIGN(end) - PAGE_ALIGN(start);
<span class="p_header">diff --git a/arch/cris/include/asm/pgalloc.h b/arch/cris/include/asm/pgalloc.h</span>
<span class="p_header">index cac8206..65e3f32 100644</span>
<span class="p_header">--- a/arch/cris/include/asm/pgalloc.h</span>
<span class="p_header">+++ b/arch/cris/include/asm/pgalloc.h</span>
<span class="p_chunk">@@ -24,7 +24,7 @@</span> <span class="p_context"> static inline void pgd_free(struct mm_struct *mm, pgd_t *pgd)</span>
 
 static inline pte_t *pte_alloc_one_kernel(struct mm_struct *mm, unsigned long address)
 {
<span class="p_del">-  	pte_t *pte = (pte_t *)__get_free_page(GFP_KERNEL|__GFP_REPEAT|__GFP_ZERO);</span>
<span class="p_add">+  	pte_t *pte = get_free_page(GFP_KERNEL|__GFP_REPEAT|__GFP_ZERO);</span>
  	return pte;
 }
 
<span class="p_header">diff --git a/arch/frv/mm/pgalloc.c b/arch/frv/mm/pgalloc.c</span>
<span class="p_header">index 41907d2..16addf2 100644</span>
<span class="p_header">--- a/arch/frv/mm/pgalloc.c</span>
<span class="p_header">+++ b/arch/frv/mm/pgalloc.c</span>
<span class="p_chunk">@@ -22,7 +22,7 @@</span> <span class="p_context"> pgd_t swapper_pg_dir[PTRS_PER_PGD] __attribute__((aligned(PAGE_SIZE)));</span>
 
 pte_t *pte_alloc_one_kernel(struct mm_struct *mm, unsigned long address)
 {
<span class="p_del">-	pte_t *pte = (pte_t *)__get_free_page(GFP_KERNEL|__GFP_REPEAT);</span>
<span class="p_add">+	pte_t *pte = get_free_page(GFP_KERNEL|__GFP_REPEAT);</span>
 	if (pte)
 		clear_page(pte);
 	return pte;
<span class="p_header">diff --git a/arch/hexagon/include/asm/pgalloc.h b/arch/hexagon/include/asm/pgalloc.h</span>
<span class="p_header">index 48c04dc..ca48fcf 100644</span>
<span class="p_header">--- a/arch/hexagon/include/asm/pgalloc.h</span>
<span class="p_header">+++ b/arch/hexagon/include/asm/pgalloc.h</span>
<span class="p_chunk">@@ -35,7 +35,7 @@</span> <span class="p_context"> static inline pgd_t *pgd_alloc(struct mm_struct *mm)</span>
 {
 	pgd_t *pgd;
 
<span class="p_del">-	pgd = (pgd_t *)__get_free_page(GFP_KERNEL | __GFP_ZERO);</span>
<span class="p_add">+	pgd = get_free_page(GFP_KERNEL | __GFP_ZERO);</span>
 
 	/*
 	 * There may be better ways to do this, but to ensure
<span class="p_chunk">@@ -79,7 +79,7 @@</span> <span class="p_context"> static inline pte_t *pte_alloc_one_kernel(struct mm_struct *mm,</span>
 					  unsigned long address)
 {
 	gfp_t flags =  GFP_KERNEL | __GFP_REPEAT | __GFP_ZERO;
<span class="p_del">-	return (pte_t *) __get_free_page(flags);</span>
<span class="p_add">+	return get_free_page(flags);</span>
 }
 
 static inline void pte_free(struct mm_struct *mm, struct page *pte)
<span class="p_header">diff --git a/arch/m32r/include/asm/pgalloc.h b/arch/m32r/include/asm/pgalloc.h</span>
<span class="p_header">index 3923429..80d1b26 100644</span>
<span class="p_header">--- a/arch/m32r/include/asm/pgalloc.h</span>
<span class="p_header">+++ b/arch/m32r/include/asm/pgalloc.h</span>
<span class="p_chunk">@@ -20,7 +20,7 @@</span> <span class="p_context"> static __inline__ void pmd_populate(struct mm_struct *mm, pmd_t *pmd,</span>
  */
 static __inline__ pgd_t *pgd_alloc(struct mm_struct *mm)
 {
<span class="p_del">-	pgd_t *pgd = (pgd_t *)__get_free_page(GFP_KERNEL|__GFP_ZERO);</span>
<span class="p_add">+	pgd_t *pgd = get_free_page(GFP_KERNEL|__GFP_ZERO);</span>
 
 	return pgd;
 }
<span class="p_chunk">@@ -33,7 +33,7 @@</span> <span class="p_context"> static inline void pgd_free(struct mm_struct *mm, pgd_t *pgd)</span>
 static __inline__ pte_t *pte_alloc_one_kernel(struct mm_struct *mm,
 	unsigned long address)
 {
<span class="p_del">-	pte_t *pte = (pte_t *)__get_free_page(GFP_KERNEL|__GFP_ZERO);</span>
<span class="p_add">+	pte_t *pte = get_free_page(GFP_KERNEL|__GFP_ZERO);</span>
 
 	return pte;
 }
<span class="p_header">diff --git a/arch/m68k/include/asm/mcf_pgalloc.h b/arch/m68k/include/asm/mcf_pgalloc.h</span>
<span class="p_header">index 2e70a56..04ffc22 100644</span>
<span class="p_header">--- a/arch/m68k/include/asm/mcf_pgalloc.h</span>
<span class="p_header">+++ b/arch/m68k/include/asm/mcf_pgalloc.h</span>
<span class="p_chunk">@@ -93,7 +93,7 @@</span> <span class="p_context"> static inline pgd_t *pgd_alloc(struct mm_struct *mm)</span>
 {
 	pgd_t *new_pgd;
 
<span class="p_del">-	new_pgd = (pgd_t *)__get_free_page(GFP_DMA | __GFP_NOWARN);</span>
<span class="p_add">+	new_pgd = get_free_page(GFP_DMA | __GFP_NOWARN);</span>
 	if (!new_pgd)
 		return NULL;
 	memcpy(new_pgd, swapper_pg_dir, PAGE_SIZE);
<span class="p_header">diff --git a/arch/m68k/include/asm/motorola_pgalloc.h b/arch/m68k/include/asm/motorola_pgalloc.h</span>
<span class="p_header">index 6e84224..60df054 100644</span>
<span class="p_header">--- a/arch/m68k/include/asm/motorola_pgalloc.h</span>
<span class="p_header">+++ b/arch/m68k/include/asm/motorola_pgalloc.h</span>
<span class="p_chunk">@@ -11,7 +11,7 @@</span> <span class="p_context"> static inline pte_t *pte_alloc_one_kernel(struct mm_struct *mm, unsigned long ad</span>
 {
 	pte_t *pte;
 
<span class="p_del">-	pte = (pte_t *)__get_free_page(GFP_KERNEL|__GFP_REPEAT|__GFP_ZERO);</span>
<span class="p_add">+	pte = get_free_page(GFP_KERNEL|__GFP_REPEAT|__GFP_ZERO);</span>
 	if (pte) {
 		__flush_page_to_ram(pte);
 		flush_tlb_kernel_page(pte);
<span class="p_header">diff --git a/arch/metag/include/asm/pgalloc.h b/arch/metag/include/asm/pgalloc.h</span>
<span class="p_header">index cf9e2fb..ae19628 100644</span>
<span class="p_header">--- a/arch/metag/include/asm/pgalloc.h</span>
<span class="p_header">+++ b/arch/metag/include/asm/pgalloc.h</span>
<span class="p_chunk">@@ -42,7 +42,7 @@</span> <span class="p_context"> static inline void pgd_free(struct mm_struct *mm, pgd_t *pgd)</span>
 static inline pte_t *pte_alloc_one_kernel(struct mm_struct *mm,
 					  unsigned long address)
 {
<span class="p_del">-	pte_t *pte = (pte_t *)__get_free_page(GFP_KERNEL | __GFP_REPEAT |</span>
<span class="p_add">+	pte_t *pte = get_free_page(GFP_KERNEL | __GFP_REPEAT |</span>
 					      __GFP_ZERO);
 	return pte;
 }
<span class="p_header">diff --git a/arch/microblaze/mm/pgtable.c b/arch/microblaze/mm/pgtable.c</span>
<span class="p_header">index 4f4520e..76e117d 100644</span>
<span class="p_header">--- a/arch/microblaze/mm/pgtable.c</span>
<span class="p_header">+++ b/arch/microblaze/mm/pgtable.c</span>
<span class="p_chunk">@@ -239,7 +239,7 @@</span> <span class="p_context"> __init_refok pte_t *pte_alloc_one_kernel(struct mm_struct *mm,</span>
 {
 	pte_t *pte;
 	if (mem_init_done) {
<span class="p_del">-		pte = (pte_t *)__get_free_page(GFP_KERNEL |</span>
<span class="p_add">+		pte = get_free_page(GFP_KERNEL |</span>
 					__GFP_REPEAT | __GFP_ZERO);
 	} else {
 		pte = (pte_t *)early_get_page();
<span class="p_header">diff --git a/arch/mn10300/mm/pgtable.c b/arch/mn10300/mm/pgtable.c</span>
<span class="p_header">index e77a7c7..391992b 100644</span>
<span class="p_header">--- a/arch/mn10300/mm/pgtable.c</span>
<span class="p_header">+++ b/arch/mn10300/mm/pgtable.c</span>
<span class="p_chunk">@@ -63,7 +63,7 @@</span> <span class="p_context"> void set_pmd_pfn(unsigned long vaddr, unsigned long pfn, pgprot_t flags)</span>
 
 pte_t *pte_alloc_one_kernel(struct mm_struct *mm, unsigned long address)
 {
<span class="p_del">-	pte_t *pte = (pte_t *)__get_free_page(GFP_KERNEL|__GFP_REPEAT);</span>
<span class="p_add">+	pte_t *pte = get_free_page(GFP_KERNEL|__GFP_REPEAT);</span>
 	if (pte)
 		clear_page(pte);
 	return pte;
<span class="p_header">diff --git a/arch/openrisc/include/asm/pgalloc.h b/arch/openrisc/include/asm/pgalloc.h</span>
<span class="p_header">index 1f61391..642186f 100644</span>
<span class="p_header">--- a/arch/openrisc/include/asm/pgalloc.h</span>
<span class="p_header">+++ b/arch/openrisc/include/asm/pgalloc.h</span>
<span class="p_chunk">@@ -43,7 +43,7 @@</span> <span class="p_context"> static inline void pmd_populate(struct mm_struct *mm, pmd_t *pmd,</span>
  */
 static inline pgd_t *pgd_alloc(struct mm_struct *mm)
 {
<span class="p_del">-	pgd_t *ret = (pgd_t *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	pgd_t *ret = get_free_page(GFP_KERNEL);</span>
 
 	if (ret) {
 		memset(ret, 0, USER_PTRS_PER_PGD * sizeof(pgd_t));
<span class="p_header">diff --git a/arch/openrisc/mm/ioremap.c b/arch/openrisc/mm/ioremap.c</span>
<span class="p_header">index 62b08ef..801533f 100644</span>
<span class="p_header">--- a/arch/openrisc/mm/ioremap.c</span>
<span class="p_header">+++ b/arch/openrisc/mm/ioremap.c</span>
<span class="p_chunk">@@ -122,7 +122,7 @@</span> <span class="p_context"> pte_t __init_refok *pte_alloc_one_kernel(struct mm_struct *mm,</span>
 	pte_t *pte;
 
 	if (likely(mem_init_done)) {
<span class="p_del">-		pte = (pte_t *) __get_free_page(GFP_KERNEL | __GFP_REPEAT);</span>
<span class="p_add">+		pte = get_free_page(GFP_KERNEL | __GFP_REPEAT);</span>
 	} else {
 		pte = (pte_t *) alloc_bootmem_low_pages(PAGE_SIZE);
 #if 0
<span class="p_header">diff --git a/arch/parisc/include/asm/pgalloc.h b/arch/parisc/include/asm/pgalloc.h</span>
<span class="p_header">index 5c10934..94e5b41 100644</span>
<span class="p_header">--- a/arch/parisc/include/asm/pgalloc.h</span>
<span class="p_header">+++ b/arch/parisc/include/asm/pgalloc.h</span>
<span class="p_chunk">@@ -135,7 +135,7 @@</span> <span class="p_context"> pte_alloc_one(struct mm_struct *mm, unsigned long address)</span>
 static inline pte_t *
 pte_alloc_one_kernel(struct mm_struct *mm, unsigned long addr)
 {
<span class="p_del">-	pte_t *pte = (pte_t *)__get_free_page(GFP_KERNEL|__GFP_REPEAT|__GFP_ZERO);</span>
<span class="p_add">+	pte_t *pte = get_free_page(GFP_KERNEL|__GFP_REPEAT|__GFP_ZERO);</span>
 	return pte;
 }
 
<span class="p_header">diff --git a/arch/powerpc/include/asm/pgalloc-64.h b/arch/powerpc/include/asm/pgalloc-64.h</span>
<span class="p_header">index c26021b..e61b0d2 100644</span>
<span class="p_header">--- a/arch/powerpc/include/asm/pgalloc-64.h</span>
<span class="p_header">+++ b/arch/powerpc/include/asm/pgalloc-64.h</span>
<span class="p_chunk">@@ -79,7 +79,7 @@</span> <span class="p_context"> static inline void pud_populate(struct mm_struct *mm, pud_t *pud, pmd_t *pmd)</span>
 static inline pte_t *pte_alloc_one_kernel(struct mm_struct *mm,
 					  unsigned long address)
 {
<span class="p_del">-	return (pte_t *)__get_free_page(GFP_KERNEL | __GFP_REPEAT | __GFP_ZERO);</span>
<span class="p_add">+	return get_free_page(GFP_KERNEL | __GFP_REPEAT | __GFP_ZERO);</span>
 }
 
 static inline pgtable_t pte_alloc_one(struct mm_struct *mm,
<span class="p_header">diff --git a/arch/powerpc/kvm/e500.c b/arch/powerpc/kvm/e500.c</span>
<span class="p_header">index 29803fb..a525971 100644</span>
<span class="p_header">--- a/arch/powerpc/kvm/e500.c</span>
<span class="p_header">+++ b/arch/powerpc/kvm/e500.c</span>
<span class="p_chunk">@@ -462,7 +462,7 @@</span> <span class="p_context"> static struct kvm_vcpu *kvmppc_core_vcpu_create_e500(struct kvm *kvm,</span>
 	if (err)
 		goto uninit_id;
 
<span class="p_del">-	vcpu-&gt;arch.shared = (void*)__get_free_page(GFP_KERNEL|__GFP_ZERO);</span>
<span class="p_add">+	vcpu-&gt;arch.shared = get_free_page(GFP_KERNEL|__GFP_ZERO);</span>
 	if (!vcpu-&gt;arch.shared)
 		goto uninit_tlb;
 
<span class="p_header">diff --git a/arch/powerpc/kvm/e500mc.c b/arch/powerpc/kvm/e500mc.c</span>
<span class="p_header">index e002a71..450eab9 100644</span>
<span class="p_header">--- a/arch/powerpc/kvm/e500mc.c</span>
<span class="p_header">+++ b/arch/powerpc/kvm/e500mc.c</span>
<span class="p_chunk">@@ -330,7 +330,7 @@</span> <span class="p_context"> static struct kvm_vcpu *kvmppc_core_vcpu_create_e500mc(struct kvm *kvm,</span>
 	if (err)
 		goto uninit_vcpu;
 
<span class="p_del">-	vcpu-&gt;arch.shared = (void *)__get_free_page(GFP_KERNEL | __GFP_ZERO);</span>
<span class="p_add">+	vcpu-&gt;arch.shared = get_free_page(GFP_KERNEL | __GFP_ZERO);</span>
 	if (!vcpu-&gt;arch.shared)
 		goto uninit_tlb;
 
<span class="p_header">diff --git a/arch/powerpc/mm/hugetlbpage.c b/arch/powerpc/mm/hugetlbpage.c</span>
<span class="p_header">index a466b84..a94f92b6 100644</span>
<span class="p_header">--- a/arch/powerpc/mm/hugetlbpage.c</span>
<span class="p_header">+++ b/arch/powerpc/mm/hugetlbpage.c</span>
<span class="p_chunk">@@ -497,7 +497,7 @@</span> <span class="p_context"> static void hugepd_free(struct mmu_gather *tlb, void *hugepte)</span>
 	}
 
 	if (*batchp == NULL) {
<span class="p_del">-		*batchp = (struct hugepd_freelist *)__get_free_page(GFP_ATOMIC);</span>
<span class="p_add">+		*batchp = get_free_page(GFP_ATOMIC);</span>
 		(*batchp)-&gt;index = 0;
 	}
 
<span class="p_header">diff --git a/arch/powerpc/mm/pgtable_32.c b/arch/powerpc/mm/pgtable_32.c</span>
<span class="p_header">index 6e6c311..542f425 100644</span>
<span class="p_header">--- a/arch/powerpc/mm/pgtable_32.c</span>
<span class="p_header">+++ b/arch/powerpc/mm/pgtable_32.c</span>
<span class="p_chunk">@@ -109,7 +109,7 @@</span> <span class="p_context"> __init_refok pte_t *pte_alloc_one_kernel(struct mm_struct *mm, unsigned long add</span>
 	pte_t *pte;
 
 	if (slab_is_available()) {
<span class="p_del">-		pte = (pte_t *)__get_free_page(GFP_KERNEL|__GFP_REPEAT|__GFP_ZERO);</span>
<span class="p_add">+		pte = get_free_page(GFP_KERNEL|__GFP_REPEAT|__GFP_ZERO);</span>
 	} else {
 		pte = __va(memblock_alloc(PAGE_SIZE, PAGE_SIZE));
 		if (pte)
<span class="p_header">diff --git a/arch/powerpc/platforms/pseries/cmm.c b/arch/powerpc/platforms/pseries/cmm.c</span>
<span class="p_header">index db1dbe6..f4aa67d 100644</span>
<span class="p_header">--- a/arch/powerpc/platforms/pseries/cmm.c</span>
<span class="p_header">+++ b/arch/powerpc/platforms/pseries/cmm.c</span>
<span class="p_chunk">@@ -145,8 +145,7 @@</span> <span class="p_context"> static long cmm_alloc_pages(long nr)</span>
 		if (!pa || pa-&gt;index &gt;= CMM_NR_PAGES) {
 			/* Need a new page for the page list. */
 			spin_unlock(&amp;cmm_lock);
<span class="p_del">-			npa = (struct cmm_page_array *)__get_free_page(</span>
<span class="p_del">-					GFP_NOIO | __GFP_NOWARN |</span>
<span class="p_add">+			npa = get_free_page(GFP_NOIO | __GFP_NOWARN |</span>
 					__GFP_NORETRY | __GFP_NOMEMALLOC);
 			if (!npa) {
 				pr_info(&quot;%s: Can not allocate new page list\n&quot;, __func__);
<span class="p_chunk">@@ -566,8 +565,7 @@</span> <span class="p_context"> static int cmm_mem_going_offline(void *arg)</span>
 	while (pa_curr) {
 		if (((unsigned long)pa_curr &gt;= start_page) &amp;&amp;
 				((unsigned long)pa_curr &lt; end_page)) {
<span class="p_del">-			npa = (struct cmm_page_array *)__get_free_page(</span>
<span class="p_del">-					GFP_NOIO | __GFP_NOWARN |</span>
<span class="p_add">+			npa = get_free_page(GFP_NOIO | __GFP_NOWARN |</span>
 					__GFP_NORETRY | __GFP_NOMEMALLOC);
 			if (!npa) {
 				spin_unlock(&amp;cmm_lock);
<span class="p_header">diff --git a/arch/powerpc/platforms/pseries/iommu.c b/arch/powerpc/platforms/pseries/iommu.c</span>
<span class="p_header">index bd98ce2..f471734 100644</span>
<span class="p_header">--- a/arch/powerpc/platforms/pseries/iommu.c</span>
<span class="p_header">+++ b/arch/powerpc/platforms/pseries/iommu.c</span>
<span class="p_chunk">@@ -275,7 +275,7 @@</span> <span class="p_context"> static int tce_buildmulti_pSeriesLP(struct iommu_table *tbl, long tcenum,</span>
 	 * from iommu_alloc{,_sg}()
 	 */
 	if (!tcep) {
<span class="p_del">-		tcep = (__be64 *)__get_free_page(GFP_ATOMIC);</span>
<span class="p_add">+		tcep = get_free_page(GFP_ATOMIC);</span>
 		/* If allocation fails, fall back to the loop implementation */
 		if (!tcep) {
 			local_irq_restore(flags);
<span class="p_chunk">@@ -474,7 +474,7 @@</span> <span class="p_context"> static int tce_setrange_multi_pSeriesLP(unsigned long start_pfn,</span>
 	tcep = __this_cpu_read(tce_page);
 
 	if (!tcep) {
<span class="p_del">-		tcep = (__be64 *)__get_free_page(GFP_ATOMIC);</span>
<span class="p_add">+		tcep = get_free_page(GFP_ATOMIC);</span>
 		if (!tcep) {
 			local_irq_enable();
 			return -ENOMEM;
<span class="p_header">diff --git a/arch/s390/crypto/aes_s390.c b/arch/s390/crypto/aes_s390.c</span>
<span class="p_header">index 4b610d6..15edffb 100644</span>
<span class="p_header">--- a/arch/s390/crypto/aes_s390.c</span>
<span class="p_header">+++ b/arch/s390/crypto/aes_s390.c</span>
<span class="p_chunk">@@ -936,7 +936,7 @@</span> <span class="p_context"> static int __init aes_s390_init(void)</span>
 				CRYPT_S390_MSA | CRYPT_S390_MSA4) &amp;&amp;
 	    crypt_s390_func_available(KMCTR_AES_256_ENCRYPT,
 				CRYPT_S390_MSA | CRYPT_S390_MSA4)) {
<span class="p_del">-		ctrblk = (u8 *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+		ctrblk = get_free_page(GFP_KERNEL);</span>
 		if (!ctrblk) {
 			ret = -ENOMEM;
 			goto ctr_aes_err;
<span class="p_header">diff --git a/arch/s390/crypto/des_s390.c b/arch/s390/crypto/des_s390.c</span>
<span class="p_header">index 9f402dc..6f7288b 100644</span>
<span class="p_header">--- a/arch/s390/crypto/des_s390.c</span>
<span class="p_header">+++ b/arch/s390/crypto/des_s390.c</span>
<span class="p_chunk">@@ -573,7 +573,7 @@</span> <span class="p_context"> static int __init des_s390_init(void)</span>
 		ret = crypto_register_alg(&amp;ctr_des3_alg);
 		if (ret)
 			goto ctr_des3_err;
<span class="p_del">-		ctrblk = (u8 *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+		ctrblk = get_free_page(GFP_KERNEL);</span>
 		if (!ctrblk) {
 			ret = -ENOMEM;
 			goto ctr_mem_err;
<span class="p_header">diff --git a/arch/s390/crypto/prng.c b/arch/s390/crypto/prng.c</span>
<span class="p_header">index d3835d2..2971c2c 100644</span>
<span class="p_header">--- a/arch/s390/crypto/prng.c</span>
<span class="p_header">+++ b/arch/s390/crypto/prng.c</span>
<span class="p_chunk">@@ -116,7 +116,7 @@</span> <span class="p_context"> static int generate_entropy(u8 *ebuf, size_t nbytes)</span>
 	int n, ret = 0;
 	u8 *pg, *h, hash[32];
 
<span class="p_del">-	pg = (u8 *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	pg = get_free_page(GFP_KERNEL);</span>
 	if (!pg) {
 		prng_errorflag = PRNG_GEN_ENTROPY_FAILED;
 		return -ENOMEM;
<span class="p_header">diff --git a/arch/s390/kernel/kprobes.c b/arch/s390/kernel/kprobes.c</span>
<span class="p_header">index 2021dc0..8e2c032 100644</span>
<span class="p_header">--- a/arch/s390/kernel/kprobes.c</span>
<span class="p_header">+++ b/arch/s390/kernel/kprobes.c</span>
<span class="p_chunk">@@ -43,7 +43,7 @@</span> <span class="p_context"> DEFINE_INSN_CACHE_OPS(dmainsn);</span>
 
 static void *alloc_dmainsn_page(void)
 {
<span class="p_del">-	return (void *)__get_free_page(GFP_KERNEL | GFP_DMA);</span>
<span class="p_add">+	return get_free_page(GFP_KERNEL | GFP_DMA);</span>
 }
 
 static void free_dmainsn_page(void *page)
<span class="p_header">diff --git a/arch/s390/kernel/topology.c b/arch/s390/kernel/topology.c</span>
<span class="p_header">index 40b8102..b7994b5 100644</span>
<span class="p_header">--- a/arch/s390/kernel/topology.c</span>
<span class="p_header">+++ b/arch/s390/kernel/topology.c</span>
<span class="p_chunk">@@ -481,7 +481,7 @@</span> <span class="p_context"> static int __init s390_topology_init(void)</span>
 
 	if (!MACHINE_HAS_TOPOLOGY)
 		return 0;
<span class="p_del">-	tl_info = (struct sysinfo_15_1_x *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	tl_info = get_free_page(GFP_KERNEL);</span>
 	info = tl_info;
 	store_topology(info);
 	pr_info(&quot;The CPU configuration topology of the machine is:&quot;);
<span class="p_header">diff --git a/arch/s390/mm/cmm.c b/arch/s390/mm/cmm.c</span>
<span class="p_header">index e5879ba..4236961 100644</span>
<span class="p_header">--- a/arch/s390/mm/cmm.c</span>
<span class="p_header">+++ b/arch/s390/mm/cmm.c</span>
<span class="p_chunk">@@ -67,7 +67,7 @@</span> <span class="p_context"> static long cmm_alloc_pages(long nr, long *counter,</span>
 	void *addr;
 
 	while (nr) {
<span class="p_del">-		addr = (void *)__get_free_page(GFP_NOIO);</span>
<span class="p_add">+		addr = get_free_page(GFP_NOIO);</span>
 		if (!addr)
 			break;
 		spin_lock(&amp;cmm_lock);
<span class="p_chunk">@@ -75,8 +75,7 @@</span> <span class="p_context"> static long cmm_alloc_pages(long nr, long *counter,</span>
 		if (!pa || pa-&gt;index &gt;= CMM_NR_PAGES) {
 			/* Need a new page for the page list. */
 			spin_unlock(&amp;cmm_lock);
<span class="p_del">-			npa = (struct cmm_page_array *)</span>
<span class="p_del">-				__get_free_page(GFP_NOIO);</span>
<span class="p_add">+			npa = get_free_page(GFP_NOIO);</span>
 			if (!npa) {
 				free_page(addr);
 				break;
<span class="p_header">diff --git a/arch/s390/mm/maccess.c b/arch/s390/mm/maccess.c</span>
<span class="p_header">index e20811c..93241b9 100644</span>
<span class="p_header">--- a/arch/s390/mm/maccess.c</span>
<span class="p_header">+++ b/arch/s390/mm/maccess.c</span>
<span class="p_chunk">@@ -137,7 +137,7 @@</span> <span class="p_context"> int copy_to_user_real(void __user *dest, void *src, unsigned long count)</span>
 	int offs = 0, size, rc;
 	char *buf;
 
<span class="p_del">-	buf = (char *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	buf = get_free_page(GFP_KERNEL);</span>
 	if (!buf)
 		return -ENOMEM;
 	rc = -EFAULT;
<span class="p_chunk">@@ -189,7 +189,7 @@</span> <span class="p_context"> void *xlate_dev_mem_ptr(phys_addr_t addr)</span>
 	preempt_disable();
 	if (is_swapped(addr)) {
 		size = PAGE_SIZE - (addr &amp; ~PAGE_MASK);
<span class="p_del">-		bounce = (void *) __get_free_page(GFP_ATOMIC);</span>
<span class="p_add">+		bounce = get_free_page(GFP_ATOMIC);</span>
 		if (bounce)
 			memcpy_absolute(bounce, (void *) addr, size);
 	}
<span class="p_header">diff --git a/arch/s390/mm/pgtable.c b/arch/s390/mm/pgtable.c</span>
<span class="p_header">index df429c6..5078169 100644</span>
<span class="p_header">--- a/arch/s390/mm/pgtable.c</span>
<span class="p_header">+++ b/arch/s390/mm/pgtable.c</span>
<span class="p_chunk">@@ -1113,8 +1113,7 @@</span> <span class="p_context"> void tlb_remove_table(struct mmu_gather *tlb, void *table)</span>
 
 	tlb-&gt;mm-&gt;context.flush_mm = 1;
 	if (*batch == NULL) {
<span class="p_del">-		*batch = (struct mmu_table_batch *)</span>
<span class="p_del">-			__get_free_page(GFP_NOWAIT | __GFP_NOWARN);</span>
<span class="p_add">+		*batch = get_free_page(GFP_NOWAIT | __GFP_NOWARN);</span>
 		if (*batch == NULL) {
 			__tlb_flush_mm_lazy(tlb-&gt;mm);
 			tlb_remove_table_one(table);
<span class="p_header">diff --git a/arch/tile/mm/elf.c b/arch/tile/mm/elf.c</span>
<span class="p_header">index cbc81ab..a8a58cd 100644</span>
<span class="p_header">--- a/arch/tile/mm/elf.c</span>
<span class="p_header">+++ b/arch/tile/mm/elf.c</span>
<span class="p_chunk">@@ -48,7 +48,7 @@</span> <span class="p_context"> static int notify_exec(struct mm_struct *mm)</span>
 	if (!sim_is_simulator())
 		return 1;
 
<span class="p_del">-	buf = (char *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	buf = get_free_page(GFP_KERNEL);</span>
 	if (buf == NULL)
 		return 0;
 
<span class="p_header">diff --git a/arch/um/kernel/mem.c b/arch/um/kernel/mem.c</span>
<span class="p_header">index 8936388..5bbd2eb 100644</span>
<span class="p_header">--- a/arch/um/kernel/mem.c</span>
<span class="p_header">+++ b/arch/um/kernel/mem.c</span>
<span class="p_chunk">@@ -184,7 +184,7 @@</span> <span class="p_context"> void free_initrd_mem(unsigned long start, unsigned long end)</span>
 
 pgd_t *pgd_alloc(struct mm_struct *mm)
 {
<span class="p_del">-	pgd_t *pgd = (pgd_t *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	pgd_t *pgd = get_free_page(GFP_KERNEL);</span>
 
 	if (pgd) {
 		memset(pgd, 0, USER_PTRS_PER_PGD * sizeof(pgd_t));
<span class="p_chunk">@@ -204,7 +204,7 @@</span> <span class="p_context"> pte_t *pte_alloc_one_kernel(struct mm_struct *mm, unsigned long address)</span>
 {
 	pte_t *pte;
 
<span class="p_del">-	pte = (pte_t *)__get_free_page(GFP_KERNEL|__GFP_REPEAT|__GFP_ZERO);</span>
<span class="p_add">+	pte = get_free_page(GFP_KERNEL|__GFP_REPEAT|__GFP_ZERO);</span>
 	return pte;
 }
 
<span class="p_chunk">@@ -225,7 +225,7 @@</span> <span class="p_context"> pgtable_t pte_alloc_one(struct mm_struct *mm, unsigned long address)</span>
 #ifdef CONFIG_3_LEVEL_PGTABLES
 pmd_t *pmd_alloc_one(struct mm_struct *mm, unsigned long address)
 {
<span class="p_del">-	pmd_t *pmd = (pmd_t *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	pmd_t *pmd = get_free_page(GFP_KERNEL);</span>
 
 	if (pmd)
 		memset(pmd, 0, PAGE_SIZE);
<span class="p_header">diff --git a/arch/unicore32/include/asm/pgalloc.h b/arch/unicore32/include/asm/pgalloc.h</span>
<span class="p_header">index 3287878..3b03876 100644</span>
<span class="p_header">--- a/arch/unicore32/include/asm/pgalloc.h</span>
<span class="p_header">+++ b/arch/unicore32/include/asm/pgalloc.h</span>
<span class="p_chunk">@@ -38,7 +38,7 @@</span> <span class="p_context"> pte_alloc_one_kernel(struct mm_struct *mm, unsigned long addr)</span>
 {
 	pte_t *pte;
 
<span class="p_del">-	pte = (pte_t *)__get_free_page(PGALLOC_GFP);</span>
<span class="p_add">+	pte = get_free_page(PGALLOC_GFP);</span>
 	if (pte)
 		clean_dcache_area(pte, PTRS_PER_PTE * sizeof(pte_t));
 
<span class="p_header">diff --git a/arch/x86/kvm/mmu.c b/arch/x86/kvm/mmu.c</span>
<span class="p_header">index fb86efb..c3f7453 100644</span>
<span class="p_header">--- a/arch/x86/kvm/mmu.c</span>
<span class="p_header">+++ b/arch/x86/kvm/mmu.c</span>
<span class="p_chunk">@@ -692,7 +692,7 @@</span> <span class="p_context"> static int mmu_topup_memory_cache_page(struct kvm_mmu_memory_cache *cache,</span>
 	if (cache-&gt;nobjs &gt;= min)
 		return 0;
 	while (cache-&gt;nobjs &lt; ARRAY_SIZE(cache-&gt;objects)) {
<span class="p_del">-		page = (void *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+		page = get_free_page(GFP_KERNEL);</span>
 		if (!page)
 			return -ENOMEM;
 		cache-&gt;objects[cache-&gt;nobjs++] = page;
<span class="p_header">diff --git a/arch/x86/kvm/vmx.c b/arch/x86/kvm/vmx.c</span>
<span class="p_header">index 7206fee..fe36bf2 100644</span>
<span class="p_header">--- a/arch/x86/kvm/vmx.c</span>
<span class="p_header">+++ b/arch/x86/kvm/vmx.c</span>
<span class="p_chunk">@@ -6088,44 +6088,41 @@</span> <span class="p_context"> static __init int hardware_setup(void)</span>
 	for (i = 0; i &lt; ARRAY_SIZE(vmx_msr_index); ++i)
 		kvm_define_shared_msr(i, vmx_msr_index[i]);
 
<span class="p_del">-	vmx_io_bitmap_a = (unsigned long *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	vmx_io_bitmap_a = get_free_page(GFP_KERNEL);</span>
 	if (!vmx_io_bitmap_a)
 		return r;
 
<span class="p_del">-	vmx_io_bitmap_b = (unsigned long *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	vmx_io_bitmap_b = get_free_page(GFP_KERNEL);</span>
 	if (!vmx_io_bitmap_b)
 		goto out;
 
<span class="p_del">-	vmx_msr_bitmap_legacy = (unsigned long *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	vmx_msr_bitmap_legacy = get_free_page(GFP_KERNEL);</span>
 	if (!vmx_msr_bitmap_legacy)
 		goto out1;
 
<span class="p_del">-	vmx_msr_bitmap_legacy_x2apic =</span>
<span class="p_del">-				(unsigned long *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	vmx_msr_bitmap_legacy_x2apic = get_free_page(GFP_KERNEL);</span>
 	if (!vmx_msr_bitmap_legacy_x2apic)
 		goto out2;
 
<span class="p_del">-	vmx_msr_bitmap_longmode = (unsigned long *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	vmx_msr_bitmap_longmode = get_free_page(GFP_KERNEL);</span>
 	if (!vmx_msr_bitmap_longmode)
 		goto out3;
 
<span class="p_del">-	vmx_msr_bitmap_longmode_x2apic =</span>
<span class="p_del">-				(unsigned long *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	vmx_msr_bitmap_longmode_x2apic = get_free_page(GFP_KERNEL);</span>
 	if (!vmx_msr_bitmap_longmode_x2apic)
 		goto out4;
 
 	if (nested) {
<span class="p_del">-		vmx_msr_bitmap_nested =</span>
<span class="p_del">-			(unsigned long *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+		vmx_msr_bitmap_nested = get_free_page(GFP_KERNEL);</span>
 		if (!vmx_msr_bitmap_nested)
 			goto out5;
 	}
 
<span class="p_del">-	vmx_vmread_bitmap = (unsigned long *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	vmx_vmread_bitmap = get_free_page(GFP_KERNEL);</span>
 	if (!vmx_vmread_bitmap)
 		goto out6;
 
<span class="p_del">-	vmx_vmwrite_bitmap = (unsigned long *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	vmx_vmwrite_bitmap = get_free_page(GFP_KERNEL);</span>
 	if (!vmx_vmwrite_bitmap)
 		goto out7;
 
<span class="p_header">diff --git a/arch/x86/mm/pgtable.c b/arch/x86/mm/pgtable.c</span>
<span class="p_header">index 8e51a6c..d9781f0 100644</span>
<span class="p_header">--- a/arch/x86/mm/pgtable.c</span>
<span class="p_header">+++ b/arch/x86/mm/pgtable.c</span>
<span class="p_chunk">@@ -18,7 +18,7 @@</span> <span class="p_context"> gfp_t __userpte_alloc_gfp = PGALLOC_GFP | PGALLOC_USER_GFP;</span>
 
 pte_t *pte_alloc_one_kernel(struct mm_struct *mm, unsigned long address)
 {
<span class="p_del">-	return (pte_t *)__get_free_page(PGALLOC_GFP);</span>
<span class="p_add">+	return get_free_page(PGALLOC_GFP);</span>
 }
 
 pgtable_t pte_alloc_one(struct mm_struct *mm, unsigned long address)
<span class="p_chunk">@@ -209,7 +209,7 @@</span> <span class="p_context"> static int preallocate_pmds(struct mm_struct *mm, pmd_t *pmds[])</span>
 	bool failed = false;
 
 	for(i = 0; i &lt; PREALLOCATED_PMDS; i++) {
<span class="p_del">-		pmd_t *pmd = (pmd_t *)__get_free_page(PGALLOC_GFP);</span>
<span class="p_add">+		pmd_t *pmd = get_free_page(PGALLOC_GFP);</span>
 		if (!pmd)
 			failed = true;
 		if (pmd &amp;&amp; !pgtable_pmd_page_ctor(virt_to_page(pmd))) {
<span class="p_chunk">@@ -323,7 +323,7 @@</span> <span class="p_context"> static inline pgd_t *_pgd_alloc(void)</span>
 	 * We allocate one page for pgd.
 	 */
 	if (!SHARED_KERNEL_PMD)
<span class="p_del">-		return (pgd_t *)__get_free_page(PGALLOC_GFP);</span>
<span class="p_add">+		return get_free_page(PGALLOC_GFP);</span>
 
 	/*
 	 * Now PAE kernel is not running as a Xen domain. We can allocate
<span class="p_chunk">@@ -342,7 +342,7 @@</span> <span class="p_context"> static inline void _pgd_free(pgd_t *pgd)</span>
 #else
 static inline pgd_t *_pgd_alloc(void)
 {
<span class="p_del">-	return (pgd_t *)__get_free_page(PGALLOC_GFP);</span>
<span class="p_add">+	return get_free_page(PGALLOC_GFP);</span>
 }
 
 static inline void _pgd_free(pgd_t *pgd)
<span class="p_header">diff --git a/arch/x86/pci/pcbios.c b/arch/x86/pci/pcbios.c</span>
<span class="p_header">index 674ecff..f5a9458 100644</span>
<span class="p_header">--- a/arch/x86/pci/pcbios.c</span>
<span class="p_header">+++ b/arch/x86/pci/pcbios.c</span>
<span class="p_chunk">@@ -385,7 +385,7 @@</span> <span class="p_context"> struct irq_routing_table * pcibios_get_irq_routing_table(void)</span>
 
 	if (!pci_bios_present)
 		return NULL;
<span class="p_del">-	page = (void *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	page = get_free_page(GFP_KERNEL);</span>
 	if (!page)
 		return NULL;
 	opt.table = page;
<span class="p_header">diff --git a/arch/x86/um/ldt.c b/arch/x86/um/ldt.c</span>
<span class="p_header">index 5264f55..60b4314 100644</span>
<span class="p_header">--- a/arch/x86/um/ldt.c</span>
<span class="p_header">+++ b/arch/x86/um/ldt.c</span>
<span class="p_chunk">@@ -157,8 +157,7 @@</span> <span class="p_context"> static int write_ldt(void __user * ptr, unsigned long bytecount, int func)</span>
 			if (i == 0)
 				memcpy(&amp;entry0, ldt-&gt;u.entries,
 				       sizeof(entry0));
<span class="p_del">-			ldt-&gt;u.pages[i] = (struct ldt_entry *)</span>
<span class="p_del">-				__get_free_page(GFP_KERNEL|__GFP_ZERO);</span>
<span class="p_add">+			ldt-&gt;u.pages[i] = get_free_page(GFP_KERNEL|__GFP_ZERO);</span>
 			if (!ldt-&gt;u.pages[i]) {
 				err = -ENOMEM;
 				/* Undo the change in host */
<span class="p_header">diff --git a/arch/x86/xen/mmu.c b/arch/x86/xen/mmu.c</span>
<span class="p_header">index bb7b2e5..d06a96d 100644</span>
<span class="p_header">--- a/arch/x86/xen/mmu.c</span>
<span class="p_header">+++ b/arch/x86/xen/mmu.c</span>
<span class="p_chunk">@@ -1523,7 +1523,7 @@</span> <span class="p_context"> static int xen_pgd_alloc(struct mm_struct *mm)</span>
 
 		ret = -ENOMEM;
 
<span class="p_del">-		user_pgd = (pgd_t *)__get_free_page(GFP_KERNEL | __GFP_ZERO);</span>
<span class="p_add">+		user_pgd = get_free_page(GFP_KERNEL | __GFP_ZERO);</span>
 		page-&gt;private = (unsigned long)user_pgd;
 
 		if (user_pgd != NULL) {
<span class="p_header">diff --git a/arch/x86/xen/p2m.c b/arch/x86/xen/p2m.c</span>
<span class="p_header">index b72eab3..b2505a6 100644</span>
<span class="p_header">--- a/arch/x86/xen/p2m.c</span>
<span class="p_header">+++ b/arch/x86/xen/p2m.c</span>
<span class="p_chunk">@@ -182,7 +182,7 @@</span> <span class="p_context"> static void * __ref alloc_p2m_page(void)</span>
 	if (unlikely(!slab_is_available()))
 		return alloc_bootmem_align(PAGE_SIZE, PAGE_SIZE);
 
<span class="p_del">-	return (void *)__get_free_page(GFP_KERNEL | __GFP_REPEAT);</span>
<span class="p_add">+	return get_free_page(GFP_KERNEL | __GFP_REPEAT);</span>
 }
 
 static void __ref free_p2m_page(void *p)
<span class="p_header">diff --git a/arch/xtensa/include/asm/pgalloc.h b/arch/xtensa/include/asm/pgalloc.h</span>
<span class="p_header">index 2a7631f..65657a6 100644</span>
<span class="p_header">--- a/arch/xtensa/include/asm/pgalloc.h</span>
<span class="p_header">+++ b/arch/xtensa/include/asm/pgalloc.h</span>
<span class="p_chunk">@@ -44,7 +44,7 @@</span> <span class="p_context"> static inline pte_t *pte_alloc_one_kernel(struct mm_struct *mm,</span>
 	pte_t *ptep;
 	int i;
 
<span class="p_del">-	ptep = (pte_t *)__get_free_page(GFP_KERNEL|__GFP_REPEAT);</span>
<span class="p_add">+	ptep = get_free_page(GFP_KERNEL|__GFP_REPEAT);</span>
 	if (!ptep)
 		return NULL;
 	for (i = 0; i &lt; 1024; i++)
<span class="p_header">diff --git a/block/partitions/check.c b/block/partitions/check.c</span>
<span class="p_header">index dc43d02b..6e69263 100644</span>
<span class="p_header">--- a/block/partitions/check.c</span>
<span class="p_header">+++ b/block/partitions/check.c</span>
<span class="p_chunk">@@ -147,7 +147,7 @@</span> <span class="p_context"> check_partition(struct gendisk *hd, struct block_device *bdev)</span>
 	state = allocate_partitions(hd);
 	if (!state)
 		return NULL;
<span class="p_del">-	state-&gt;pp_buf = (char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	state-&gt;pp_buf = get_free_page(GFP_KERNEL);</span>
 	if (!state-&gt;pp_buf) {
 		free_partitions(state);
 		return NULL;
<span class="p_header">diff --git a/crypto/blkcipher.c b/crypto/blkcipher.c</span>
<span class="p_header">index d46ebfa..97274e7 100644</span>
<span class="p_header">--- a/crypto/blkcipher.c</span>
<span class="p_header">+++ b/crypto/blkcipher.c</span>
<span class="p_chunk">@@ -240,7 +240,7 @@</span> <span class="p_context"> static int blkcipher_walk_next(struct blkcipher_desc *desc,</span>
 	    !scatterwalk_aligned(&amp;walk-&gt;out, walk-&gt;alignmask)) {
 		walk-&gt;flags |= BLKCIPHER_WALK_COPY;
 		if (!walk-&gt;page) {
<span class="p_del">-			walk-&gt;page = (void *)__get_free_page(GFP_ATOMIC);</span>
<span class="p_add">+			walk-&gt;page = get_free_page(GFP_ATOMIC);</span>
 			if (!walk-&gt;page)
 				n = 0;
 		}
<span class="p_header">diff --git a/crypto/tcrypt.c b/crypto/tcrypt.c</span>
<span class="p_header">index 5cc0a85..df693aa 100644</span>
<span class="p_header">--- a/crypto/tcrypt.c</span>
<span class="p_header">+++ b/crypto/tcrypt.c</span>
<span class="p_chunk">@@ -255,7 +255,7 @@</span> <span class="p_context"> static int testmgr_alloc_buf(char *buf[XBUFSIZE])</span>
 	int i;
 
 	for (i = 0; i &lt; XBUFSIZE; i++) {
<span class="p_del">-		buf[i] = (void *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+		buf[i] = get_free_page(GFP_KERNEL);</span>
 		if (!buf[i])
 			goto err_free_buf;
 	}
<span class="p_chunk">@@ -2204,7 +2204,7 @@</span> <span class="p_context"> static int __init tcrypt_mod_init(void)</span>
 	int i;
 
 	for (i = 0; i &lt; TVMEMSIZE; i++) {
<span class="p_del">-		tvmem[i] = (void *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+		tvmem[i] = get_free_page(GFP_KERNEL);</span>
 		if (!tvmem[i])
 			goto err_free_tv;
 	}
<span class="p_header">diff --git a/crypto/testmgr.c b/crypto/testmgr.c</span>
<span class="p_header">index dc8d8f7..47dd4b8 100644</span>
<span class="p_header">--- a/crypto/testmgr.c</span>
<span class="p_header">+++ b/crypto/testmgr.c</span>
<span class="p_chunk">@@ -166,7 +166,7 @@</span> <span class="p_context"> static int testmgr_alloc_buf(char *buf[XBUFSIZE])</span>
 	int i;
 
 	for (i = 0; i &lt; XBUFSIZE; i++) {
<span class="p_del">-		buf[i] = (void *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+		buf[i] = get_free_page(GFP_KERNEL);</span>
 		if (!buf[i])
 			goto err_free_buf;
 	}
<span class="p_header">diff --git a/drivers/acpi/nvs.c b/drivers/acpi/nvs.c</span>
<span class="p_header">index 36bf798..c07363c 100644</span>
<span class="p_header">--- a/drivers/acpi/nvs.c</span>
<span class="p_header">+++ b/drivers/acpi/nvs.c</span>
<span class="p_chunk">@@ -155,7 +155,7 @@</span> <span class="p_context"> int suspend_nvs_alloc(void)</span>
 	struct nvs_page *entry;
 
 	list_for_each_entry(entry, &amp;nvs_list, node) {
<span class="p_del">-		entry-&gt;data = (void *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+		entry-&gt;data = get_free_page(GFP_KERNEL);</span>
 		if (!entry-&gt;data) {
 			suspend_nvs_free();
 			return -ENOMEM;
<span class="p_header">diff --git a/drivers/block/cciss.c b/drivers/block/cciss.c</span>
<span class="p_header">index a055899..9e0889f 100644</span>
<span class="p_header">--- a/drivers/block/cciss.c</span>
<span class="p_header">+++ b/drivers/block/cciss.c</span>
<span class="p_chunk">@@ -514,7 +514,7 @@</span> <span class="p_context"> cciss_proc_write(struct file *file, const char __user *buf,</span>
 	if (!buf || length &gt; PAGE_SIZE - 1)
 		return -EINVAL;
 
<span class="p_del">-	buffer = (char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	buffer = get_free_page(GFP_KERNEL);</span>
 	if (!buffer)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/drivers/block/drbd/drbd_main.c b/drivers/block/drbd/drbd_main.c</span>
<span class="p_header">index c5f9c21..06ca3ef 100644</span>
<span class="p_header">--- a/drivers/block/drbd/drbd_main.c</span>
<span class="p_header">+++ b/drivers/block/drbd/drbd_main.c</span>
<span class="p_chunk">@@ -2487,10 +2487,10 @@</span> <span class="p_context"> found:</span>
 
 static int drbd_alloc_socket(struct drbd_socket *socket)
 {
<span class="p_del">-	socket-&gt;rbuf = (void *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	socket-&gt;rbuf = get_free_page(GFP_KERNEL);</span>
 	if (!socket-&gt;rbuf)
 		return -ENOMEM;
<span class="p_del">-	socket-&gt;sbuf = (void *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	socket-&gt;sbuf = get_free_page(GFP_KERNEL);</span>
 	if (!socket-&gt;sbuf)
 		return -ENOMEM;
 	return 0;
<span class="p_header">diff --git a/drivers/char/agp/amd-k7-agp.c b/drivers/char/agp/amd-k7-agp.c</span>
<span class="p_header">index 3835c1b..505be8d 100644</span>
<span class="p_header">--- a/drivers/char/agp/amd-k7-agp.c</span>
<span class="p_header">+++ b/drivers/char/agp/amd-k7-agp.c</span>
<span class="p_chunk">@@ -37,7 +37,7 @@</span> <span class="p_context"> static int amd_create_page_map(struct amd_page_map *page_map)</span>
 {
 	int i;
 
<span class="p_del">-	page_map-&gt;real = (unsigned long *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	page_map-&gt;real = get_free_page(GFP_KERNEL);</span>
 	if (page_map-&gt;real == NULL)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/drivers/char/agp/ati-agp.c b/drivers/char/agp/ati-agp.c</span>
<span class="p_header">index 95651e2..758e7c6 100644</span>
<span class="p_header">--- a/drivers/char/agp/ati-agp.c</span>
<span class="p_header">+++ b/drivers/char/agp/ati-agp.c</span>
<span class="p_chunk">@@ -56,7 +56,7 @@</span> <span class="p_context"> static int ati_create_page_map(struct ati_page_map *page_map)</span>
 {
 	int i, err = 0;
 
<span class="p_del">-	page_map-&gt;real = (unsigned long *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	page_map-&gt;real = get_free_page(GFP_KERNEL);</span>
 	if (page_map-&gt;real == NULL)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/drivers/char/agp/sworks-agp.c b/drivers/char/agp/sworks-agp.c</span>
<span class="p_header">index 96d2e55..b590985 100644</span>
<span class="p_header">--- a/drivers/char/agp/sworks-agp.c</span>
<span class="p_header">+++ b/drivers/char/agp/sworks-agp.c</span>
<span class="p_chunk">@@ -48,7 +48,7 @@</span> <span class="p_context"> static int serverworks_create_page_map(struct serverworks_page_map *page_map)</span>
 {
 	int i;
 
<span class="p_del">-	page_map-&gt;real = (unsigned long *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	page_map-&gt;real = get_free_page(GFP_KERNEL);</span>
 	if (page_map-&gt;real == NULL) {
 		return -ENOMEM;
 	}
<span class="p_header">diff --git a/drivers/char/mem.c b/drivers/char/mem.c</span>
<span class="p_header">index 63f7056..2a6ce6b 100644</span>
<span class="p_header">--- a/drivers/char/mem.c</span>
<span class="p_header">+++ b/drivers/char/mem.c</span>
<span class="p_chunk">@@ -424,7 +424,7 @@</span> <span class="p_context"> static ssize_t read_kmem(struct file *file, char __user *buf,</span>
 	}
 
 	if (count &gt; 0) {
<span class="p_del">-		kbuf = (char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+		kbuf = get_free_page(GFP_KERNEL);</span>
 		if (!kbuf)
 			return -ENOMEM;
 		while (count &gt; 0) {
<span class="p_chunk">@@ -524,7 +524,7 @@</span> <span class="p_context"> static ssize_t write_kmem(struct file *file, const char __user *buf,</span>
 	}
 
 	if (count &gt; 0) {
<span class="p_del">-		kbuf = (char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+		kbuf = get_free_page(GFP_KERNEL);</span>
 		if (!kbuf)
 			return wrote ? wrote : -ENOMEM;
 		while (count &gt; 0) {
<span class="p_header">diff --git a/drivers/char/tpm/xen-tpmfront.c b/drivers/char/tpm/xen-tpmfront.c</span>
<span class="p_header">index 2ccd0c9..abd4162 100644</span>
<span class="p_header">--- a/drivers/char/tpm/xen-tpmfront.c</span>
<span class="p_header">+++ b/drivers/char/tpm/xen-tpmfront.c</span>
<span class="p_chunk">@@ -195,7 +195,7 @@</span> <span class="p_context"> static int setup_ring(struct xenbus_device *dev, struct tpm_private *priv)</span>
 	int rv;
 	grant_ref_t gref;
 
<span class="p_del">-	priv-&gt;shr = (void *)__get_free_page(GFP_KERNEL|__GFP_ZERO);</span>
<span class="p_add">+	priv-&gt;shr = get_free_page(GFP_KERNEL|__GFP_ZERO);</span>
 	if (!priv-&gt;shr) {
 		xenbus_dev_fatal(dev, -ENOMEM, &quot;allocating shared ring&quot;);
 		return -ENOMEM;
<span class="p_header">diff --git a/drivers/char/xilinx_hwicap/xilinx_hwicap.c b/drivers/char/xilinx_hwicap/xilinx_hwicap.c</span>
<span class="p_header">index 7b09193..7175120a 100644</span>
<span class="p_header">--- a/drivers/char/xilinx_hwicap/xilinx_hwicap.c</span>
<span class="p_header">+++ b/drivers/char/xilinx_hwicap/xilinx_hwicap.c</span>
<span class="p_chunk">@@ -456,7 +456,7 @@</span> <span class="p_context"> hwicap_write(struct file *file, const char __user *buf,</span>
 		goto error;
 	}
 
<span class="p_del">-	kbuf = (u32 *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	kbuf = get_free_page(GFP_KERNEL);</span>
 	if (!kbuf) {
 		status = -ENOMEM;
 		goto error;
<span class="p_header">diff --git a/drivers/firewire/ohci.c b/drivers/firewire/ohci.c</span>
<span class="p_header">index f7303dd..bf433b7 100644</span>
<span class="p_header">--- a/drivers/firewire/ohci.c</span>
<span class="p_header">+++ b/drivers/firewire/ohci.c</span>
<span class="p_chunk">@@ -2999,7 +2999,7 @@</span> <span class="p_context"> static struct fw_iso_context *ohci_allocate_iso_context(struct fw_card *card,</span>
 
 	memset(ctx, 0, sizeof(*ctx));
 	ctx-&gt;header_length = 0;
<span class="p_del">-	ctx-&gt;header = (void *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	ctx-&gt;header = get_free_page(GFP_KERNEL);</span>
 	if (ctx-&gt;header == NULL) {
 		ret = -ENOMEM;
 		goto out;
<span class="p_header">diff --git a/drivers/gpu/drm/via/via_dmablit.c b/drivers/gpu/drm/via/via_dmablit.c</span>
<span class="p_header">index 869282d..5fa7c6d 100644</span>
<span class="p_header">--- a/drivers/gpu/drm/via/via_dmablit.c</span>
<span class="p_header">+++ b/drivers/gpu/drm/via/via_dmablit.c</span>
<span class="p_chunk">@@ -277,8 +277,7 @@</span> <span class="p_context"> via_alloc_desc_pages(drm_via_sg_info_t *vsg)</span>
 
 	vsg-&gt;state = dr_via_desc_pages_alloc;
 	for (i = 0; i &lt; vsg-&gt;num_desc_pages; ++i) {
<span class="p_del">-		if (NULL == (vsg-&gt;desc_pages[i] =</span>
<span class="p_del">-			     (drm_via_descriptor_t *) __get_free_page(GFP_KERNEL)))</span>
<span class="p_add">+		if (NULL == (vsg-&gt;desc_pages[i] = get_free_page(GFP_KERNEL)))</span>
 			return -ENOMEM;
 	}
 	DRM_DEBUG(&quot;Allocated %d pages for %d descriptors.\n&quot;, vsg-&gt;num_desc_pages,
<span class="p_header">diff --git a/drivers/ide/ide-proc.c b/drivers/ide/ide-proc.c</span>
<span class="p_header">index 0002937..cbb2ba2 100644</span>
<span class="p_header">--- a/drivers/ide/ide-proc.c</span>
<span class="p_header">+++ b/drivers/ide/ide-proc.c</span>
<span class="p_chunk">@@ -349,7 +349,7 @@</span> <span class="p_context"> static ssize_t ide_settings_proc_write(struct file *file, const char __user *buf</span>
 	if (count &gt;= PAGE_SIZE)
 		return -EINVAL;
 
<span class="p_del">-	s = buf = (char *)__get_free_page(GFP_USER);</span>
<span class="p_add">+	s = buf = get_free_page(GFP_USER);</span>
 	if (!buf)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/drivers/infiniband/core/umem.c b/drivers/infiniband/core/umem.c</span>
<span class="p_header">index a81e139..61b9417 100644</span>
<span class="p_header">--- a/drivers/infiniband/core/umem.c</span>
<span class="p_header">+++ b/drivers/infiniband/core/umem.c</span>
<span class="p_chunk">@@ -147,7 +147,7 @@</span> <span class="p_context"> struct ib_umem *ib_umem_get(struct ib_ucontext *context, unsigned long addr,</span>
 	/* We assume the memory is from hugetlb until proved otherwise */
 	umem-&gt;hugetlb   = 1;
 
<span class="p_del">-	page_list = (struct page **) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	page_list = get_free_page(GFP_KERNEL);</span>
 	if (!page_list) {
 		kfree(umem);
 		return ERR_PTR(-ENOMEM);
<span class="p_chunk">@@ -157,7 +157,7 @@</span> <span class="p_context"> struct ib_umem *ib_umem_get(struct ib_ucontext *context, unsigned long addr,</span>
 	 * if we can&#39;t alloc the vma_list, it&#39;s not so bad;
 	 * just assume the memory is not hugetlb memory
 	 */
<span class="p_del">-	vma_list = (struct vm_area_struct **) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	vma_list = get_free_page(GFP_KERNEL);</span>
 	if (!vma_list)
 		umem-&gt;hugetlb = 0;
 
<span class="p_header">diff --git a/drivers/infiniband/core/umem_odp.c b/drivers/infiniband/core/umem_odp.c</span>
<span class="p_header">index 8b14a3f..c0f950ad 100644</span>
<span class="p_header">--- a/drivers/infiniband/core/umem_odp.c</span>
<span class="p_header">+++ b/drivers/infiniband/core/umem_odp.c</span>
<span class="p_chunk">@@ -535,7 +535,7 @@</span> <span class="p_context"> int ib_umem_odp_map_dma_pages(struct ib_umem *umem, u64 user_virt, u64 bcnt,</span>
 	    user_virt + bcnt &gt; ib_umem_end(umem))
 		return -EFAULT;
 
<span class="p_del">-	local_page_list = (struct page **)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	local_page_list = get_free_page(GFP_KERNEL);</span>
 	if (!local_page_list)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/drivers/infiniband/hw/cxgb3/iwch_provider.c b/drivers/infiniband/hw/cxgb3/iwch_provider.c</span>
<span class="p_header">index a80b709..db0b414 100644</span>
<span class="p_header">--- a/drivers/infiniband/hw/cxgb3/iwch_provider.c</span>
<span class="p_header">+++ b/drivers/infiniband/hw/cxgb3/iwch_provider.c</span>
<span class="p_chunk">@@ -660,7 +660,7 @@</span> <span class="p_context"> static struct ib_mr *iwch_reg_user_mr(struct ib_pd *pd, u64 start, u64 length,</span>
 	if (err)
 		goto err;
 
<span class="p_del">-	pages = (__be64 *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	pages = get_free_page(GFP_KERNEL);</span>
 	if (!pages) {
 		err = -ENOMEM;
 		goto err_pbl;
<span class="p_header">diff --git a/drivers/infiniband/hw/cxgb4/device.c b/drivers/infiniband/hw/cxgb4/device.c</span>
<span class="p_header">index 870ac06..f519bc1 100644</span>
<span class="p_header">--- a/drivers/infiniband/hw/cxgb4/device.c</span>
<span class="p_header">+++ b/drivers/infiniband/hw/cxgb4/device.c</span>
<span class="p_chunk">@@ -848,8 +848,7 @@</span> <span class="p_context"> static int c4iw_rdev_open(struct c4iw_rdev *rdev)</span>
 		printk(KERN_ERR MOD &quot;error %d initializing ocqp pool\n&quot;, err);
 		goto err4;
 	}
<span class="p_del">-	rdev-&gt;status_page = (struct t4_dev_status_page *)</span>
<span class="p_del">-			    __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	rdev-&gt;status_page = get_free_page(GFP_KERNEL);</span>
 	if (!rdev-&gt;status_page) {
 		pr_err(MOD &quot;error allocating status page\n&quot;);
 		goto err4;
<span class="p_header">diff --git a/drivers/infiniband/hw/cxgb4/mem.c b/drivers/infiniband/hw/cxgb4/mem.c</span>
<span class="p_header">index 9720caa..eb6d82d 100644</span>
<span class="p_header">--- a/drivers/infiniband/hw/cxgb4/mem.c</span>
<span class="p_header">+++ b/drivers/infiniband/hw/cxgb4/mem.c</span>
<span class="p_chunk">@@ -743,7 +743,7 @@</span> <span class="p_context"> struct ib_mr *c4iw_reg_user_mr(struct ib_pd *pd, u64 start, u64 length,</span>
 	if (err)
 		goto err;
 
<span class="p_del">-	pages = (__be64 *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	pages = get_free_page(GFP_KERNEL);</span>
 	if (!pages) {
 		err = -ENOMEM;
 		goto err_pbl;
<span class="p_header">diff --git a/drivers/infiniband/hw/mlx4/mr.c b/drivers/infiniband/hw/mlx4/mr.c</span>
<span class="p_header">index 227c99bb..c942b00 100644</span>
<span class="p_header">--- a/drivers/infiniband/hw/mlx4/mr.c</span>
<span class="p_header">+++ b/drivers/infiniband/hw/mlx4/mr.c</span>
<span class="p_chunk">@@ -96,7 +96,7 @@</span> <span class="p_context"> int mlx4_ib_umem_write_mtt(struct mlx4_ib_dev *dev, struct mlx4_mtt *mtt,</span>
 	int err = 0;
 	struct scatterlist *sg;
 
<span class="p_del">-	pages = (u64 *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	pages = get_free_page(GFP_KERNEL);</span>
 	if (!pages)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/drivers/infiniband/hw/mlx5/odp.c b/drivers/infiniband/hw/mlx5/odp.c</span>
<span class="p_header">index 899add65..a378917 100644</span>
<span class="p_header">--- a/drivers/infiniband/hw/mlx5/odp.c</span>
<span class="p_header">+++ b/drivers/infiniband/hw/mlx5/odp.c</span>
<span class="p_chunk">@@ -538,7 +538,7 @@</span> <span class="p_context"> static void mlx5_ib_mr_wqe_pfault_handler(struct mlx5_ib_qp *qp,</span>
 	u16 wqe_index = pfault-&gt;mpfault.wqe.wqe_index;
 	int requestor = pfault-&gt;mpfault.flags &amp; MLX5_PFAULT_REQUESTOR;
 
<span class="p_del">-	buffer = (char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	buffer = get_free_page(GFP_KERNEL);</span>
 	if (!buffer) {
 		mlx5_ib_err(dev, &quot;Error allocating memory for IO page fault handling.\n&quot;);
 		resume_with_error = 1;
<span class="p_header">diff --git a/drivers/infiniband/hw/mthca/mthca_provider.c b/drivers/infiniband/hw/mthca/mthca_provider.c</span>
<span class="p_header">index e95980e..4ea565c 100644</span>
<span class="p_header">--- a/drivers/infiniband/hw/mthca/mthca_provider.c</span>
<span class="p_header">+++ b/drivers/infiniband/hw/mthca/mthca_provider.c</span>
<span class="p_chunk">@@ -1026,7 +1026,7 @@</span> <span class="p_context"> static struct ib_mr *mthca_reg_user_mr(struct ib_pd *pd, u64 start, u64 length,</span>
 		goto err_umem;
 	}
 
<span class="p_del">-	pages = (u64 *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	pages = get_free_page(GFP_KERNEL);</span>
 	if (!pages) {
 		err = -ENOMEM;
 		goto err_mtt;
<span class="p_header">diff --git a/drivers/infiniband/hw/usnic/usnic_uiom.c b/drivers/infiniband/hw/usnic/usnic_uiom.c</span>
<span class="p_header">index daaaf3d..ddadc5c 100644</span>
<span class="p_header">--- a/drivers/infiniband/hw/usnic/usnic_uiom.c</span>
<span class="p_header">+++ b/drivers/infiniband/hw/usnic/usnic_uiom.c</span>
<span class="p_chunk">@@ -122,7 +122,7 @@</span> <span class="p_context"> static int usnic_uiom_get_pages(unsigned long addr, size_t size, int writable,</span>
 
 	INIT_LIST_HEAD(chunk_list);
 
<span class="p_del">-	page_list = (struct page **) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	page_list = get_free_page(GFP_KERNEL);</span>
 	if (!page_list)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/drivers/input/misc/xen-kbdfront.c b/drivers/input/misc/xen-kbdfront.c</span>
<span class="p_header">index 93f3a5c..91be47a 100644</span>
<span class="p_header">--- a/drivers/input/misc/xen-kbdfront.c</span>
<span class="p_header">+++ b/drivers/input/misc/xen-kbdfront.c</span>
<span class="p_chunk">@@ -123,7 +123,7 @@</span> <span class="p_context"> static int xenkbd_probe(struct xenbus_device *dev,</span>
 	info-&gt;gref = -1;
 	snprintf(info-&gt;phys, sizeof(info-&gt;phys), &quot;xenbus/%s&quot;, dev-&gt;nodename);
 
<span class="p_del">-	info-&gt;page = (void *)__get_free_page(GFP_KERNEL | __GFP_ZERO);</span>
<span class="p_add">+	info-&gt;page = get_free_page(GFP_KERNEL | __GFP_ZERO);</span>
 	if (!info-&gt;page)
 		goto error_nomem;
 
<span class="p_header">diff --git a/drivers/macintosh/rack-meter.c b/drivers/macintosh/rack-meter.c</span>
<span class="p_header">index ff85b7b..971dc30 100644</span>
<span class="p_header">--- a/drivers/macintosh/rack-meter.c</span>
<span class="p_header">+++ b/drivers/macintosh/rack-meter.c</span>
<span class="p_chunk">@@ -441,7 +441,7 @@</span> <span class="p_context"> static int rackmeter_probe(struct macio_dev* mdev,</span>
 	pr_debug(&quot;  dma @0x%08x\n&quot;, (unsigned int)rdma.start);
 	pr_debug(&quot;  irq %d\n&quot;, rm-&gt;irq);
 
<span class="p_del">-	rm-&gt;ubuf = (u8 *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	rm-&gt;ubuf = get_free_page(GFP_KERNEL);</span>
 	if (rm-&gt;ubuf == NULL) {
 		printk(KERN_ERR
 		       &quot;rackmeter: failed to allocate samples page !\n&quot;);
<span class="p_header">diff --git a/drivers/media/pci/pt1/pt1.c b/drivers/media/pci/pt1/pt1.c</span>
<span class="p_header">index ce4f862..b56fe66 100644</span>
<span class="p_header">--- a/drivers/media/pci/pt1/pt1.c</span>
<span class="p_header">+++ b/drivers/media/pci/pt1/pt1.c</span>
<span class="p_chunk">@@ -651,7 +651,7 @@</span> <span class="p_context"> pt1_alloc_adapter(struct pt1 *pt1)</span>
 	adap-&gt;voltage = SEC_VOLTAGE_OFF;
 	adap-&gt;sleep = 1;
 
<span class="p_del">-	buf = (u8 *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	buf = get_free_page(GFP_KERNEL);</span>
 	if (!buf) {
 		ret = -ENOMEM;
 		goto err_kfree;
<span class="p_header">diff --git a/drivers/media/pci/ttpci/av7110_ca.c b/drivers/media/pci/ttpci/av7110_ca.c</span>
<span class="p_header">index ed9c8380..c99e079 100644</span>
<span class="p_header">--- a/drivers/media/pci/ttpci/av7110_ca.c</span>
<span class="p_header">+++ b/drivers/media/pci/ttpci/av7110_ca.c</span>
<span class="p_chunk">@@ -152,7 +152,7 @@</span> <span class="p_context"> static ssize_t ci_ll_write(struct dvb_ringbuffer *cibuf, struct file *file,</span>
 {
 	int free;
 	int non_blocking = file-&gt;f_flags &amp; O_NONBLOCK;
<span class="p_del">-	u8 *page = (u8 *)__get_free_page(GFP_USER);</span>
<span class="p_add">+	u8 *page = get_free_page(GFP_USER);</span>
 	int res;
 
 	if (!page)
<span class="p_header">diff --git a/drivers/misc/cxl/pci.c b/drivers/misc/cxl/pci.c</span>
<span class="p_header">index 2750bff..5cce770 100644</span>
<span class="p_header">--- a/drivers/misc/cxl/pci.c</span>
<span class="p_header">+++ b/drivers/misc/cxl/pci.c</span>
<span class="p_chunk">@@ -790,7 +790,7 @@</span> <span class="p_context"> ssize_t cxl_afu_read_err_buffer(struct cxl_afu *afu, char *buf,</span>
 	}
 
 	/* use bounce buffer for copy */
<span class="p_del">-	tbuf = (void *)__get_free_page(GFP_TEMPORARY);</span>
<span class="p_add">+	tbuf = get_free_page(GFP_TEMPORARY);</span>
 	if (!tbuf)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/drivers/misc/ibmasm/ibmasmfs.c b/drivers/misc/ibmasm/ibmasmfs.c</span>
<span class="p_header">index 6694cca..b5385b0 100644</span>
<span class="p_header">--- a/drivers/misc/ibmasm/ibmasmfs.c</span>
<span class="p_header">+++ b/drivers/misc/ibmasm/ibmasmfs.c</span>
<span class="p_chunk">@@ -519,7 +519,7 @@</span> <span class="p_context"> static ssize_t remote_settings_file_read(struct file *file, char __user *buf, si</span>
 	if (*offset != 0)
 		return 0;
 
<span class="p_del">-	page = (unsigned char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	page = get_free_page(GFP_KERNEL);</span>
 	if (!page)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/drivers/misc/lkdtm.c b/drivers/misc/lkdtm.c</span>
<span class="p_header">index 0446145..98a1108 100644</span>
<span class="p_header">--- a/drivers/misc/lkdtm.c</span>
<span class="p_header">+++ b/drivers/misc/lkdtm.c</span>
<span class="p_chunk">@@ -627,7 +627,7 @@</span> <span class="p_context"> static ssize_t do_register_entry(enum cname which, struct file *f,</span>
 	if (count &gt;= PAGE_SIZE)
 		return -EINVAL;
 
<span class="p_del">-	buf = (char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	buf = get_free_page(GFP_KERNEL);</span>
 	if (!buf)
 		return -ENOMEM;
 	if (copy_from_user(buf, user_buf, count)) {
<span class="p_chunk">@@ -660,7 +660,7 @@</span> <span class="p_context"> static ssize_t lkdtm_debugfs_read(struct file *f, char __user *user_buf,</span>
 	char *buf;
 	int i, n, out;
 
<span class="p_del">-	buf = (char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	buf = get_free_page(GFP_KERNEL);</span>
 	if (buf == NULL)
 		return -ENOMEM;
 
<span class="p_chunk">@@ -742,7 +742,7 @@</span> <span class="p_context"> static ssize_t direct_entry(struct file *f, const char __user *user_buf,</span>
 	if (count &lt; 1)
 		return -EINVAL;
 
<span class="p_del">-	buf = (char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	buf = get_free_page(GFP_KERNEL);</span>
 	if (!buf)
 		return -ENOMEM;
 	if (copy_from_user(buf, user_buf, count)) {
<span class="p_header">diff --git a/drivers/mmc/host/tmio_mmc_dma.c b/drivers/mmc/host/tmio_mmc_dma.c</span>
<span class="p_header">index be9c8d7..08a1ad0 100644</span>
<span class="p_header">--- a/drivers/mmc/host/tmio_mmc_dma.c</span>
<span class="p_header">+++ b/drivers/mmc/host/tmio_mmc_dma.c</span>
<span class="p_chunk">@@ -315,7 +315,7 @@</span> <span class="p_context"> void tmio_mmc_request_dma(struct tmio_mmc_host *host, struct tmio_mmc_data *pdat</span>
 		if (ret &lt; 0)
 			goto ecfgrx;
 
<span class="p_del">-		host-&gt;bounce_buf = (u8 *)__get_free_page(GFP_KERNEL | GFP_DMA);</span>
<span class="p_add">+		host-&gt;bounce_buf = get_free_page(GFP_KERNEL | GFP_DMA);</span>
 		if (!host-&gt;bounce_buf)
 			goto ebouncebuf;
 
<span class="p_header">diff --git a/drivers/net/ethernet/broadcom/bnx2x/bnx2x_cmn.c b/drivers/net/ethernet/broadcom/bnx2x/bnx2x_cmn.c</span>
<span class="p_header">index f8d7a2f..37d9b36 100644</span>
<span class="p_header">--- a/drivers/net/ethernet/broadcom/bnx2x/bnx2x_cmn.c</span>
<span class="p_header">+++ b/drivers/net/ethernet/broadcom/bnx2x/bnx2x_cmn.c</span>
<span class="p_chunk">@@ -692,7 +692,7 @@</span> <span class="p_context"> static void *bnx2x_frag_alloc(const struct bnx2x_fastpath *fp, gfp_t gfp_mask)</span>
 	if (fp-&gt;rx_frag_size) {
 		/* GFP_KERNEL allocations are used only during initialization */
 		if (unlikely(gfpflags_allow_blocking(gfp_mask)))
<span class="p_del">-			return (void *)__get_free_page(gfp_mask);</span>
<span class="p_add">+			return get_free_page(gfp_mask);</span>
 
 		return netdev_alloc_frag(fp-&gt;rx_frag_size);
 	}
<span class="p_header">diff --git a/drivers/net/ethernet/sfc/mcdi.c b/drivers/net/ethernet/sfc/mcdi.c</span>
<span class="p_header">index 36c786b..972b9a7 100644</span>
<span class="p_header">--- a/drivers/net/ethernet/sfc/mcdi.c</span>
<span class="p_header">+++ b/drivers/net/ethernet/sfc/mcdi.c</span>
<span class="p_chunk">@@ -76,7 +76,7 @@</span> <span class="p_context"> int efx_mcdi_init(struct efx_nic *efx)</span>
 	mcdi-&gt;efx = efx;
 #ifdef CONFIG_SFC_MCDI_LOGGING
 	/* consuming code assumes buffer is page-sized */
<span class="p_del">-	mcdi-&gt;logging_buffer = (char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	mcdi-&gt;logging_buffer = get_free_page(GFP_KERNEL);</span>
 	if (!mcdi-&gt;logging_buffer)
 		goto fail1;
 	mcdi-&gt;logging_enabled = mcdi_logging_default;
<span class="p_header">diff --git a/drivers/net/ethernet/toshiba/ps3_gelic_wireless.c b/drivers/net/ethernet/toshiba/ps3_gelic_wireless.c</span>
<span class="p_header">index c1b3142..9ece945 100644</span>
<span class="p_header">--- a/drivers/net/ethernet/toshiba/ps3_gelic_wireless.c</span>
<span class="p_header">+++ b/drivers/net/ethernet/toshiba/ps3_gelic_wireless.c</span>
<span class="p_chunk">@@ -1412,7 +1412,7 @@</span> <span class="p_context"> static struct iw_statistics *gelic_wl_get_wireless_stats(</span>
 
 	pr_debug(&quot;%s: &lt;-\n&quot;, __func__);
 
<span class="p_del">-	buf = (void *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	buf = get_free_page(GFP_KERNEL);</span>
 	if (!buf)
 		return NULL;
 
<span class="p_chunk">@@ -1472,7 +1472,7 @@</span> <span class="p_context"> static int gelic_wl_start_scan(struct gelic_wl_info *wl, int always_scan,</span>
 
 	/* ESSID scan ? */
 	if (essid_len &amp;&amp; essid) {
<span class="p_del">-		buf = (void *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+		buf = get_free_page(GFP_KERNEL);</span>
 		if (!buf) {
 			ret = -ENOMEM;
 			goto out;
<span class="p_chunk">@@ -1523,7 +1523,7 @@</span> <span class="p_context"> static void gelic_wl_scan_complete_event(struct gelic_wl_info *wl)</span>
 	pr_debug(&quot;%s:start\n&quot;, __func__);
 	mutex_lock(&amp;wl-&gt;scan_lock);
 
<span class="p_del">-	buf = (void *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	buf = get_free_page(GFP_KERNEL);</span>
 	if (!buf) {
 		pr_info(&quot;%s: scan buffer alloc failed\n&quot;, __func__);
 		goto out;
<span class="p_chunk">@@ -1764,7 +1764,7 @@</span> <span class="p_context"> static int gelic_wl_do_wep_setup(struct gelic_wl_info *wl)</span>
 
 	pr_debug(&quot;%s: &lt;-\n&quot;, __func__);
 	/* we can assume no one should uses the buffer */
<span class="p_del">-	wep = (struct gelic_eurus_wep_cfg *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	wep = get_free_page(GFP_KERNEL);</span>
 	if (!wep)
 		return -ENOMEM;
 
<span class="p_chunk">@@ -1854,7 +1854,7 @@</span> <span class="p_context"> static int gelic_wl_do_wpa_setup(struct gelic_wl_info *wl)</span>
 
 	pr_debug(&quot;%s: &lt;-\n&quot;, __func__);
 	/* we can assume no one should uses the buffer */
<span class="p_del">-	wpa = (struct gelic_eurus_wpa_cfg *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	wpa = get_free_page(GFP_KERNEL);</span>
 	if (!wpa)
 		return -ENOMEM;
 
<span class="p_chunk">@@ -1935,7 +1935,7 @@</span> <span class="p_context"> static int gelic_wl_associate_bss(struct gelic_wl_info *wl,</span>
 	pr_debug(&quot;%s: &lt;-\n&quot;, __func__);
 
 	/* do common config */
<span class="p_del">-	common = (struct gelic_eurus_common_cfg *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	common = get_free_page(GFP_KERNEL);</span>
 	if (!common)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/drivers/net/usb/kaweth.c b/drivers/net/usb/kaweth.c</span>
<span class="p_header">index a8493be..ae21f17 100644</span>
<span class="p_header">--- a/drivers/net/usb/kaweth.c</span>
<span class="p_header">+++ b/drivers/net/usb/kaweth.c</span>
<span class="p_chunk">@@ -1047,7 +1047,7 @@</span> <span class="p_context"> static int kaweth_probe(</span>
 	} else {
 		/* Download the firmware */
 		dev_info(dev, &quot;Downloading firmware...\n&quot;);
<span class="p_del">-		kaweth-&gt;firmware_buf = (__u8 *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+		kaweth-&gt;firmware_buf = get_free_page(GFP_KERNEL);</span>
 		if ((result = kaweth_download_firmware(kaweth,
 						      &quot;kaweth/new_code.bin&quot;,
 						      100,
<span class="p_header">diff --git a/drivers/pci/xen-pcifront.c b/drivers/pci/xen-pcifront.c</span>
<span class="p_header">index 90b77b9..5e41853 100644</span>
<span class="p_header">--- a/drivers/pci/xen-pcifront.c</span>
<span class="p_header">+++ b/drivers/pci/xen-pcifront.c</span>
<span class="p_chunk">@@ -725,8 +725,7 @@</span> <span class="p_context"> static struct pcifront_device *alloc_pdev(struct xenbus_device *xdev)</span>
 	if (pdev == NULL)
 		goto out;
 
<span class="p_del">-	pdev-&gt;sh_info =</span>
<span class="p_del">-	    (struct xen_pci_sharedinfo *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	pdev-&gt;sh_info = get_free_page(GFP_KERNEL);</span>
 	if (pdev-&gt;sh_info == NULL) {
 		kfree(pdev);
 		pdev = NULL;
<span class="p_header">diff --git a/drivers/platform/x86/dell-laptop.c b/drivers/platform/x86/dell-laptop.c</span>
<span class="p_header">index 996839f..43a750a 100644</span>
<span class="p_header">--- a/drivers/platform/x86/dell-laptop.c</span>
<span class="p_header">+++ b/drivers/platform/x86/dell-laptop.c</span>
<span class="p_chunk">@@ -2145,7 +2145,7 @@</span> <span class="p_context"> static int __init dell_init(void)</span>
 	 * Allocate buffer below 4GB for SMI data--only 32-bit physical addr
 	 * is passed to SMI handler.
 	 */
<span class="p_del">-	buffer = (void *)__get_free_page(GFP_KERNEL | GFP_DMA32);</span>
<span class="p_add">+	buffer = get_free_page(GFP_KERNEL | GFP_DMA32);</span>
 	if (!buffer) {
 		ret = -ENOMEM;
 		goto fail_buffer;
<span class="p_header">diff --git a/drivers/s390/block/dasd_eckd.c b/drivers/s390/block/dasd_eckd.c</span>
<span class="p_header">index c2d120a..10a2d5c 100644</span>
<span class="p_header">--- a/drivers/s390/block/dasd_eckd.c</span>
<span class="p_header">+++ b/drivers/s390/block/dasd_eckd.c</span>
<span class="p_chunk">@@ -5118,7 +5118,7 @@</span> <span class="p_context"> dasd_eckd_init(void)</span>
 		kfree(dasd_reserve_req);
 		return -ENOMEM;
 	}
<span class="p_del">-	rawpadpage = (void *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	rawpadpage = get_free_page(GFP_KERNEL);</span>
 	if (!rawpadpage) {
 		kfree(path_verification_worker);
 		kfree(dasd_reserve_req);
<span class="p_header">diff --git a/drivers/s390/block/xpram.c b/drivers/s390/block/xpram.c</span>
<span class="p_header">index 87d13a6..a4e3f391 100644</span>
<span class="p_header">--- a/drivers/s390/block/xpram.c</span>
<span class="p_header">+++ b/drivers/s390/block/xpram.c</span>
<span class="p_chunk">@@ -145,7 +145,7 @@</span> <span class="p_context"> static int xpram_present(void)</span>
 	void *mem_page;
 	int rc;
 
<span class="p_del">-	mem_page = (void *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	mem_page = get_free_page(GFP_KERNEL);</span>
 	if (!mem_page)
 		return -ENOMEM;
 	rc = xpram_page_in(mem_page, 0);
<span class="p_chunk">@@ -161,7 +161,7 @@</span> <span class="p_context"> static unsigned long xpram_highest_page_index(void)</span>
 	unsigned int page_index, add_bit;
 	void *mem_page;
 
<span class="p_del">-	mem_page = (void *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	mem_page = get_free_page(GFP_KERNEL);</span>
 	if (!mem_page)
 		return 0;
 
<span class="p_header">diff --git a/drivers/s390/char/sclp_cmd.c b/drivers/s390/char/sclp_cmd.c</span>
<span class="p_header">index 09b6c07..6bd6fd0 100644</span>
<span class="p_header">--- a/drivers/s390/char/sclp_cmd.c</span>
<span class="p_header">+++ b/drivers/s390/char/sclp_cmd.c</span>
<span class="p_chunk">@@ -514,7 +514,7 @@</span> <span class="p_context"> static int __init sclp_detect_standby_memory(void)</span>
 	if ((sclp.facilities &amp; 0xe00000000000ULL) != 0xe00000000000ULL)
 		return 0;
 	rc = -ENOMEM;
<span class="p_del">-	sccb = (void *) __get_free_page(GFP_KERNEL | GFP_DMA);</span>
<span class="p_add">+	sccb = get_free_page(GFP_KERNEL | GFP_DMA);</span>
 	if (!sccb)
 		goto out;
 	assigned = 0;
<span class="p_header">diff --git a/drivers/s390/char/vmur.c b/drivers/s390/char/vmur.c</span>
<span class="p_header">index 3974f34..02634f4c 100644</span>
<span class="p_header">--- a/drivers/s390/char/vmur.c</span>
<span class="p_header">+++ b/drivers/s390/char/vmur.c</span>
<span class="p_chunk">@@ -524,7 +524,7 @@</span> <span class="p_context"> static ssize_t diag14_read(struct file *file, char __user *ubuf, size_t count,</span>
 		return rc;
 
 	len = min((size_t) PAGE_SIZE, count);
<span class="p_del">-	buf = (char *) __get_free_page(GFP_KERNEL | GFP_DMA);</span>
<span class="p_add">+	buf = get_free_page(GFP_KERNEL | GFP_DMA);</span>
 	if (!buf)
 		return -ENOMEM;
 
<span class="p_chunk">@@ -616,7 +616,7 @@</span> <span class="p_context"> static int verify_uri_device(struct urdev *urd)</span>
 	}
 
 	/* open file on virtual reader	*/
<span class="p_del">-	buf = (char *) __get_free_page(GFP_KERNEL | GFP_DMA);</span>
<span class="p_add">+	buf = get_free_page(GFP_KERNEL | GFP_DMA);</span>
 	if (!buf) {
 		rc = -ENOMEM;
 		goto fail_free_fcb;
<span class="p_header">diff --git a/drivers/s390/char/zcore.c b/drivers/s390/char/zcore.c</span>
<span class="p_header">index 4a6f730..fe18b41 100644</span>
<span class="p_header">--- a/drivers/s390/char/zcore.c</span>
<span class="p_header">+++ b/drivers/s390/char/zcore.c</span>
<span class="p_chunk">@@ -616,7 +616,7 @@</span> <span class="p_context"> static int __init zcore_reipl_init(void)</span>
 		return rc;
 	if (ipib_info.ipib == 0)
 		return 0;
<span class="p_del">-	ipl_block = (void *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	ipl_block = get_free_page(GFP_KERNEL);</span>
 	if (!ipl_block)
 		return -ENOMEM;
 	if (ipib_info.ipib &lt; sclp.hsa_size)
<span class="p_header">diff --git a/drivers/s390/cio/qdio_setup.c b/drivers/s390/cio/qdio_setup.c</span>
<span class="p_header">index 7322dd3..d842c56 100644</span>
<span class="p_header">--- a/drivers/s390/cio/qdio_setup.c</span>
<span class="p_header">+++ b/drivers/s390/cio/qdio_setup.c</span>
<span class="p_chunk">@@ -144,7 +144,7 @@</span> <span class="p_context"> static int __qdio_allocate_qs(struct qdio_q **irq_ptr_qs, int nr_queues)</span>
 		if (!q)
 			return -ENOMEM;
 
<span class="p_del">-		q-&gt;slib = (struct slib *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+		q-&gt;slib = get_free_page(GFP_KERNEL);</span>
 		if (!q-&gt;slib) {
 			kmem_cache_free(qdio_q_cache, q);
 			return -ENOMEM;
<span class="p_chunk">@@ -305,7 +305,7 @@</span> <span class="p_context"> int qdio_setup_get_ssqd(struct qdio_irq *irq_ptr,</span>
 
 	DBF_EVENT(&quot;getssqd:%4x&quot;, schid-&gt;sch_no);
 	if (!irq_ptr) {
<span class="p_del">-		ssqd = (struct chsc_ssqd_area *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+		ssqd = get_free_page(GFP_KERNEL);</span>
 		if (!ssqd)
 			return -ENOMEM;
 	} else {
<span class="p_header">diff --git a/drivers/s390/cio/scm.c b/drivers/s390/cio/scm.c</span>
<span class="p_header">index db1812e..90dbe36 100644</span>
<span class="p_header">--- a/drivers/s390/cio/scm.c</span>
<span class="p_header">+++ b/drivers/s390/cio/scm.c</span>
<span class="p_chunk">@@ -226,7 +226,7 @@</span> <span class="p_context"> int scm_update_information(void)</span>
 	size_t num;
 	int ret;
 
<span class="p_del">-	scm_info = (void *)__get_free_page(GFP_KERNEL | GFP_DMA);</span>
<span class="p_add">+	scm_info = get_free_page(GFP_KERNEL | GFP_DMA);</span>
 	if (!scm_info)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/drivers/s390/net/qeth_core_main.c b/drivers/s390/net/qeth_core_main.c</span>
<span class="p_header">index 18f4db4..f6de41b 100644</span>
<span class="p_header">--- a/drivers/s390/net/qeth_core_main.c</span>
<span class="p_header">+++ b/drivers/s390/net/qeth_core_main.c</span>
<span class="p_chunk">@@ -265,7 +265,7 @@</span> <span class="p_context"> static int qeth_alloc_buffer_pool(struct qeth_card *card)</span>
 			return -ENOMEM;
 		}
 		for (j = 0; j &lt; QETH_MAX_BUFFER_ELEMENTS(card); ++j) {
<span class="p_del">-			ptr = (void *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+			ptr = get_free_page(GFP_KERNEL);</span>
 			if (!ptr) {
 				while (j &gt; 0)
 					free_page(pool_entry-&gt;elements[--j]);
<span class="p_header">diff --git a/drivers/scsi/cxlflash/main.c b/drivers/scsi/cxlflash/main.c</span>
<span class="p_header">index ff85994..cd29652 100644</span>
<span class="p_header">--- a/drivers/scsi/cxlflash/main.c</span>
<span class="p_header">+++ b/drivers/scsi/cxlflash/main.c</span>
<span class="p_chunk">@@ -776,7 +776,7 @@</span> <span class="p_context"> static int alloc_mem(struct cxlflash_cfg *cfg)</span>
 
 	for (i = 0; i &lt; CXLFLASH_NUM_CMDS; buf += CMD_BUFSIZE, i++) {
 		if (!((u64)buf &amp; (PAGE_SIZE - 1))) {
<span class="p_del">-			buf = (void *)__get_free_page(GFP_KERNEL | __GFP_ZERO);</span>
<span class="p_add">+			buf = get_free_page(GFP_KERNEL | __GFP_ZERO);</span>
 			if (unlikely(!buf)) {
 				dev_err(dev,
 					&quot;%s: Allocate command buffers fail!\n&quot;,
<span class="p_header">diff --git a/drivers/scsi/ipr.c b/drivers/scsi/ipr.c</span>
<span class="p_header">index 1a05ba8..b80245b 100644</span>
<span class="p_header">--- a/drivers/scsi/ipr.c</span>
<span class="p_header">+++ b/drivers/scsi/ipr.c</span>
<span class="p_chunk">@@ -2904,7 +2904,7 @@</span> <span class="p_context"> static int ipr_sdt_copy(struct ipr_ioa_cfg *ioa_cfg,</span>
 	       (ioa_dump-&gt;hdr.len + bytes_copied) &lt; max_dump_size) {
 		if (ioa_dump-&gt;page_offset &gt;= PAGE_SIZE ||
 		    ioa_dump-&gt;page_offset == 0) {
<span class="p_del">-			page = (__be32 *)__get_free_page(GFP_ATOMIC);</span>
<span class="p_add">+			page = get_free_page(GFP_ATOMIC);</span>
 
 			if (!page) {
 				ipr_trace;
<span class="p_header">diff --git a/drivers/scsi/scsi_devinfo.c b/drivers/scsi/scsi_devinfo.c</span>
<span class="p_header">index 2f93f80..1893e6c 100644</span>
<span class="p_header">--- a/drivers/scsi/scsi_devinfo.c</span>
<span class="p_header">+++ b/drivers/scsi/scsi_devinfo.c</span>
<span class="p_chunk">@@ -707,7 +707,7 @@</span> <span class="p_context"> static ssize_t proc_scsi_devinfo_write(struct file *file,</span>
 
 	if (!buf || length&gt;PAGE_SIZE)
 		return -EINVAL;
<span class="p_del">-	if (!(buffer = (char *) __get_free_page(GFP_KERNEL)))</span>
<span class="p_add">+	if (!(buffer = get_free_page(GFP_KERNEL)))</span>
 		return -ENOMEM;
 	if (copy_from_user(buffer, buf, length)) {
 		err =-EFAULT;
<span class="p_header">diff --git a/drivers/scsi/scsi_proc.c b/drivers/scsi/scsi_proc.c</span>
<span class="p_header">index e0e0e5d..71bee2d 100644</span>
<span class="p_header">--- a/drivers/scsi/scsi_proc.c</span>
<span class="p_header">+++ b/drivers/scsi/scsi_proc.c</span>
<span class="p_chunk">@@ -58,7 +58,7 @@</span> <span class="p_context"> static ssize_t proc_scsi_host_write(struct file *file, const char __user *buf,</span>
 	if (!shost-&gt;hostt-&gt;write_info)
 		return -EINVAL;
 
<span class="p_del">-	page = (char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	page = get_free_page(GFP_KERNEL);</span>
 	if (page) {
 		ret = -EFAULT;
 		if (copy_from_user(page, buf, count))
<span class="p_chunk">@@ -315,7 +315,7 @@</span> <span class="p_context"> static ssize_t proc_scsi_write(struct file *file, const char __user *buf,</span>
 	if (!buf || length &gt; PAGE_SIZE)
 		return -EINVAL;
 
<span class="p_del">-	buffer = (char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	buffer = get_free_page(GFP_KERNEL);</span>
 	if (!buffer)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/drivers/scsi/xen-scsifront.c b/drivers/scsi/xen-scsifront.c</span>
<span class="p_header">index 825759b..93dc086 100644</span>
<span class="p_header">--- a/drivers/scsi/xen-scsifront.c</span>
<span class="p_header">+++ b/drivers/scsi/xen-scsifront.c</span>
<span class="p_chunk">@@ -718,7 +718,7 @@</span> <span class="p_context"> static int scsifront_alloc_ring(struct vscsifrnt_info *info)</span>
 	int err = -ENOMEM;
 
 	/***** Frontend to Backend ring start *****/
<span class="p_del">-	sring = (struct vscsiif_sring *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	sring = get_free_page(GFP_KERNEL);</span>
 	if (!sring) {
 		xenbus_dev_fatal(dev, err,
 			&quot;fail to allocate shared ring (Front to Back)&quot;);
<span class="p_header">diff --git a/drivers/spi/spi-sh-msiof.c b/drivers/spi/spi-sh-msiof.c</span>
<span class="p_header">index b8286e7..eea6e9b 100644</span>
<span class="p_header">--- a/drivers/spi/spi-sh-msiof.c</span>
<span class="p_header">+++ b/drivers/spi/spi-sh-msiof.c</span>
<span class="p_chunk">@@ -1092,11 +1092,11 @@</span> <span class="p_context"> static int sh_msiof_request_dma(struct sh_msiof_spi_priv *p)</span>
 	if (!master-&gt;dma_rx)
 		goto free_tx_chan;
 
<span class="p_del">-	p-&gt;tx_dma_page = (void *)__get_free_page(GFP_KERNEL | GFP_DMA);</span>
<span class="p_add">+	p-&gt;tx_dma_page = get_free_page(GFP_KERNEL | GFP_DMA);</span>
 	if (!p-&gt;tx_dma_page)
 		goto free_rx_chan;
 
<span class="p_del">-	p-&gt;rx_dma_page = (void *)__get_free_page(GFP_KERNEL | GFP_DMA);</span>
<span class="p_add">+	p-&gt;rx_dma_page = get_free_page(GFP_KERNEL | GFP_DMA);</span>
 	if (!p-&gt;rx_dma_page)
 		goto free_tx_page;
 
<span class="p_header">diff --git a/drivers/staging/lustre/lustre/llite/llite_lib.c b/drivers/staging/lustre/lustre/llite/llite_lib.c</span>
<span class="p_header">index 92259be..f675ab3 100644</span>
<span class="p_header">--- a/drivers/staging/lustre/lustre/llite/llite_lib.c</span>
<span class="p_header">+++ b/drivers/staging/lustre/lustre/llite/llite_lib.c</span>
<span class="p_chunk">@@ -2268,7 +2268,7 @@</span> <span class="p_context"> void ll_dirty_page_discard_warn(struct page *page, int ioret)</span>
 	struct ccc_object *obj = cl_inode2ccc(page-&gt;mapping-&gt;host);
 
 	/* this can be called inside spin lock so use GFP_ATOMIC. */
<span class="p_del">-	buf = (char *)__get_free_page(GFP_ATOMIC);</span>
<span class="p_add">+	buf = get_free_page(GFP_ATOMIC);</span>
 	if (buf != NULL) {
 		dentry = d_find_alias(page-&gt;mapping-&gt;host);
 		if (dentry != NULL)
<span class="p_header">diff --git a/drivers/staging/unisys/visorbus/visorchannel.c b/drivers/staging/unisys/visorbus/visorchannel.c</span>
<span class="p_header">index 486bef0..35471c4 100644</span>
<span class="p_header">--- a/drivers/staging/unisys/visorbus/visorchannel.c</span>
<span class="p_header">+++ b/drivers/staging/unisys/visorbus/visorchannel.c</span>
<span class="p_chunk">@@ -279,7 +279,7 @@</span> <span class="p_context"> visorchannel_clear(struct visorchannel *channel, ulong offset, u8 ch,</span>
 	int written = 0;
 	u8 *buf;
 
<span class="p_del">-	buf = (u8 *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	buf = get_free_page(GFP_KERNEL);</span>
 	if (!buf)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/drivers/target/target_core_file.c b/drivers/target/target_core_file.c</span>
<span class="p_header">index ca682ec..86ad9ea 100644</span>
<span class="p_header">--- a/drivers/target/target_core_file.c</span>
<span class="p_header">+++ b/drivers/target/target_core_file.c</span>
<span class="p_chunk">@@ -460,7 +460,7 @@</span> <span class="p_context"> fd_do_prot_unmap(struct se_cmd *cmd, sector_t lba, sector_t nolb)</span>
 	void *buf;
 	int rc;
 
<span class="p_del">-	buf = (void *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	buf = get_free_page(GFP_KERNEL);</span>
 	if (!buf) {
 		pr_err(&quot;Unable to allocate FILEIO prot buf\n&quot;);
 		return -ENOMEM;
<span class="p_header">diff --git a/drivers/tty/hvc/hvc_xen.c b/drivers/tty/hvc/hvc_xen.c</span>
<span class="p_header">index 4f7716d..423d2cf 100644</span>
<span class="p_header">--- a/drivers/tty/hvc/hvc_xen.c</span>
<span class="p_header">+++ b/drivers/tty/hvc/hvc_xen.c</span>
<span class="p_chunk">@@ -445,7 +445,7 @@</span> <span class="p_context"> static int xencons_probe(struct xenbus_device *dev,</span>
 	dev_set_drvdata(&amp;dev-&gt;dev, info);
 	info-&gt;xbdev = dev;
 	info-&gt;vtermno = xenbus_devid_to_vtermno(devid);
<span class="p_del">-	info-&gt;intf = (void *)__get_free_page(GFP_KERNEL | __GFP_ZERO);</span>
<span class="p_add">+	info-&gt;intf = get_free_page(GFP_KERNEL | __GFP_ZERO);</span>
 	if (!info-&gt;intf)
 		goto error_nomem;
 
<span class="p_header">diff --git a/drivers/tty/hvc/hvcs.c b/drivers/tty/hvc/hvcs.c</span>
<span class="p_header">index fb3f4cd..29320d0 100644</span>
<span class="p_header">--- a/drivers/tty/hvc/hvcs.c</span>
<span class="p_header">+++ b/drivers/tty/hvc/hvcs.c</span>
<span class="p_chunk">@@ -1532,7 +1532,7 @@</span> <span class="p_context"> static int hvcs_initialize(void)</span>
 		goto register_fail;
 	}
 
<span class="p_del">-	hvcs_pi_buff = (unsigned long *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	hvcs_pi_buff = get_free_page(GFP_KERNEL);</span>
 	if (!hvcs_pi_buff) {
 		rc = -ENOMEM;
 		goto buff_alloc_fail;
<span class="p_header">diff --git a/drivers/tty/mxser.c b/drivers/tty/mxser.c</span>
<span class="p_header">index ee78fc2..56bd374 100644</span>
<span class="p_header">--- a/drivers/tty/mxser.c</span>
<span class="p_header">+++ b/drivers/tty/mxser.c</span>
<span class="p_chunk">@@ -865,7 +865,7 @@</span> <span class="p_context"> static int mxser_activate(struct tty_port *port, struct tty_struct *tty)</span>
 	unsigned char *page;
 	unsigned long flags;
 
<span class="p_del">-	page = (unsigned char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	page = get_free_page(GFP_KERNEL);</span>
 	if (!page)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/drivers/tty/rocket.c b/drivers/tty/rocket.c</span>
<span class="p_header">index 78f0330..fc2d1ef 100644</span>
<span class="p_header">--- a/drivers/tty/rocket.c</span>
<span class="p_header">+++ b/drivers/tty/rocket.c</span>
<span class="p_chunk">@@ -891,7 +891,7 @@</span> <span class="p_context"> static int rp_open(struct tty_struct *tty, struct file *filp)</span>
 		return -ENXIO;
 	port = &amp;info-&gt;port;
 	
<span class="p_del">-	page = (unsigned char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	page = get_free_page(GFP_KERNEL);</span>
 	if (!page)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/drivers/tty/serial/68328serial.c b/drivers/tty/serial/68328serial.c</span>
<span class="p_header">index 4485466..5fac3e7 100644</span>
<span class="p_header">--- a/drivers/tty/serial/68328serial.c</span>
<span class="p_header">+++ b/drivers/tty/serial/68328serial.c</span>
<span class="p_chunk">@@ -379,7 +379,7 @@</span> <span class="p_context"> static int startup(struct m68k_serial *info, struct tty_struct *tty)</span>
 		return 0;
 
 	if (!info-&gt;xmit_buf) {
<span class="p_del">-		info-&gt;xmit_buf = (unsigned char *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+		info-&gt;xmit_buf = get_free_page(GFP_KERNEL);</span>
 		if (!info-&gt;xmit_buf)
 			return -ENOMEM;
 	}
<span class="p_header">diff --git a/drivers/tty/serial/men_z135_uart.c b/drivers/tty/serial/men_z135_uart.c</span>
<span class="p_header">index df3c6ad..534b2ed 100644</span>
<span class="p_header">--- a/drivers/tty/serial/men_z135_uart.c</span>
<span class="p_header">+++ b/drivers/tty/serial/men_z135_uart.c</span>
<span class="p_chunk">@@ -824,7 +824,7 @@</span> <span class="p_context"> static int men_z135_probe(struct mcb_device *mdev,</span>
 	if (!uart)
 		return -ENOMEM;
 
<span class="p_del">-	uart-&gt;rxbuf = (unsigned char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	uart-&gt;rxbuf = get_free_page(GFP_KERNEL);</span>
 	if (!uart-&gt;rxbuf)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/drivers/tty/serial/pch_uart.c b/drivers/tty/serial/pch_uart.c</span>
<span class="p_header">index 7e461e0..daee5b8 100644</span>
<span class="p_header">--- a/drivers/tty/serial/pch_uart.c</span>
<span class="p_header">+++ b/drivers/tty/serial/pch_uart.c</span>
<span class="p_chunk">@@ -1771,7 +1771,7 @@</span> <span class="p_context"> static struct eg20t_port *pch_uart_init_port(struct pci_dev *pdev,</span>
 	if (priv == NULL)
 		goto init_port_alloc_err;
 
<span class="p_del">-	rxbuf = (unsigned char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	rxbuf = get_free_page(GFP_KERNEL);</span>
 	if (!rxbuf)
 		goto init_port_free_txbuf;
 
<span class="p_header">diff --git a/drivers/tty/vt/vc_screen.c b/drivers/tty/vt/vc_screen.c</span>
<span class="p_header">index 5d25934..7227efe 100644</span>
<span class="p_header">--- a/drivers/tty/vt/vc_screen.c</span>
<span class="p_header">+++ b/drivers/tty/vt/vc_screen.c</span>
<span class="p_chunk">@@ -206,7 +206,7 @@</span> <span class="p_context"> vcs_read(struct file *file, char __user *buf, size_t count, loff_t *ppos)</span>
 	ssize_t ret;
 	char *con_buf;
 
<span class="p_del">-	con_buf = (char *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	con_buf = get_free_page(GFP_KERNEL);</span>
 	if (!con_buf)
 		return -ENOMEM;
 
<span class="p_chunk">@@ -384,7 +384,7 @@</span> <span class="p_context"> vcs_write(struct file *file, const char __user *buf, size_t count, loff_t *ppos)</span>
 	size_t ret;
 	char *con_buf;
 
<span class="p_del">-	con_buf = (char *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	con_buf = get_free_page(GFP_KERNEL);</span>
 	if (!con_buf)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/drivers/usb/atm/cxacru.c b/drivers/usb/atm/cxacru.c</span>
<span class="p_header">index f03bc30..e078eeb 100644</span>
<span class="p_header">--- a/drivers/usb/atm/cxacru.c</span>
<span class="p_header">+++ b/drivers/usb/atm/cxacru.c</span>
<span class="p_chunk">@@ -942,7 +942,7 @@</span> <span class="p_context"> static int cxacru_fw(struct usb_device *usb_dev, enum cxacru_fw_request fw,</span>
 	int offd, offb;
 	const int stride = CMD_PACKET_SIZE - 8;
 
<span class="p_del">-	buf = (u8 *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	buf = get_free_page(GFP_KERNEL);</span>
 	if (!buf)
 		return -ENOMEM;
 
<span class="p_chunk">@@ -1152,13 +1152,13 @@</span> <span class="p_context"> static int cxacru_bind(struct usbatm_data *usbatm_instance,</span>
 
 	mutex_init(&amp;instance-&gt;adsl_state_serialize);
 
<span class="p_del">-	instance-&gt;rcv_buf = (u8 *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	instance-&gt;rcv_buf = get_free_page(GFP_KERNEL);</span>
 	if (!instance-&gt;rcv_buf) {
 		usb_dbg(usbatm_instance, &quot;cxacru_bind: no memory for rcv_buf\n&quot;);
 		ret = -ENOMEM;
 		goto fail;
 	}
<span class="p_del">-	instance-&gt;snd_buf = (u8 *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	instance-&gt;snd_buf = get_free_page(GFP_KERNEL);</span>
 	if (!instance-&gt;snd_buf) {
 		usb_dbg(usbatm_instance, &quot;cxacru_bind: no memory for snd_buf\n&quot;);
 		ret = -ENOMEM;
<span class="p_header">diff --git a/drivers/usb/atm/speedtch.c b/drivers/usb/atm/speedtch.c</span>
<span class="p_header">index 681599f..e6a1ff8 100644</span>
<span class="p_header">--- a/drivers/usb/atm/speedtch.c</span>
<span class="p_header">+++ b/drivers/usb/atm/speedtch.c</span>
<span class="p_chunk">@@ -255,7 +255,7 @@</span> <span class="p_context"> static int speedtch_upload_firmware(struct speedtch_instance_data *instance,</span>
 
 	usb_dbg(usbatm, &quot;%s entered\n&quot;, __func__);
 
<span class="p_del">-	buffer = (unsigned char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	buffer = get_free_page(GFP_KERNEL);</span>
 	if (!buffer) {
 		ret = -ENOMEM;
 		usb_dbg(usbatm, &quot;%s: no memory for buffer!\n&quot;, __func__);
<span class="p_header">diff --git a/drivers/usb/core/devio.c b/drivers/usb/core/devio.c</span>
<span class="p_header">index c2cef46..af957f0 100644</span>
<span class="p_header">--- a/drivers/usb/core/devio.c</span>
<span class="p_header">+++ b/drivers/usb/core/devio.c</span>
<span class="p_chunk">@@ -988,7 +988,7 @@</span> <span class="p_context"> static int proc_control(struct usb_dev_state *ps, void __user *arg)</span>
 			sizeof(struct usb_ctrlrequest));
 	if (ret)
 		return ret;
<span class="p_del">-	tbuf = (unsigned char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	tbuf = get_free_page(GFP_KERNEL);</span>
 	if (!tbuf) {
 		ret = -ENOMEM;
 		goto done;
<span class="p_header">diff --git a/drivers/usb/misc/rio500.c b/drivers/usb/misc/rio500.c</span>
<span class="p_header">index 3c49061..f50166565 100644</span>
<span class="p_header">--- a/drivers/usb/misc/rio500.c</span>
<span class="p_header">+++ b/drivers/usb/misc/rio500.c</span>
<span class="p_chunk">@@ -139,7 +139,7 @@</span> <span class="p_context"> static long ioctl_rio(struct file *file, unsigned int cmd, unsigned long arg)</span>
 			retval = -EINVAL;
 			goto err_out;
 		}
<span class="p_del">-		buffer = (unsigned char *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+		buffer = get_free_page(GFP_KERNEL);</span>
 		if (buffer == NULL) {
 			retval = -ENOMEM;
 			goto err_out;
<span class="p_chunk">@@ -210,7 +210,7 @@</span> <span class="p_context"> static long ioctl_rio(struct file *file, unsigned int cmd, unsigned long arg)</span>
 			retval = -EINVAL;
 			goto err_out;
 		}
<span class="p_del">-		buffer = (unsigned char *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+		buffer = get_free_page(GFP_KERNEL);</span>
 		if (buffer == NULL) {
 			retval = -ENOMEM;
 			goto err_out;
<span class="p_header">diff --git a/drivers/usb/serial/usb_wwan.c b/drivers/usb/serial/usb_wwan.c</span>
<span class="p_header">index de9ff1b..fbebc5d 100644</span>
<span class="p_header">--- a/drivers/usb/serial/usb_wwan.c</span>
<span class="p_header">+++ b/drivers/usb/serial/usb_wwan.c</span>
<span class="p_chunk">@@ -525,7 +525,7 @@</span> <span class="p_context"> int usb_wwan_port_probe(struct usb_serial_port *port)</span>
 	init_usb_anchor(&amp;portdata-&gt;delayed);
 
 	for (i = 0; i &lt; N_IN_URB; i++) {
<span class="p_del">-		buffer = (u8 *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+		buffer = get_free_page(GFP_KERNEL);</span>
 		if (!buffer)
 			goto bail_out_error;
 		portdata-&gt;in_buffer[i] = buffer;
<span class="p_header">diff --git a/drivers/uwb/hwa-rc.c b/drivers/uwb/hwa-rc.c</span>
<span class="p_header">index 2d3334f..b92ef24 100644</span>
<span class="p_header">--- a/drivers/uwb/hwa-rc.c</span>
<span class="p_header">+++ b/drivers/uwb/hwa-rc.c</span>
<span class="p_chunk">@@ -695,7 +695,7 @@</span> <span class="p_context"> static int hwarc_neep_init(struct uwb_rc *rc)</span>
 	struct usb_endpoint_descriptor *epd;
 
 	epd = &amp;iface-&gt;cur_altsetting-&gt;endpoint[0].desc;
<span class="p_del">-	hwarc-&gt;rd_buffer = (void *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	hwarc-&gt;rd_buffer = get_free_page(GFP_KERNEL);</span>
 	if (hwarc-&gt;rd_buffer == NULL) {
 		dev_err(dev, &quot;Unable to allocate notification&#39;s read buffer\n&quot;);
 		goto error_rd_buffer;
<span class="p_header">diff --git a/drivers/video/fbdev/xen-fbfront.c b/drivers/video/fbdev/xen-fbfront.c</span>
<span class="p_header">index b126f77..11ecb95 100644</span>
<span class="p_header">--- a/drivers/video/fbdev/xen-fbfront.c</span>
<span class="p_header">+++ b/drivers/video/fbdev/xen-fbfront.c</span>
<span class="p_chunk">@@ -407,7 +407,7 @@</span> <span class="p_context"> static int xenfb_probe(struct xenbus_device *dev,</span>
 		goto error_nomem;
 
 	/* set up shared page */
<span class="p_del">-	info-&gt;page = (void *)__get_free_page(GFP_KERNEL | __GFP_ZERO);</span>
<span class="p_add">+	info-&gt;page = get_free_page(GFP_KERNEL | __GFP_ZERO);</span>
 	if (!info-&gt;page)
 		goto error_nomem;
 
<span class="p_header">diff --git a/drivers/xen/events/events_base.c b/drivers/xen/events/events_base.c</span>
<span class="p_header">index 0fe5889..b107c3e 100644</span>
<span class="p_header">--- a/drivers/xen/events/events_base.c</span>
<span class="p_header">+++ b/drivers/xen/events/events_base.c</span>
<span class="p_chunk">@@ -1688,7 +1688,7 @@</span> <span class="p_context"> void __init xen_init_IRQ(void)</span>
 		int rc;
 		struct physdev_pirq_eoi_gmfn eoi_gmfn;
 
<span class="p_del">-		pirq_eoi_map = (void *)__get_free_page(GFP_KERNEL|__GFP_ZERO);</span>
<span class="p_add">+		pirq_eoi_map = get_free_page(GFP_KERNEL|__GFP_ZERO);</span>
 		eoi_gmfn.gmfn = virt_to_gfn(pirq_eoi_map);
 		rc = HYPERVISOR_physdev_op(PHYSDEVOP_pirq_eoi_gmfn_v2, &amp;eoi_gmfn);
 		/* TODO: No PVH support for PIRQ EOI */
<span class="p_header">diff --git a/drivers/xen/events/events_fifo.c b/drivers/xen/events/events_fifo.c</span>
<span class="p_header">index 722c2a0..cc3857c 100644</span>
<span class="p_header">--- a/drivers/xen/events/events_fifo.c</span>
<span class="p_header">+++ b/drivers/xen/events/events_fifo.c</span>
<span class="p_chunk">@@ -156,7 +156,7 @@</span> <span class="p_context"> static int evtchn_fifo_setup(struct irq_info *info)</span>
 		/* Might already have a page if we&#39;ve resumed. */
 		array_page = event_array[event_array_pages];
 		if (!array_page) {
<span class="p_del">-			array_page = (void *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+			array_page = get_free_page(GFP_KERNEL);</span>
 			if (array_page == NULL) {
 				ret = -ENOMEM;
 				goto error;
<span class="p_chunk">@@ -391,7 +391,7 @@</span> <span class="p_context"> static int evtchn_fifo_alloc_control_block(unsigned cpu)</span>
 	void *control_block = NULL;
 	int ret = -ENOMEM;
 
<span class="p_del">-	control_block = (void *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	control_block = get_free_page(GFP_KERNEL);</span>
 	if (control_block == NULL)
 		goto error;
 
<span class="p_header">diff --git a/drivers/xen/evtchn.c b/drivers/xen/evtchn.c</span>
<span class="p_header">index bcd5f54..5c044a2 100644</span>
<span class="p_header">--- a/drivers/xen/evtchn.c</span>
<span class="p_header">+++ b/drivers/xen/evtchn.c</span>
<span class="p_chunk">@@ -270,7 +270,7 @@</span> <span class="p_context"> static ssize_t evtchn_write(struct file *file, const char __user *buf,</span>
 			    size_t count, loff_t *ppos)
 {
 	int rc, i;
<span class="p_del">-	evtchn_port_t *kbuf = (evtchn_port_t *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	evtchn_port_t *kbuf = get_free_page(GFP_KERNEL);</span>
 	struct per_user_data *u = file-&gt;private_data;
 
 	if (kbuf == NULL)
<span class="p_header">diff --git a/drivers/xen/grant-table.c b/drivers/xen/grant-table.c</span>
<span class="p_header">index 29d88da..00e7130 100644</span>
<span class="p_header">--- a/drivers/xen/grant-table.c</span>
<span class="p_header">+++ b/drivers/xen/grant-table.c</span>
<span class="p_chunk">@@ -577,7 +577,7 @@</span> <span class="p_context"> static int grow_gnttab_list(unsigned int more_frames)</span>
 	new_nr_glist_frames =
 		(new_nr_grant_frames * grefs_per_grant_frame + RPP - 1) / RPP;
 	for (i = nr_glist_frames; i &lt; new_nr_glist_frames; i++) {
<span class="p_del">-		gnttab_list[i] = (grant_ref_t *)__get_free_page(GFP_ATOMIC);</span>
<span class="p_add">+		gnttab_list[i] = get_free_page(GFP_ATOMIC);</span>
 		if (!gnttab_list[i])
 			goto grow_nomem;
 	}
<span class="p_chunk">@@ -1109,7 +1109,7 @@</span> <span class="p_context"> int gnttab_init(void)</span>
 
 	nr_glist_frames = (nr_grant_frames * grefs_per_grant_frame + RPP - 1) / RPP;
 	for (i = 0; i &lt; nr_glist_frames; i++) {
<span class="p_del">-		gnttab_list[i] = (grant_ref_t *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+		gnttab_list[i] = get_free_page(GFP_KERNEL);</span>
 		if (gnttab_list[i] == NULL) {
 			ret = -ENOMEM;
 			goto ini_nomem;
<span class="p_header">diff --git a/fs/binfmt_misc.c b/fs/binfmt_misc.c</span>
<span class="p_header">index a7ab050..5479f6f 100644</span>
<span class="p_header">--- a/fs/binfmt_misc.c</span>
<span class="p_header">+++ b/fs/binfmt_misc.c</span>
<span class="p_chunk">@@ -607,7 +607,7 @@</span> <span class="p_context"> bm_entry_read(struct file *file, char __user *buf, size_t nbytes, loff_t *ppos)</span>
 	ssize_t res;
 	char *page;
 
<span class="p_del">-	page = (char *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	page = get_free_page(GFP_KERNEL);</span>
 	if (!page)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/fs/fuse/dir.c b/fs/fuse/dir.c</span>
<span class="p_header">index 37b4ae3..c3755f0 100644</span>
<span class="p_header">--- a/fs/fuse/dir.c</span>
<span class="p_header">+++ b/fs/fuse/dir.c</span>
<span class="p_chunk">@@ -1373,7 +1373,7 @@</span> <span class="p_context"> static const char *fuse_follow_link(struct dentry *dentry, void **cookie)</span>
 	char *link;
 	ssize_t ret;
 
<span class="p_del">-	link = (char *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	link = get_free_page(GFP_KERNEL);</span>
 	if (!link)
 		return ERR_PTR(-ENOMEM);
 
<span class="p_header">diff --git a/fs/fuse/file.c b/fs/fuse/file.c</span>
<span class="p_header">index a07709b..2e44926 100644</span>
<span class="p_header">--- a/fs/fuse/file.c</span>
<span class="p_header">+++ b/fs/fuse/file.c</span>
<span class="p_chunk">@@ -2458,7 +2458,7 @@</span> <span class="p_context"> long fuse_do_ioctl(struct file *file, unsigned int cmd, unsigned long arg,</span>
 
 	err = -ENOMEM;
 	pages = kcalloc(FUSE_MAX_PAGES_PER_REQ, sizeof(pages[0]), GFP_KERNEL);
<span class="p_del">-	iov_page = (struct iovec *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	iov_page = get_free_page(GFP_KERNEL);</span>
 	if (!pages || !iov_page)
 		goto out;
 
<span class="p_header">diff --git a/fs/isofs/dir.c b/fs/isofs/dir.c</span>
<span class="p_header">index 2d495b5..63199f6 100644</span>
<span class="p_header">--- a/fs/isofs/dir.c</span>
<span class="p_header">+++ b/fs/isofs/dir.c</span>
<span class="p_chunk">@@ -253,7 +253,7 @@</span> <span class="p_context"> static int isofs_readdir(struct file *file, struct dir_context *ctx)</span>
 	struct iso_directory_record *tmpde;
 	struct inode *inode = file_inode(file);
 
<span class="p_del">-	tmpname = (char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	tmpname = get_free_page(GFP_KERNEL);</span>
 	if (tmpname == NULL)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/fs/jfs/jfs_dtree.c b/fs/jfs/jfs_dtree.c</span>
<span class="p_header">index 56d18de..1007b44 100644</span>
<span class="p_header">--- a/fs/jfs/jfs_dtree.c</span>
<span class="p_header">+++ b/fs/jfs/jfs_dtree.c</span>
<span class="p_chunk">@@ -3180,7 +3180,7 @@</span> <span class="p_context"> int jfs_readdir(struct file *file, struct dir_context *ctx)</span>
 		}
 	}
 
<span class="p_del">-	dirent_buf = (void *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	dirent_buf = get_free_page(GFP_KERNEL);</span>
 	if (!dirent_buf) {
 		DT_PUTPAGE(mp);
 		jfs_warn(&quot;jfs_readdir: __get_free_page failed!&quot;);
<span class="p_header">diff --git a/fs/namespace.c b/fs/namespace.c</span>
<span class="p_header">index 4bcae39..5f1245c 100644</span>
<span class="p_header">--- a/fs/namespace.c</span>
<span class="p_header">+++ b/fs/namespace.c</span>
<span class="p_chunk">@@ -2611,7 +2611,7 @@</span> <span class="p_context"> int copy_mount_options(const void __user * data, void **where)</span>
 	if (!data)
 		return 0;
 
<span class="p_del">-	if (!(page = (char *)__get_free_page(GFP_KERNEL)))</span>
<span class="p_add">+	if (!(page = get_free_page(GFP_KERNEL)))</span>
 		return -ENOMEM;
 
 	/* We only care that *some* data at the address the user
<span class="p_header">diff --git a/fs/nfs/namespace.c b/fs/nfs/namespace.c</span>
<span class="p_header">index faa1ce5..20b38fa 100644</span>
<span class="p_header">--- a/fs/nfs/namespace.c</span>
<span class="p_header">+++ b/fs/nfs/namespace.c</span>
<span class="p_chunk">@@ -248,7 +248,7 @@</span> <span class="p_context"> struct vfsmount *nfs_do_submount(struct dentry *dentry, struct nfs_fh *fh,</span>
 		.authflavor = authflavor,
 	};
 	struct vfsmount *mnt = ERR_PTR(-ENOMEM);
<span class="p_del">-	char *page = (char *) __get_free_page(GFP_USER);</span>
<span class="p_add">+	char *page = get_free_page(GFP_USER);</span>
 	char *devname;
 
 	dprintk(&quot;--&gt; nfs_do_submount()\n&quot;);
<span class="p_header">diff --git a/fs/nfs/nfs4namespace.c b/fs/nfs/nfs4namespace.c</span>
<span class="p_header">index 82b1537..7a6565a 100644</span>
<span class="p_header">--- a/fs/nfs/nfs4namespace.c</span>
<span class="p_header">+++ b/fs/nfs/nfs4namespace.c</span>
<span class="p_chunk">@@ -310,11 +310,11 @@</span> <span class="p_context"> static struct vfsmount *nfs_follow_referral(struct dentry *dentry,</span>
 
 	dprintk(&quot;%s: referral at %pd2\n&quot;, __func__, dentry);
 
<span class="p_del">-	page = (char *) __get_free_page(GFP_USER);</span>
<span class="p_add">+	page = get_free_page(GFP_USER);</span>
 	if (!page)
 		goto out;
 
<span class="p_del">-	page2 = (char *) __get_free_page(GFP_USER);</span>
<span class="p_add">+	page2 = get_free_page(GFP_USER);</span>
 	if (!page2)
 		goto out;
 
<span class="p_chunk">@@ -495,10 +495,10 @@</span> <span class="p_context"> int nfs4_replace_transport(struct nfs_server *server,</span>
 		goto out;
 
 	error = -ENOMEM;
<span class="p_del">-	page = (char *) __get_free_page(GFP_USER);</span>
<span class="p_add">+	page = get_free_page(GFP_USER);</span>
 	if (!page)
 		goto out;
<span class="p_del">-	page2 = (char *) __get_free_page(GFP_USER);</span>
<span class="p_add">+	page2 = get_free_page(GFP_USER);</span>
 	if (!page2)
 		goto out;
 
<span class="p_header">diff --git a/fs/nfs/super.c b/fs/nfs/super.c</span>
<span class="p_header">index ba0ad91..427d0a9 100644</span>
<span class="p_header">--- a/fs/nfs/super.c</span>
<span class="p_header">+++ b/fs/nfs/super.c</span>
<span class="p_chunk">@@ -779,7 +779,7 @@</span> <span class="p_context"> static void show_implementation_id(struct seq_file *m, struct nfs_server *nfss)</span>
 
 int nfs_show_devname(struct seq_file *m, struct dentry *root)
 {
<span class="p_del">-	char *page = (char *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	char *page = get_free_page(GFP_KERNEL);</span>
 	char *devname, *dummy;
 	int err = 0;
 	if (!page)
<span class="p_header">diff --git a/fs/nfsd/vfs.c b/fs/nfsd/vfs.c</span>
<span class="p_header">index e9df47b..8a10704 100644</span>
<span class="p_header">--- a/fs/nfsd/vfs.c</span>
<span class="p_header">+++ b/fs/nfsd/vfs.c</span>
<span class="p_chunk">@@ -1800,7 +1800,7 @@</span> <span class="p_context"> static __be32 nfsd_buffered_readdir(struct file *file, nfsd_filldir_t func,</span>
 	loff_t offset;
 	struct readdir_data buf = {
 		.ctx.actor = nfsd_buffered_filldir,
<span class="p_del">-		.dirent = (void *)__get_free_page(GFP_KERNEL)</span>
<span class="p_add">+		.dirent = get_free_page(GFP_KERNEL)</span>
 	};
 
 	if (!buf.dirent)
<span class="p_header">diff --git a/fs/ocfs2/dlm/dlmdomain.c b/fs/ocfs2/dlm/dlmdomain.c</span>
<span class="p_header">index 841d822..4a80983 100644</span>
<span class="p_header">--- a/fs/ocfs2/dlm/dlmdomain.c</span>
<span class="p_header">+++ b/fs/ocfs2/dlm/dlmdomain.c</span>
<span class="p_chunk">@@ -92,7 +92,7 @@</span> <span class="p_context"> static void **dlm_alloc_pagevec(int pages)</span>
 		return NULL;
 
 	for (i = 0; i &lt; pages; i++)
<span class="p_del">-		if (!(vec[i] = (void *)__get_free_page(GFP_KERNEL)))</span>
<span class="p_add">+		if (!(vec[i] = get_free_page(GFP_KERNEL)))</span>
 			goto out_free;
 
 	mlog(0, &quot;Allocated DLM hash pagevec; %d pages (%lu expected), %lu buckets per page\n&quot;,
<span class="p_header">diff --git a/fs/ocfs2/dlm/dlmmaster.c b/fs/ocfs2/dlm/dlmmaster.c</span>
<span class="p_header">index a0edd7e..2d5c2c38 100644</span>
<span class="p_header">--- a/fs/ocfs2/dlm/dlmmaster.c</span>
<span class="p_header">+++ b/fs/ocfs2/dlm/dlmmaster.c</span>
<span class="p_chunk">@@ -2498,7 +2498,7 @@</span> <span class="p_context"> static int dlm_migrate_lockres(struct dlm_ctxt *dlm,</span>
 
 	/* preallocate up front. if this fails, abort */
 	ret = -ENOMEM;
<span class="p_del">-	mres = (struct dlm_migratable_lockres *) __get_free_page(GFP_NOFS);</span>
<span class="p_add">+	mres = get_free_page(GFP_NOFS);</span>
 	if (!mres) {
 		mlog_errno(ret);
 		goto leave;
<span class="p_header">diff --git a/fs/ocfs2/dlm/dlmrecovery.c b/fs/ocfs2/dlm/dlmrecovery.c</span>
<span class="p_header">index 7368158..a2338d8 100644</span>
<span class="p_header">--- a/fs/ocfs2/dlm/dlmrecovery.c</span>
<span class="p_header">+++ b/fs/ocfs2/dlm/dlmrecovery.c</span>
<span class="p_chunk">@@ -856,7 +856,7 @@</span> <span class="p_context"> int dlm_request_all_locks_handler(struct o2net_msg *msg, u32 len, void *data,</span>
 	}
 
 	/* this will get freed by dlm_request_all_locks_worker */
<span class="p_del">-	buf = (char *) __get_free_page(GFP_NOFS);</span>
<span class="p_add">+	buf = get_free_page(GFP_NOFS);</span>
 	if (!buf) {
 		kfree(item);
 		dlm_put(dlm);
<span class="p_header">diff --git a/fs/overlayfs/copy_up.c b/fs/overlayfs/copy_up.c</span>
<span class="p_header">index b3f1da5..0c66579 100644</span>
<span class="p_header">--- a/fs/overlayfs/copy_up.c</span>
<span class="p_header">+++ b/fs/overlayfs/copy_up.c</span>
<span class="p_chunk">@@ -134,7 +134,7 @@</span> <span class="p_context"> static char *ovl_read_symlink(struct dentry *realdentry)</span>
 		goto err;
 
 	res = -ENOMEM;
<span class="p_del">-	buf = (char *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	buf = get_free_page(GFP_KERNEL);</span>
 	if (!buf)
 		goto err;
 
<span class="p_header">diff --git a/fs/proc/base.c b/fs/proc/base.c</span>
<span class="p_header">index a9828e5..f115e58 100644</span>
<span class="p_header">--- a/fs/proc/base.c</span>
<span class="p_header">+++ b/fs/proc/base.c</span>
<span class="p_chunk">@@ -224,7 +224,7 @@</span> <span class="p_context"> static ssize_t proc_pid_cmdline_read(struct file *file, char __user *buf,</span>
 		goto out_mmput;
 	}
 
<span class="p_del">-	page = (char *)__get_free_page(GFP_TEMPORARY);</span>
<span class="p_add">+	page = get_free_page(GFP_TEMPORARY);</span>
 	if (!page) {
 		rv = -ENOMEM;
 		goto out_mmput;
<span class="p_chunk">@@ -855,7 +855,7 @@</span> <span class="p_context"> static ssize_t mem_rw(struct file *file, char __user *buf,</span>
 	if (!mm)
 		return 0;
 
<span class="p_del">-	page = (char *)__get_free_page(GFP_TEMPORARY);</span>
<span class="p_add">+	page = get_free_page(GFP_TEMPORARY);</span>
 	if (!page)
 		return -ENOMEM;
 
<span class="p_chunk">@@ -956,7 +956,7 @@</span> <span class="p_context"> static ssize_t environ_read(struct file *file, char __user *buf,</span>
 	if (!mm)
 		return 0;
 
<span class="p_del">-	page = (char *)__get_free_page(GFP_TEMPORARY);</span>
<span class="p_add">+	page = get_free_page(GFP_TEMPORARY);</span>
 	if (!page)
 		return -ENOMEM;
 
<span class="p_chunk">@@ -1586,7 +1586,7 @@</span> <span class="p_context"> out:</span>
 
 static int do_proc_readlink(struct path *path, char __user *buffer, int buflen)
 {
<span class="p_del">-	char *tmp = (char*)__get_free_page(GFP_TEMPORARY);</span>
<span class="p_add">+	char *tmp = get_free_page(GFP_TEMPORARY);</span>
 	char *pathname;
 	int len;
 
<span class="p_chunk">@@ -2375,7 +2375,7 @@</span> <span class="p_context"> static ssize_t proc_pid_attr_write(struct file * file, const char __user * buf,</span>
 		goto out;
 
 	length = -ENOMEM;
<span class="p_del">-	page = (char*)__get_free_page(GFP_TEMPORARY);</span>
<span class="p_add">+	page = get_free_page(GFP_TEMPORARY);</span>
 	if (!page)
 		goto out;
 
<span class="p_header">diff --git a/fs/select.c b/fs/select.c</span>
<span class="p_header">index 6acb0ae..8619de7 100644</span>
<span class="p_header">--- a/fs/select.c</span>
<span class="p_header">+++ b/fs/select.c</span>
<span class="p_chunk">@@ -165,7 +165,7 @@</span> <span class="p_context"> static struct poll_table_entry *poll_get_entry(struct poll_wqueues *p)</span>
 	if (!table || POLL_TABLE_FULL(table)) {
 		struct poll_table_page *new_table;
 
<span class="p_del">-		new_table = (struct poll_table_page *) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+		new_table = get_free_page(GFP_KERNEL);</span>
 		if (!new_table) {
 			p-&gt;error = -ENOMEM;
 			return NULL;
<span class="p_header">diff --git a/include/linux/quicklist.h b/include/linux/quicklist.h</span>
<span class="p_header">index bd46643..fa5ecd2 100644</span>
<span class="p_header">--- a/include/linux/quicklist.h</span>
<span class="p_header">+++ b/include/linux/quicklist.h</span>
<span class="p_chunk">@@ -46,7 +46,7 @@</span> <span class="p_context"> static inline void *quicklist_alloc(int nr, gfp_t flags, void (*ctor)(void *))</span>
 	if (likely(p))
 		return p;
 
<span class="p_del">-	p = (void *)__get_free_page(flags | __GFP_ZERO);</span>
<span class="p_add">+	p = get_free_page(flags | __GFP_ZERO);</span>
 	if (ctor &amp;&amp; p)
 		ctor(p);
 	return p;
<span class="p_header">diff --git a/kernel/groups.c b/kernel/groups.c</span>
<span class="p_header">index 88f7e1a8..e978016c 100644</span>
<span class="p_header">--- a/kernel/groups.c</span>
<span class="p_header">+++ b/kernel/groups.c</span>
<span class="p_chunk">@@ -30,7 +30,7 @@</span> <span class="p_context"> struct group_info *groups_alloc(int gidsetsize)</span>
 	else {
 		for (i = 0; i &lt; nblocks; i++) {
 			kgid_t *b;
<span class="p_del">-			b = (void *)__get_free_page(GFP_USER);</span>
<span class="p_add">+			b = get_free_page(GFP_USER);</span>
 			if (!b)
 				goto out_undo_partial_alloc;
 			group_info-&gt;blocks[i] = b;
<span class="p_header">diff --git a/kernel/power/swap.c b/kernel/power/swap.c</span>
<span class="p_header">index 5bbe897..f64d341 100644</span>
<span class="p_header">--- a/kernel/power/swap.c</span>
<span class="p_header">+++ b/kernel/power/swap.c</span>
<span class="p_chunk">@@ -356,7 +356,7 @@</span> <span class="p_context"> static int write_page(void *buf, sector_t offset, struct hib_bio_batch *hb)</span>
 		return -ENOSPC;
 
 	if (hb) {
<span class="p_del">-		src = (void *)__get_free_page(__GFP_RECLAIM | __GFP_NOWARN |</span>
<span class="p_add">+		src = get_free_page(__GFP_RECLAIM | __GFP_NOWARN |</span>
 		                              __GFP_NORETRY);
 		if (src) {
 			copy_page(src, buf);
<span class="p_chunk">@@ -364,7 +364,7 @@</span> <span class="p_context"> static int write_page(void *buf, sector_t offset, struct hib_bio_batch *hb)</span>
 			ret = hib_wait_io(hb); /* Free pages */
 			if (ret)
 				return ret;
<span class="p_del">-			src = (void *)__get_free_page(__GFP_RECLAIM |</span>
<span class="p_add">+			src = get_free_page(__GFP_RECLAIM |</span>
 			                              __GFP_NOWARN |
 			                              __GFP_NORETRY);
 			if (src) {
<span class="p_chunk">@@ -672,7 +672,7 @@</span> <span class="p_context"> static int save_image_lzo(struct swap_map_handle *handle,</span>
 	nr_threads = num_online_cpus() - 1;
 	nr_threads = clamp_val(nr_threads, 1, LZO_THREADS);
 
<span class="p_del">-	page = (void *)__get_free_page(__GFP_RECLAIM | __GFP_HIGH);</span>
<span class="p_add">+	page = get_free_page(__GFP_RECLAIM | __GFP_HIGH);</span>
 	if (!page) {
 		printk(KERN_ERR &quot;PM: Failed to allocate LZO page\n&quot;);
 		ret = -ENOMEM;
<span class="p_chunk">@@ -974,8 +974,7 @@</span> <span class="p_context"> static int get_swap_reader(struct swap_map_handle *handle,</span>
 			last-&gt;next = tmp;
 		last = tmp;
 
<span class="p_del">-		tmp-&gt;map = (struct swap_map_page *)</span>
<span class="p_del">-			   __get_free_page(__GFP_RECLAIM | __GFP_HIGH);</span>
<span class="p_add">+		tmp-&gt;map = get_free_page(__GFP_RECLAIM | __GFP_HIGH);</span>
 		if (!tmp-&gt;map) {
 			release_swap_reader(handle);
 			return -ENOMEM;
<span class="p_chunk">@@ -1241,7 +1240,7 @@</span> <span class="p_context"> static int load_image_lzo(struct swap_map_handle *handle,</span>
 	read_pages = clamp_val(read_pages, LZO_MIN_RD_PAGES, LZO_MAX_RD_PAGES);
 
 	for (i = 0; i &lt; read_pages; i++) {
<span class="p_del">-		page[i] = (void *)__get_free_page(i &lt; LZO_CMP_PAGES ?</span>
<span class="p_add">+		page[i] = get_free_page(i &lt; LZO_CMP_PAGES ?</span>
 						  __GFP_RECLAIM | __GFP_HIGH :
 						  __GFP_RECLAIM | __GFP_NOWARN |
 						  __GFP_NORETRY);
<span class="p_chunk">@@ -1580,7 +1579,7 @@</span> <span class="p_context"> int swsusp_unmark(void)</span>
 
 static int swsusp_header_init(void)
 {
<span class="p_del">-	swsusp_header = (struct swsusp_header*) __get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	swsusp_header =  get_free_page(GFP_KERNEL);</span>
 	if (!swsusp_header)
 		panic(&quot;Could not allocate memory for swsusp_header\n&quot;);
 	return 0;
<span class="p_header">diff --git a/kernel/sysctl.c b/kernel/sysctl.c</span>
<span class="p_header">index edb7da4..b2aed2a 100644</span>
<span class="p_header">--- a/kernel/sysctl.c</span>
<span class="p_header">+++ b/kernel/sysctl.c</span>
<span class="p_chunk">@@ -2077,7 +2077,7 @@</span> <span class="p_context"> static int __do_proc_dointvec(void *tbl_data, struct ctl_table *table,</span>
 
 		if (left &gt; PAGE_SIZE - 1)
 			left = PAGE_SIZE - 1;
<span class="p_del">-		kbuf = (char *)__get_free_page(GFP_TEMPORARY);</span>
<span class="p_add">+		kbuf = get_free_page(GFP_TEMPORARY);</span>
 		if (!kbuf)
 			return -ENOMEM;
 		if (copy_from_user(kbuf, buffer, left)) {
<span class="p_chunk">@@ -2337,7 +2337,7 @@</span> <span class="p_context"> static int __do_proc_doulongvec_minmax(void *data, struct ctl_table *table, int</span>
 
 		if (left &gt; PAGE_SIZE - 1)
 			left = PAGE_SIZE - 1;
<span class="p_del">-		kbuf = (char *)__get_free_page(GFP_TEMPORARY);</span>
<span class="p_add">+		kbuf = get_free_page(GFP_TEMPORARY);</span>
 		if (!kbuf)
 			return -ENOMEM;
 		if (copy_from_user(kbuf, buffer, left)) {
<span class="p_chunk">@@ -2646,7 +2646,7 @@</span> <span class="p_context"> int proc_do_large_bitmap(struct ctl_table *table, int write,</span>
 	}
 
 	if (write) {
<span class="p_del">-		char *kbuf = (char *)__get_free_page(GFP_TEMPORARY);</span>
<span class="p_add">+		char *kbuf = get_free_page(GFP_TEMPORARY);</span>
 		if (!kbuf)
 			return -ENOMEM;
 
<span class="p_header">diff --git a/kernel/trace/trace_events.c b/kernel/trace/trace_events.c</span>
<span class="p_header">index 0a0a08e..d32df68 100644</span>
<span class="p_header">--- a/kernel/trace/trace_events.c</span>
<span class="p_header">+++ b/kernel/trace/trace_events.c</span>
<span class="p_chunk">@@ -1340,7 +1340,7 @@</span> <span class="p_context"> event_filter_write(struct file *filp, const char __user *ubuf, size_t cnt,</span>
 	if (cnt &gt;= PAGE_SIZE)
 		return -EINVAL;
 
<span class="p_del">-	buf = (char *)__get_free_page(GFP_TEMPORARY);</span>
<span class="p_add">+	buf = get_free_page(GFP_TEMPORARY);</span>
 	if (!buf)
 		return -ENOMEM;
 
<span class="p_chunk">@@ -1507,7 +1507,7 @@</span> <span class="p_context"> subsystem_filter_write(struct file *filp, const char __user *ubuf, size_t cnt,</span>
 	if (cnt &gt;= PAGE_SIZE)
 		return -EINVAL;
 
<span class="p_del">-	buf = (char *)__get_free_page(GFP_TEMPORARY);</span>
<span class="p_add">+	buf = get_free_page(GFP_TEMPORARY);</span>
 	if (!buf)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/kernel/trace/trace_events_filter.c b/kernel/trace/trace_events_filter.c</span>
<span class="p_header">index 234b5b9e..3889fce 100644</span>
<span class="p_header">--- a/kernel/trace/trace_events_filter.c</span>
<span class="p_header">+++ b/kernel/trace/trace_events_filter.c</span>
<span class="p_chunk">@@ -671,7 +671,7 @@</span> <span class="p_context"> static void append_filter_err(struct filter_parse_state *ps,</span>
 	int pos = ps-&gt;lasterr_pos;
 	char *buf, *pbuf;
 
<span class="p_del">-	buf = (char *)__get_free_page(GFP_TEMPORARY);</span>
<span class="p_add">+	buf = get_free_page(GFP_TEMPORARY);</span>
 	if (!buf)
 		return;
 
<span class="p_header">diff --git a/kernel/trace/trace_events_trigger.c b/kernel/trace/trace_events_trigger.c</span>
<span class="p_header">index 0796e61..af6c31d 100644</span>
<span class="p_header">--- a/kernel/trace/trace_events_trigger.c</span>
<span class="p_header">+++ b/kernel/trace/trace_events_trigger.c</span>
<span class="p_chunk">@@ -237,7 +237,7 @@</span> <span class="p_context"> static ssize_t event_trigger_regex_write(struct file *file,</span>
 	if (cnt &gt;= PAGE_SIZE)
 		return -EINVAL;
 
<span class="p_del">-	buf = (char *)__get_free_page(GFP_TEMPORARY);</span>
<span class="p_add">+	buf = get_free_page(GFP_TEMPORARY);</span>
 	if (!buf)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/kernel/user_namespace.c b/kernel/user_namespace.c</span>
<span class="p_header">index badce97..57eb85f0 100644</span>
<span class="p_header">--- a/kernel/user_namespace.c</span>
<span class="p_header">+++ b/kernel/user_namespace.c</span>
<span class="p_chunk">@@ -639,7 +639,7 @@</span> <span class="p_context"> static ssize_t map_write(struct file *file, const char __user *buf,</span>
 
 	/* Get a buffer */
 	ret = -ENOMEM;
<span class="p_del">-	kbuf = (char *)__get_free_page(GFP_TEMPORARY);</span>
<span class="p_add">+	kbuf = get_free_page(GFP_TEMPORARY);</span>
 	if (!kbuf)
 		goto out;
 
<span class="p_header">diff --git a/lib/scatterlist.c b/lib/scatterlist.c</span>
<span class="p_header">index 6f44c3e..0752e7a 100644</span>
<span class="p_header">--- a/lib/scatterlist.c</span>
<span class="p_header">+++ b/lib/scatterlist.c</span>
<span class="p_chunk">@@ -173,7 +173,7 @@</span> <span class="p_context"> static struct scatterlist *sg_kmalloc(unsigned int nents, gfp_t gfp_mask)</span>
 		 * false-positive) we need to inform kmemleak of all the
 		 * intermediate allocations.
 		 */
<span class="p_del">-		void *ptr = (void *) __get_free_page(gfp_mask);</span>
<span class="p_add">+		void *ptr = get_free_page(gfp_mask);</span>
 		kmemleak_alloc(ptr, PAGE_SIZE, 1, gfp_mask);
 		return ptr;
 	} else
<span class="p_header">diff --git a/mm/memory.c b/mm/memory.c</span>
<span class="p_header">index a3c4440..8e4b375 100644</span>
<span class="p_header">--- a/mm/memory.c</span>
<span class="p_header">+++ b/mm/memory.c</span>
<span class="p_chunk">@@ -371,7 +371,7 @@</span> <span class="p_context"> void tlb_remove_table(struct mmu_gather *tlb, void *table)</span>
 	}
 
 	if (*batch == NULL) {
<span class="p_del">-		*batch = (struct mmu_table_batch *)__get_free_page(GFP_NOWAIT | __GFP_NOWARN);</span>
<span class="p_add">+		*batch = get_free_page(GFP_NOWAIT | __GFP_NOWARN);</span>
 		if (*batch == NULL) {
 			tlb_remove_table_one(table);
 			return;
<span class="p_chunk">@@ -3762,7 +3762,7 @@</span> <span class="p_context"> void print_vma_addr(char *prefix, unsigned long ip)</span>
 	vma = find_vma(mm, ip);
 	if (vma &amp;&amp; vma-&gt;vm_file) {
 		struct file *f = vma-&gt;vm_file;
<span class="p_del">-		char *buf = (char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+		char *buf = get_free_page(GFP_KERNEL);</span>
 		if (buf) {
 			char *p;
 
<span class="p_header">diff --git a/mm/migrate.c b/mm/migrate.c</span>
<span class="p_header">index 7aeba9a..f9c2d38 100644</span>
<span class="p_header">--- a/mm/migrate.c</span>
<span class="p_header">+++ b/mm/migrate.c</span>
<span class="p_chunk">@@ -1323,7 +1323,7 @@</span> <span class="p_context"> static int do_pages_move(struct mm_struct *mm, nodemask_t task_nodes,</span>
 	int err;
 
 	err = -ENOMEM;
<span class="p_del">-	pm = (struct page_to_node *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	pm = get_free_page(GFP_KERNEL);</span>
 	if (!pm)
 		goto out;
 
<span class="p_header">diff --git a/mm/mincore.c b/mm/mincore.c</span>
<span class="p_header">index 077ef0e..a6a19db 100644</span>
<span class="p_header">--- a/mm/mincore.c</span>
<span class="p_header">+++ b/mm/mincore.c</span>
<span class="p_chunk">@@ -239,7 +239,7 @@</span> <span class="p_context"> SYSCALL_DEFINE3(mincore, unsigned long, start, size_t, len,</span>
 	if (!access_ok(VERIFY_WRITE, vec, pages))
 		return -EFAULT;
 
<span class="p_del">-	tmp = (void *) __get_free_page(GFP_USER);</span>
<span class="p_add">+	tmp = get_free_page(GFP_USER);</span>
 	if (!tmp)
 		return -EAGAIN;
 
<span class="p_header">diff --git a/net/atm/mpoa_proc.c b/net/atm/mpoa_proc.c</span>
<span class="p_header">index a2721ae..45d20cb 100644</span>
<span class="p_header">--- a/net/atm/mpoa_proc.c</span>
<span class="p_header">+++ b/net/atm/mpoa_proc.c</span>
<span class="p_chunk">@@ -215,7 +215,7 @@</span> <span class="p_context"> static ssize_t proc_mpc_write(struct file *file, const char __user *buff,</span>
 	if (nbytes &gt;= PAGE_SIZE)
 		nbytes = PAGE_SIZE-1;
 
<span class="p_del">-	page = (char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	page = get_free_page(GFP_KERNEL);</span>
 	if (!page)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/security/selinux/hooks.c b/security/selinux/hooks.c</span>
<span class="p_header">index dba9f5f..e539d0d 100644</span>
<span class="p_header">--- a/security/selinux/hooks.c</span>
<span class="p_header">+++ b/security/selinux/hooks.c</span>
<span class="p_chunk">@@ -1258,7 +1258,7 @@</span> <span class="p_context"> static int selinux_genfs_get_sid(struct dentry *dentry,</span>
 	struct super_block *sb = dentry-&gt;d_inode-&gt;i_sb;
 	char *buffer, *path;
 
<span class="p_del">-	buffer = (char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	buffer = get_free_page(GFP_KERNEL);</span>
 	if (!buffer)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/security/selinux/selinuxfs.c b/security/selinux/selinuxfs.c</span>
<span class="p_header">index c4de69b..563ba88 100644</span>
<span class="p_header">--- a/security/selinux/selinuxfs.c</span>
<span class="p_header">+++ b/security/selinux/selinuxfs.c</span>
<span class="p_chunk">@@ -1336,7 +1336,7 @@</span> <span class="p_context"> static ssize_t sel_read_avc_hash_stats(struct file *filp, char __user *buf,</span>
 	char *page;
 	ssize_t length;
 
<span class="p_del">-	page = (char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	page = get_free_page(GFP_KERNEL);</span>
 	if (!page)
 		return -ENOMEM;
 
<span class="p_header">diff --git a/sound/oss/msnd_pinnacle.c b/sound/oss/msnd_pinnacle.c</span>
<span class="p_header">index 8aa54fc..8ce2399 100644</span>
<span class="p_header">--- a/sound/oss/msnd_pinnacle.c</span>
<span class="p_header">+++ b/sound/oss/msnd_pinnacle.c</span>
<span class="p_chunk">@@ -899,7 +899,7 @@</span> <span class="p_context"> static __inline__ int pack_DAPF_to_DAPQ(register int start)</span>
 static int dsp_read(char __user *buf, size_t len)
 {
 	int count = len;
<span class="p_del">-	char *page = (char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	char *page = get_free_page(GFP_KERNEL);</span>
 	int timeout = get_rec_delay_jiffies(DAR_BUFF_SIZE);
 
 	if (!page)
<span class="p_chunk">@@ -958,7 +958,7 @@</span> <span class="p_context"> static int dsp_read(char __user *buf, size_t len)</span>
 static int dsp_write(const char __user *buf, size_t len)
 {
 	int count = len;
<span class="p_del">-	char *page = (char *)__get_free_page(GFP_KERNEL);</span>
<span class="p_add">+	char *page = get_free_page(GFP_KERNEL);</span>
 	int timeout = get_play_delay_jiffies(DAP_BUFF_SIZE);
 
 	if (!page)

</pre>
</div>




  </div>
  <div id="footer">
   <a href="http://jk.ozlabs.org/projects/patchwork/">patchwork</a>
   patch tracking system
  </div>
 </body>
</html>



