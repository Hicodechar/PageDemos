
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <title>[3/3] perf tool, arm64, thunderx2: Add implementation defined events for ThunderX2 - Patchwork</title>
  <link rel="stylesheet" type="text/css" href="/static/css/style.css"/>
  <script type="text/javascript" src="/static/js/common.js"></script>
  <script type="text/javascript" src="/static/js/jquery-1.10.1.min.js"></script>

 </head>
 <body>
  <div id="title">
  <h1 style="float: left;">
     <a
      href="/">Patchwork</a>
    [3/3] perf tool, arm64, thunderx2: Add implementation defined events for ThunderX2</h1>
  <div id="auth">

     <a href="/user/login/">login</a>
     <br/>
     <a href="/register/">register</a>
     <br/>
     <a href="/mail/">mail settings</a>

   </div>
   <div style="clear: both;"></div>
  </div>
  <div id="nav">
   <div id="navleft">
   
    <strong>Project</strong>: LKML
     :
     <a href="/project/LKML/list/"
      >patches</a>
     :
     <a href="/project/LKML/"
      >project info</a>
    
     :
     <a href="/"
     >other projects</a>
     
    
   </div>
   <div id="navright">
    <a href="/help/about/">about</a>
   </div>
   <div style="clear: both"></div>
  </div>

  <div id="content">

<script language="JavaScript" type="text/javascript">
function toggle_headers(link_id, headers_id)
{
    var link = document.getElementById(link_id)
    var headers = document.getElementById(headers_id)

    var hidden = headers.style['display'] == 'none';

    if (hidden) {
        link.innerHTML = 'hide';
        headers.style['display'] = 'block';
    } else {
        link.innerHTML = 'show';
        headers.style['display'] = 'none';
    }

}
</script>

<table class="patchmeta">
 <tr>
  <th>Submitter</th>
  <td><a href="/project/LKML/list/?submitter=173593">Ganapatrao Kulkarni</a></td>
 </tr>
 <tr>
  <th>Date</th>
  <td>April 4, 2017, 7:36 a.m.</td>
 </tr>
 <tr>
  <th>Message ID</th>
  <td>&lt;1491291403-29893-4-git-send-email-ganapatrao.kulkarni@cavium.com&gt;</td>
 </tr>
 <tr>
  <th>Download</th>
  <td>
   <a href="/patch/9660919/mbox/"
   >mbox</a>
|
   <a href="/patch/9660919/raw/"
   >patch</a>

   </td>
 </tr>
 <tr>
  <th>Permalink</th>
  <td><a href="/patch/9660919/">/patch/9660919/</a>
 </tr>
  <tr>
   <th>State</th>
   <td>New</td>
  </tr>


 <tr>
  <th>Headers</th>
  <td><a id="togglepatchheaders"
   href="javascript:toggle_headers('togglepatchheaders', 'patchheaders')"
   >show</a>
   <div id="patchheaders" class="patchheaders" style="display:none;">
    <pre>Return-Path: &lt;linux-kernel-owner@kernel.org&gt;
Received: from mail.wl.linuxfoundation.org (pdx-wl-mail.web.codeaurora.org
	[172.30.200.125])
	by pdx-korg-patchwork.web.codeaurora.org (Postfix) with ESMTP id
	38AD76032D for &lt;patchwork-LKML@patchwork.kernel.org&gt;;
	Tue,  4 Apr 2017 07:37:54 +0000 (UTC)
Received: from mail.wl.linuxfoundation.org (localhost [127.0.0.1])
	by mail.wl.linuxfoundation.org (Postfix) with ESMTP id 1F2FD2847B
	for &lt;patchwork-LKML@patchwork.kernel.org&gt;;
	Tue,  4 Apr 2017 07:37:54 +0000 (UTC)
Received: by mail.wl.linuxfoundation.org (Postfix, from userid 486)
	id 12C19284BA; Tue,  4 Apr 2017 07:37:54 +0000 (UTC)
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on
	pdx-wl-mail.web.codeaurora.org
X-Spam-Level: 
X-Spam-Status: No, score=-5.4 required=2.0 tests=BAYES_00,DKIM_SIGNED,
	DKIM_VALID, RCVD_IN_DNSWL_HI,
	RCVD_IN_SORBS_WEB autolearn=ham version=3.3.1
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.wl.linuxfoundation.org (Postfix) with ESMTP id 596BF2847B
	for &lt;patchwork-LKML@patchwork.kernel.org&gt;;
	Tue,  4 Apr 2017 07:37:53 +0000 (UTC)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1752953AbdDDHhq (ORCPT
	&lt;rfc822;patchwork-LKML@patchwork.kernel.org&gt;);
	Tue, 4 Apr 2017 03:37:46 -0400
Received: from mail-sn1nam01on0087.outbound.protection.outlook.com
	([104.47.32.87]:20356
	&quot;EHLO NAM01-SN1-obe.outbound.protection.outlook.com&quot;
	rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
	id S1752845AbdDDHhZ (ORCPT &lt;rfc822;linux-kernel@vger.kernel.org&gt;);
	Tue, 4 Apr 2017 03:37:25 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
	d=CAVIUMNETWORKS.onmicrosoft.com; s=selector1-cavium-com;
	h=From:Date:Subject:Message-ID:Content-Type:MIME-Version;
	bh=dkoP4BAqLHSnVIX3UYotbas8wcfT5q+w5npp6p5n3Vw=;
	b=mLI95xfAdT+LthU9eim6rOzKgnpWJh7Fimt9BUVPFgu4V4OFmYp0D5jAmyePwuim1gQXyvLptKXGmBLZBs2DwTH/maymXUZj4d7ruVeYTOIPevaYP5YnICgbMckx4BYgpABfUwhOh4dmVloviri0OV66pVp9tuuuyhuxtJwOYEo=
Authentication-Results: vger.kernel.org; dkim=none (message not signed)
	header.d=none; vger.kernel.org;
	dmarc=none action=none header.from=cavium.com; 
Received: from mypc.caveonetworks.com (111.93.218.67) by
	BY1PR0701MB1690.namprd07.prod.outlook.com (10.162.110.28) with
	Microsoft SMTP Server (version=TLS1_2,
	cipher=TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256_P256) id
	15.1.1005.10; Tue, 4 Apr 2017 07:37:19 +0000
From: Ganapatrao Kulkarni &lt;ganapatrao.kulkarni@cavium.com&gt;
To: linux-kernel@vger.kernel.org, linux-arm-kernel@lists.infradead.org
Cc: Will.Deacon@arm.com, catalin.marinas@arm.com, mark.rutland@arm.com,
	acme@kernel.org, alexander.shishkin@linux.intel.com,
	peterz@infradead.org, mingo@redhat.com, jnair@caviumnetworks.com,
	gpkulkarni@gmail.com
Subject: [PATCH 3/3] perf tool, arm64,
	thunderx2: Add implementation defined events for ThunderX2
Date: Tue,  4 Apr 2017 13:06:43 +0530
Message-Id: &lt;1491291403-29893-4-git-send-email-ganapatrao.kulkarni@cavium.com&gt;
X-Mailer: git-send-email 1.8.1.4
In-Reply-To: &lt;1491291403-29893-1-git-send-email-ganapatrao.kulkarni@cavium.com&gt;
References: &lt;1491291403-29893-1-git-send-email-ganapatrao.kulkarni@cavium.com&gt;
MIME-Version: 1.0
Content-Type: text/plain
X-Originating-IP: [111.93.218.67]
X-ClientProxiedBy: BMXPR01CA0020.INDPRD01.PROD.OUTLOOK.COM (10.174.214.158)
	To
	BY1PR0701MB1690.namprd07.prod.outlook.com (10.162.110.28)
X-MS-Office365-Filtering-Correlation-Id: ca2c60ef-b89a-4c1b-38f4-08d47b2d6f2c
X-Microsoft-Antispam: UriScan:; BCL:0; PCL:0;
	RULEID:(22001)(201703131423075)(201703031133081);
	SRVR:BY1PR0701MB1690; 
X-Microsoft-Exchange-Diagnostics: 1; BY1PR0701MB1690;
	3:R76xPcB41hc/seECDhv4/3SOBOV4Ei5AGaM7tsKDPLbWvrjJ7APh0h4XLiplIRhTyI6bblWgj1iGzAZjx74xHfwtRNoiAcx0+39hsukNs7eJ4hjcRBtaXblgrQLj3Gai3KQB8rKwFMPU44Ygw8z1lNMnh8+UoTjBeKmUKPZmmWkk6MNnOq54Dbe74CuvIk2heblbWTAJzHIogQLxKKXrsnDFDoRVGdRYtbogEc77QGasb+mEIihc8t5dnf4iZ3lY96+yeQTmB5Q/05Qq3IjloBzYPGfWQzY48XjZF2wMiF7rFzO5RVKrsEieIdOsWpaz2pRgYX0JzJk6+hBxi7XuUg==;
	25:XUmUKnfWBQPa0fpbR//tqbyTxnSbaGkreXXjPfpImVO+ldw4Uiq9HOnnD5VzP6Jr63ysBbzQHPdqTIiptbC0fxoEq/MUgCW0xAyzG5l0cLlsDqhmX/HEbb2IT+K+BbuPXWUDykZtJSK3IwPeCVSeBtV4hgD8gcwLxdHlnIGiBwrG1/pruIjC21XiRlb0uXdyD07UQ0PckKjSy6hAUnEUn9UfK0//1CvnnzTpLkDaSeEMjZvFOS9aOfK7rFhtiO8x/3588c8CSKAf4yeG1jCjiZfjQV8Y58CTQCX5HmPdYmzrw4CTTYOYO3Lod8Ih9u+AwAdbUKaoGfGElsCAQT+6YU09Zf++X4QBPgWWlhWB9N/jUFexUDYChguJtOUuPkdTtxi3iOuPPkqUCjLVbX22VUwVlABd6R7uSMd+Yx2ha19oWnya5k/xKhVLwon4grdsc9n82RgYIart/bwYLq9MkQ==
X-Microsoft-Exchange-Diagnostics: 1; BY1PR0701MB1690;
	31:4zs0gVuswx6ggNPHAPNNXfzISCu9PPlMTy5AZQFK9Qu2wUP3w8Tqj+RQm+5D/lMVm9c3LfIqL67eYjNgqPikLtIUvP+UL0Ngd6dD6V9jzLw14zGri+nXaK+WQN9y2+Z+FTGxH8uFZ4IxnW9A52BOKMFOw4bPvQI97xM1JzDKYquNSYXTq0VoyvO8EhkPac03Fff++y2lTzfxkyNQ0w07oCx1nWFkc9hhzuHrrtCMX6U=;
	20:aCJHSHNIbMF4q5NijQiFFFmbHRlDs0DQnco7Vi7j/UB5SNQGET7cwKtqc9ZsVNlGVsaDO2cGVHeZOJ0nevzgGxXJHfhSJV6UvXF86PkqIe2h7xyMU3iliIRTFCg2jAA6b8zpp3BpSrsCubo1bT5YCdCGyLXVh1YIf1X3i5AZx9s9eEd5GfCi2668gFSb54qWSWy+LOgwfsbFROtZcuCv057Ee8NeRZ+prKZTLnNaVWuKDQX+97qL+Wf++BDBOGKp/nddHkgNJT1/Xd+HcsdroPc0GR2/PzMSC7MALQajy5hK3GuoeEgIZs2SwKBu0noDqXg21wBVUAhwnNYSjcKRcpNtG8akcnvdq+8GBfT+6F/Vdiy0RGclWTP7mmlmhQRIXV7sl1E5J+NWv5aS3AizImysXnbuo6ZG4faKGqORx+p/yb2ESTRzZKcDw3DSpaVLHaJMl/cWixk7235xBqxxbcKFbr+ILe5d8dFElYECF4ka3HSDWM7BPf7PJaX4ATuz
X-Microsoft-Antispam-PRVS: &lt;BY1PR0701MB1690929BD0E3BEBF2BCB1DB8830B0@BY1PR0701MB1690.namprd07.prod.outlook.com&gt;
X-Exchange-Antispam-Report-Test: UriScan:;
X-Exchange-Antispam-Report-CFA-Test: BCL:0; PCL:0;
	RULEID:(6040450)(601004)(2401047)(8121501046)(5005006)(10201501046)(3002001)(93006095)(93001095)(6041248)(20161123555025)(20161123564025)(20161123562025)(20161123560025)(201703131423075)(201702281528075)(201703061421075)(6072148);
	SRVR:BY1PR0701MB1690; BCL:0; PCL:0; RULEID:;
	SRVR:BY1PR0701MB1690; 
X-Microsoft-Exchange-Diagnostics: 1; BY1PR0701MB1690;
	4:iEBjc0sWMlMKFcz6cknbq7SwW6HuC9SeMTSR+ub7w/Pa21AG8yTWbNGrrMxYPT1BujpVNRmWfG8nsFfdIfYZzNc66tcNMBdMU1UNYtcMhJcWLdlayD2mAXNu3QFuoaBajl/SWeuDY2C4Fxk2l8JHvN6T0IxWMGLP4Qc1t8+8BeRPMUNeIWxzHV92qe28gjLqB3JaoB7Ktr9OMN6R8wi6Kc+yGQiTwqb0YZkZOfdDq8bpgGsXT6kSGEa3aDDxftKwjrsI/AqG4T611EE6cNZSBEirLhgBsej4XBZ7mhA6VYueb+1c3FmyB0bHlBLwsf8yn4R7tfg4zC+YsGlUgvQfvWtR+mVa3MOGSAV13ShdfBxFFSNiYlyQ/JgJ1LLM/BWMcpTqdK/QPEDtmD5I4W/iMRW0/xa4ynH+L+rQYSDBizTk1ci6HhCBd37Xx6q23MNXaS6lfVN9wbNCtbFh2junMASagtv4/7q/EfQDAgxTQOzudoNpOEiwFpBPP6L69lL79o707BnE7+/oyXFDlBpNpqWnq1PBkM+yl8H1681Wb0UPHOjhK2XVVar96HT/c92t1HLenfjOTOR9XmuJ0xexoLGQzwlp3OV5dgQ9Kep6XTlUwxuCOC2PYLcVwNc/KZdrNeW/UZlDiCEJsu6b3EGMvwHfkI5hZ60VOdxDr3vvNfbc15kpC+OZnidB3H39LWglIi+lucXqnjmNk5N14lU95g==
X-Forefront-PRVS: 0267E514F9
X-Forefront-Antispam-Report: SFV:NSPM;
	SFS:(10009020)(4630300001)(6009001)(39450400003)(39410400002)(39400400002)(39850400002)(39840400002)(50226002)(2906002)(3846002)(8676002)(4326008)(42186005)(5003940100001)(2950100002)(36756003)(6116002)(25786009)(6666003)(4720700003)(86362001)(5660300001)(81166006)(53936002)(6486002)(6506006)(305945005)(66066001)(7736002)(47776003)(5009440100003)(189998001)(53416004)(33646002)(38730400002)(50986999)(76176999)(110136004)(6512007)(50466002)(48376002);
	DIR:OUT; SFP:1101; SCL:1; SRVR:BY1PR0701MB1690;
	H:mypc.caveonetworks.com; FPR:; SPF:None; MLV:sfv; LANG:en; 
X-Microsoft-Exchange-Diagnostics: =?us-ascii?Q?1; BY1PR0701MB1690;
	23:t0pNpVn5Py6p8OkU0GGDC5/jOlNOXSb2tCcNcY/?=
	=?us-ascii?Q?m00X/X7Uxd4Cogl+JCqpMHR81WXjU6oTgr2U+gW6Nt/qn9noeiQD7c7FSJJL?=
	=?us-ascii?Q?vat6ioUyozemHKgG2wL+Y5MtkS4JZdmuS5zxhwhS753fwtHMFvaKJqHGUrF2?=
	=?us-ascii?Q?p2WqmS6l+KwAk9OVeDEHOBR6TdXpd7mDmbV+b9woNs/mtqnkrC8bEmM9Ivuf?=
	=?us-ascii?Q?70JHouzR/ZXp62z0uGrrGesCKHkNwKRsqBgK1RMZ/oAlYXCpqzPhx9Nexvvk?=
	=?us-ascii?Q?XE2eYfkxQwGSoXmuik/asD9gEGc8McDWqR3Ti8jkjR2TeXmzB/a9OsHLZTne?=
	=?us-ascii?Q?nQGVJPBZ8bnDJbpj6ugSne9QjO0pfKiaPeNB39S77A9fsgYBmTwjC6FeysHc?=
	=?us-ascii?Q?Qv6MgyXTcPtcge17s7xEkMZ61/Z16jY/2KkVeSBkLpzXB/X9mQn22GcbFeOc?=
	=?us-ascii?Q?OOMnehv5Tuvth9IhoRmRg0j+O5QBPTBrP2/4g5Iv2IFho4TsF4POQKSyJYxP?=
	=?us-ascii?Q?wu7WgrXEPQItnffc03B0svlLeRCaKrsEIOU1k92e0o2xVpGgGBrYp2OifzY5?=
	=?us-ascii?Q?f9CE4VPpwmEXK8SMFuCXoR/9G4/Ftjjqbvi+cvZRsOOl8HhEKYPKCK7C5pCd?=
	=?us-ascii?Q?GTWoNhbPvB/pdCVP4xVimubr2qrIW/UrBb2lLo4m6kBFlXV36jgHqFYcQ7l/?=
	=?us-ascii?Q?J/539PcFQOA51MFrSSEqz7vQd+LBMv8hnG4w9BTzn9BzLe6UxGbCPXLlXaZu?=
	=?us-ascii?Q?0w1wNUJSH0sPnCVXHjuYGvY8TYxNrzOUI2zHEhceZ2yMaA73e+O57jAZpcnO?=
	=?us-ascii?Q?zuLOa5oF6OzDH6IgCGsDjOmtpl0s7p036kPM1MbGN8ZHi4YtpRVs1aEY93c/?=
	=?us-ascii?Q?9D/HatUYc6NmJytYnhUjgqITQmBhdghClre619uh9JMA6YjIY8mlxi0ryoRI?=
	=?us-ascii?Q?/A1U1zesShUej/DwuFvZWYYvCnjVv0jIAt/qhrZhBVgZSbDWuTD1611mmnlg?=
	=?us-ascii?Q?WpYwSYAaPNcRzH13AOvirtnqWS7KG1/0FzwxkbNNq/WStj0IMJaXqL+CT5VV?=
	=?us-ascii?Q?rKPAOoxw=3D?=
X-Microsoft-Exchange-Diagnostics: 1; BY1PR0701MB1690;
	6:39CvP5+bimesIVEnAtuakfWfwHenkvlaTuJZdMeOnIRdE2k2RlWuAyhUblwlB/Enn9jMr7WNYONqN3oy7b4G+JMfiyIdF50kmmh+fMgs3OepUd/8/Y9E4ExvY8rlQT+yMO2+RZx/k31HbDo1bdQAi8mt1DP2w99WOVdjbj1txIjG16BqQBnTukuK/9mjGz4HuZHlISQLKzwGsfXSQ4cGm2qM702zKA4HHQfGoHKARWyaJmCXZ0HuOE+1SwCzUldz1AbEjFXzekJTxI/k8TU+QHmiVePUz0rWBcXo7Ux0g4QGv1WrkwzIFLi/vdl6UnlgHwtihMN82kk0c8s1/I2vI4kyHeU49eJflTAuiI9RMNT4oOL/Id4I1cOG5x57IPhDVOHsGf2Lc6Bisjb9VX+qQQ==;
	5:MT9eYR3f7XOt9UPj1jkeRb6/iwX9PnCnb7A7DM6bW016gtZN2/EvnH647AaW/13WXSUw604DdFe4auXzsOVgA2MqxezXxKzjGxjRxPE/CZG1+uEeF9zok3jDc/+wo0Tp5GkCoNgEwGgLpCsI6EsRKg==;
	24:URljLSHOGq4FXUmngMzOlSrfaTNEmRTZUEOXzL0hhE571eS3NqIH854ylA7LklvGwfZfZCYjf3GA5HTqXU/2bEEmrBXjT9Co4Uev+05Df10=
SpamDiagnosticOutput: 1:99
SpamDiagnosticMetadata: NSPM
X-Microsoft-Exchange-Diagnostics: 1; BY1PR0701MB1690;
	7:u24JHjqj6jTcpBlmN0oHCoadNXW4HArgb47YRJip2s2R5RNSDZb7hl+ow2rzN/3bQrajDW7eLbIq+zIYGzMcDQoyaTvaZyQgImstzEEUscyP8FDEkYMcZUX+rsP5PG4mSaC2yjlMlqUCxKPWPvb99UyTaAf8DdGHZq3oRdaOavAPCrohqbhBMSmhDBbpyvqPtvghO+iUDMQHIpBpTHoC9KKleZ2tLd1/zXOTQ3zIwPaGd78qzBXIFa94O5zZiEBoWlWkrqRkNLbNkbUd3rMDdtsIeTH7eG0og4oHXj2XiQ/gstI7uxEz6RSY/tqG5j1/LaD+HSkYW0jue3qDxMgsmQ==
X-OriginatorOrg: cavium.com
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 04 Apr 2017 07:37:19.7045
	(UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-Transport-CrossTenantHeadersStamped: BY1PR0701MB1690
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: &lt;linux-kernel.vger.kernel.org&gt;
X-Mailing-List: linux-kernel@vger.kernel.org
X-Virus-Scanned: ClamAV using ClamSMTP
</pre>
   </div>
  </td>
 </tr>
</table>

<div class="patchforms">





 <div style="clear: both;">
 </div>
</div>



<h2>Comments</h2>

<div class="comment">
<div class="meta"><a href="/project/LKML/list/?submitter=173593">Ganapatrao Kulkarni</a> - April 4, 2017, 7:36 a.m.</div>
<pre class="content">
This is not a full event list, but a short list of useful events.
<span class="signed-off-by">
Signed-off-by: Ganapatrao Kulkarni &lt;ganapatrao.kulkarni@cavium.com&gt;</span>
---
 tools/perf/pmu-events/arch/arm64/mapfile.csv       |  2 +
 .../arm64/thunderx2/implementation-defined.json    | 72 ++++++++++++++++++++++
 2 files changed, 74 insertions(+)
 create mode 100644 tools/perf/pmu-events/arch/arm64/mapfile.csv
 create mode 100644 tools/perf/pmu-events/arch/arm64/thunderx2/implementation-defined.json
</pre>
</div>

<div class="comment">
<div class="meta"><a href="/project/LKML/list/?submitter=30282">Mark Rutland</a> - April 4, 2017, 12:28 p.m.</div>
<pre class="content">
On Tue, Apr 04, 2017 at 01:06:43PM +0530, Ganapatrao Kulkarni wrote:
<span class="quote">&gt; This is not a full event list, but a short list of useful events.</span>
<span class="quote">&gt; </span>
<span class="quote">&gt; Signed-off-by: Ganapatrao Kulkarni &lt;ganapatrao.kulkarni@cavium.com&gt;</span>
<span class="quote">&gt; ---</span>
<span class="quote">&gt;  tools/perf/pmu-events/arch/arm64/mapfile.csv       |  2 +</span>
<span class="quote">&gt;  .../arm64/thunderx2/implementation-defined.json    | 72 ++++++++++++++++++++++</span>
<span class="quote">&gt;  2 files changed, 74 insertions(+)</span>
<span class="quote">&gt;  create mode 100644 tools/perf/pmu-events/arch/arm64/mapfile.csv</span>
<span class="quote">&gt;  create mode 100644 tools/perf/pmu-events/arch/arm64/thunderx2/implementation-defined.json</span>
<span class="quote">&gt; </span>
<span class="quote">&gt; diff --git a/tools/perf/pmu-events/arch/arm64/mapfile.csv b/tools/perf/pmu-events/arch/arm64/mapfile.csv</span>
<span class="quote">&gt; new file mode 100644</span>
<span class="quote">&gt; index 0000000..ba30e43</span>
<span class="quote">&gt; --- /dev/null</span>
<span class="quote">&gt; +++ b/tools/perf/pmu-events/arch/arm64/mapfile.csv</span>
<span class="quote">&gt; @@ -0,0 +1,2 @@</span>
<span class="quote">&gt; +Family-model,Version,Filename,EventType</span>
<span class="quote">&gt; +0x00000000420f5161,v1,thunderx2,core</span>
<span class="quote">&gt; diff --git a/tools/perf/pmu-events/arch/arm64/thunderx2/implementation-defined.json b/tools/perf/pmu-events/arch/arm64/thunderx2/implementation-defined.json</span>
<span class="quote">&gt; new file mode 100644</span>
<span class="quote">&gt; index 0000000..360e084</span>
<span class="quote">&gt; --- /dev/null</span>
<span class="quote">&gt; +++ b/tools/perf/pmu-events/arch/arm64/thunderx2/implementation-defined.json</span>
<span class="quote">&gt; @@ -0,0 +1,72 @@</span>
<span class="quote">&gt; +[</span>
<span class="quote">&gt; +    {</span>
<span class="quote">&gt; +        &quot;PublicDescription&quot;: &quot;Attributable Level 1 data cache access, read&quot;,</span>
<span class="quote">&gt; +        &quot;EventCode&quot;: &quot;0x40&quot;,</span>
<span class="quote">&gt; +        &quot;EventName&quot;: &quot;l1d_cache_access_read&quot;,</span>
<span class="quote">&gt; +        &quot;BriefDescription&quot;: &quot;l1d cache access, read&quot;,</span>
<span class="quote">&gt; +	&quot;CPU&quot; :&quot;armv8_pmuv3_0&quot;</span>

Please let&#39;s not hard-code the name like this. Surely we can get rid of this?

The kernel doesn&#39;t currently name PMUs as armv8_pmuv3_*, and as that can
differ across DT/ACPI and in big.LITTLE, I don&#39;t think it makes sense to
try to rely one particular string regardless.

Thanks,
Mark.
</pre>
</div>

<div class="comment">
<div class="meta"><a href="/project/LKML/list/?submitter=106031">Ganapatrao Kulkarni</a> - April 5, 2017, 9:12 a.m.</div>
<pre class="content">
On Tue, Apr 4, 2017 at 5:58 PM, Mark Rutland &lt;mark.rutland@arm.com&gt; wrote:
<span class="quote">&gt; On Tue, Apr 04, 2017 at 01:06:43PM +0530, Ganapatrao Kulkarni wrote:</span>
<span class="quote">&gt;&gt; This is not a full event list, but a short list of useful events.</span>
<span class="quote">&gt;&gt;</span>
<span class="quote">&gt;&gt; Signed-off-by: Ganapatrao Kulkarni &lt;ganapatrao.kulkarni@cavium.com&gt;</span>
<span class="quote">&gt;&gt; ---</span>
<span class="quote">&gt;&gt;  tools/perf/pmu-events/arch/arm64/mapfile.csv       |  2 +</span>
<span class="quote">&gt;&gt;  .../arm64/thunderx2/implementation-defined.json    | 72 ++++++++++++++++++++++</span>
<span class="quote">&gt;&gt;  2 files changed, 74 insertions(+)</span>
<span class="quote">&gt;&gt;  create mode 100644 tools/perf/pmu-events/arch/arm64/mapfile.csv</span>
<span class="quote">&gt;&gt;  create mode 100644 tools/perf/pmu-events/arch/arm64/thunderx2/implementation-defined.json</span>
<span class="quote">&gt;&gt;</span>
<span class="quote">&gt;&gt; diff --git a/tools/perf/pmu-events/arch/arm64/mapfile.csv b/tools/perf/pmu-events/arch/arm64/mapfile.csv</span>
<span class="quote">&gt;&gt; new file mode 100644</span>
<span class="quote">&gt;&gt; index 0000000..ba30e43</span>
<span class="quote">&gt;&gt; --- /dev/null</span>
<span class="quote">&gt;&gt; +++ b/tools/perf/pmu-events/arch/arm64/mapfile.csv</span>
<span class="quote">&gt;&gt; @@ -0,0 +1,2 @@</span>
<span class="quote">&gt;&gt; +Family-model,Version,Filename,EventType</span>
<span class="quote">&gt;&gt; +0x00000000420f5161,v1,thunderx2,core</span>
<span class="quote">&gt;&gt; diff --git a/tools/perf/pmu-events/arch/arm64/thunderx2/implementation-defined.json b/tools/perf/pmu-events/arch/arm64/thunderx2/implementation-defined.json</span>
<span class="quote">&gt;&gt; new file mode 100644</span>
<span class="quote">&gt;&gt; index 0000000..360e084</span>
<span class="quote">&gt;&gt; --- /dev/null</span>
<span class="quote">&gt;&gt; +++ b/tools/perf/pmu-events/arch/arm64/thunderx2/implementation-defined.json</span>
<span class="quote">&gt;&gt; @@ -0,0 +1,72 @@</span>
<span class="quote">&gt;&gt; +[</span>
<span class="quote">&gt;&gt; +    {</span>
<span class="quote">&gt;&gt; +        &quot;PublicDescription&quot;: &quot;Attributable Level 1 data cache access, read&quot;,</span>
<span class="quote">&gt;&gt; +        &quot;EventCode&quot;: &quot;0x40&quot;,</span>
<span class="quote">&gt;&gt; +        &quot;EventName&quot;: &quot;l1d_cache_access_read&quot;,</span>
<span class="quote">&gt;&gt; +        &quot;BriefDescription&quot;: &quot;l1d cache access, read&quot;,</span>
<span class="quote">&gt;&gt; +     &quot;CPU&quot; :&quot;armv8_pmuv3_0&quot;</span>
<span class="quote">&gt;</span>
<span class="quote">&gt; Please let&#39;s not hard-code the name like this. Surely we can get rid of this?</span>
<span class="quote">&gt;</span>
<span class="quote">&gt; The kernel doesn&#39;t currently name PMUs as armv8_pmuv3_*, and as that can</span>
<span class="quote">&gt; differ across DT/ACPI and in big.LITTLE, I don&#39;t think it makes sense to</span>
<span class="quote">&gt; try to rely one particular string regardless.</span>

This string/name is fixed for a platform. having name here is essential to
know which devices among pmu (armv8_pmuv3_0, breakpoint, software)
devices, these jevents to be added.
also this json file is specific to a arch/soc/board, it is not a
generic file to be common.
<span class="quote">

&gt;</span>
<span class="quote">&gt; Thanks,</span>
<span class="quote">&gt; Mark.</span>

thanks
Ganapat
</pre>
</div>

<div class="comment">
<div class="meta"><a href="/project/LKML/list/?submitter=30282">Mark Rutland</a> - April 5, 2017, 10:05 a.m.</div>
<pre class="content">
On Wed, Apr 05, 2017 at 02:42:39PM +0530, Ganapatrao Kulkarni wrote:
<span class="quote">&gt; On Tue, Apr 4, 2017 at 5:58 PM, Mark Rutland &lt;mark.rutland@arm.com&gt; wrote:</span>
<span class="quote">&gt; &gt; On Tue, Apr 04, 2017 at 01:06:43PM +0530, Ganapatrao Kulkarni wrote:</span>
<span class="quote">&gt; &gt;&gt; This is not a full event list, but a short list of useful events.</span>
<span class="quote">&gt; &gt;&gt;</span>
<span class="quote">&gt; &gt;&gt; Signed-off-by: Ganapatrao Kulkarni &lt;ganapatrao.kulkarni@cavium.com&gt;</span>
<span class="quote">&gt; &gt;&gt; ---</span>
<span class="quote">&gt; &gt;&gt;  tools/perf/pmu-events/arch/arm64/mapfile.csv       |  2 +</span>
<span class="quote">&gt; &gt;&gt;  .../arm64/thunderx2/implementation-defined.json    | 72 ++++++++++++++++++++++</span>
<span class="quote">&gt; &gt;&gt;  2 files changed, 74 insertions(+)</span>
<span class="quote">&gt; &gt;&gt;  create mode 100644 tools/perf/pmu-events/arch/arm64/mapfile.csv</span>
<span class="quote">&gt; &gt;&gt;  create mode 100644 tools/perf/pmu-events/arch/arm64/thunderx2/implementation-defined.json</span>
<span class="quote">&gt; &gt;&gt;</span>
<span class="quote">&gt; &gt;&gt; diff --git a/tools/perf/pmu-events/arch/arm64/mapfile.csv b/tools/perf/pmu-events/arch/arm64/mapfile.csv</span>
<span class="quote">&gt; &gt;&gt; new file mode 100644</span>
<span class="quote">&gt; &gt;&gt; index 0000000..ba30e43</span>
<span class="quote">&gt; &gt;&gt; --- /dev/null</span>
<span class="quote">&gt; &gt;&gt; +++ b/tools/perf/pmu-events/arch/arm64/mapfile.csv</span>
<span class="quote">&gt; &gt;&gt; @@ -0,0 +1,2 @@</span>
<span class="quote">&gt; &gt;&gt; +Family-model,Version,Filename,EventType</span>
<span class="quote">&gt; &gt;&gt; +0x00000000420f5161,v1,thunderx2,core</span>
<span class="quote">&gt; &gt;&gt; diff --git a/tools/perf/pmu-events/arch/arm64/thunderx2/implementation-defined.json b/tools/perf/pmu-events/arch/arm64/thunderx2/implementation-defined.json</span>
<span class="quote">&gt; &gt;&gt; new file mode 100644</span>
<span class="quote">&gt; &gt;&gt; index 0000000..360e084</span>
<span class="quote">&gt; &gt;&gt; --- /dev/null</span>
<span class="quote">&gt; &gt;&gt; +++ b/tools/perf/pmu-events/arch/arm64/thunderx2/implementation-defined.json</span>
<span class="quote">&gt; &gt;&gt; @@ -0,0 +1,72 @@</span>
<span class="quote">&gt; &gt;&gt; +[</span>
<span class="quote">&gt; &gt;&gt; +    {</span>
<span class="quote">&gt; &gt;&gt; +        &quot;PublicDescription&quot;: &quot;Attributable Level 1 data cache access, read&quot;,</span>
<span class="quote">&gt; &gt;&gt; +        &quot;EventCode&quot;: &quot;0x40&quot;,</span>
<span class="quote">&gt; &gt;&gt; +        &quot;EventName&quot;: &quot;l1d_cache_access_read&quot;,</span>
<span class="quote">&gt; &gt;&gt; +        &quot;BriefDescription&quot;: &quot;l1d cache access, read&quot;,</span>
<span class="quote">&gt; &gt;&gt; +     &quot;CPU&quot; :&quot;armv8_pmuv3_0&quot;</span>
<span class="quote">&gt; &gt;</span>
<span class="quote">&gt; &gt; Please let&#39;s not hard-code the name like this. Surely we can get rid of this?</span>
<span class="quote">&gt; &gt;</span>
<span class="quote">&gt; &gt; The kernel doesn&#39;t currently name PMUs as armv8_pmuv3_*, and as that can</span>
<span class="quote">&gt; &gt; differ across DT/ACPI and in big.LITTLE, I don&#39;t think it makes sense to</span>
<span class="quote">&gt; &gt; try to rely one particular string regardless.</span>
<span class="quote">&gt; </span>
<span class="quote">&gt; This string/name is fixed for a platform. having name here is essential to</span>
<span class="quote">&gt; know which devices among pmu (armv8_pmuv3_0, breakpoint, software)</span>
<span class="quote">&gt; devices, these jevents to be added.</span>
<span class="quote">&gt; also this json file is specific to a arch/soc/board, it is not a</span>
<span class="quote">&gt; generic file to be common.</span>

This file describe the events of a CPU PMU, and CPUs are not specific to
a platform in general. There are many systems using Cortex-A57, for
example.

Across big.LITTLE SoCs with Cortex-A57, there&#39;s no guarantee as to
whether the Cortex-A57 cores would be named armv8_pmuv3_0, or
armv8_pmuv3_1, etc. This would depend on the boot CPU, probe order of
secondaries, etc.

I appreciate that your platform is homnogeneous, and you may not expect
the core to be reused in any heterogeneous system. However, I think that
if we&#39;re going to make this work for arm64 we should handle the general
case, rather than only having it support a limited set of platforms.

Currently, we don&#39;t have an &quot;official&quot; way of identifying which PMUs are
CPU PMUs, but one way we could idtentify them would be to look at if
they have a &quot;cpus&quot; attribute under sysfs (rather than a &quot;cpumask&quot;
attribute).

Thanks,
Mark.
</pre>
</div>

<div class="comment">
<div class="meta"><a href="/project/LKML/list/?submitter=106031">Ganapatrao Kulkarni</a> - April 6, 2017, 4:20 a.m.</div>
<pre class="content">
On Wed, Apr 5, 2017 at 3:35 PM, Mark Rutland &lt;mark.rutland@arm.com&gt; wrote:
<span class="quote">&gt; On Wed, Apr 05, 2017 at 02:42:39PM +0530, Ganapatrao Kulkarni wrote:</span>
<span class="quote">&gt;&gt; On Tue, Apr 4, 2017 at 5:58 PM, Mark Rutland &lt;mark.rutland@arm.com&gt; wrote:</span>
<span class="quote">&gt;&gt; &gt; On Tue, Apr 04, 2017 at 01:06:43PM +0530, Ganapatrao Kulkarni wrote:</span>
<span class="quote">&gt;&gt; &gt;&gt; This is not a full event list, but a short list of useful events.</span>
<span class="quote">&gt;&gt; &gt;&gt;</span>
<span class="quote">&gt;&gt; &gt;&gt; Signed-off-by: Ganapatrao Kulkarni &lt;ganapatrao.kulkarni@cavium.com&gt;</span>
<span class="quote">&gt;&gt; &gt;&gt; ---</span>
<span class="quote">&gt;&gt; &gt;&gt;  tools/perf/pmu-events/arch/arm64/mapfile.csv       |  2 +</span>
<span class="quote">&gt;&gt; &gt;&gt;  .../arm64/thunderx2/implementation-defined.json    | 72 ++++++++++++++++++++++</span>
<span class="quote">&gt;&gt; &gt;&gt;  2 files changed, 74 insertions(+)</span>
<span class="quote">&gt;&gt; &gt;&gt;  create mode 100644 tools/perf/pmu-events/arch/arm64/mapfile.csv</span>
<span class="quote">&gt;&gt; &gt;&gt;  create mode 100644 tools/perf/pmu-events/arch/arm64/thunderx2/implementation-defined.json</span>
<span class="quote">&gt;&gt; &gt;&gt;</span>
<span class="quote">&gt;&gt; &gt;&gt; diff --git a/tools/perf/pmu-events/arch/arm64/mapfile.csv b/tools/perf/pmu-events/arch/arm64/mapfile.csv</span>
<span class="quote">&gt;&gt; &gt;&gt; new file mode 100644</span>
<span class="quote">&gt;&gt; &gt;&gt; index 0000000..ba30e43</span>
<span class="quote">&gt;&gt; &gt;&gt; --- /dev/null</span>
<span class="quote">&gt;&gt; &gt;&gt; +++ b/tools/perf/pmu-events/arch/arm64/mapfile.csv</span>
<span class="quote">&gt;&gt; &gt;&gt; @@ -0,0 +1,2 @@</span>
<span class="quote">&gt;&gt; &gt;&gt; +Family-model,Version,Filename,EventType</span>
<span class="quote">&gt;&gt; &gt;&gt; +0x00000000420f5161,v1,thunderx2,core</span>
<span class="quote">&gt;&gt; &gt;&gt; diff --git a/tools/perf/pmu-events/arch/arm64/thunderx2/implementation-defined.json b/tools/perf/pmu-events/arch/arm64/thunderx2/implementation-defined.json</span>
<span class="quote">&gt;&gt; &gt;&gt; new file mode 100644</span>
<span class="quote">&gt;&gt; &gt;&gt; index 0000000..360e084</span>
<span class="quote">&gt;&gt; &gt;&gt; --- /dev/null</span>
<span class="quote">&gt;&gt; &gt;&gt; +++ b/tools/perf/pmu-events/arch/arm64/thunderx2/implementation-defined.json</span>
<span class="quote">&gt;&gt; &gt;&gt; @@ -0,0 +1,72 @@</span>
<span class="quote">&gt;&gt; &gt;&gt; +[</span>
<span class="quote">&gt;&gt; &gt;&gt; +    {</span>
<span class="quote">&gt;&gt; &gt;&gt; +        &quot;PublicDescription&quot;: &quot;Attributable Level 1 data cache access, read&quot;,</span>
<span class="quote">&gt;&gt; &gt;&gt; +        &quot;EventCode&quot;: &quot;0x40&quot;,</span>
<span class="quote">&gt;&gt; &gt;&gt; +        &quot;EventName&quot;: &quot;l1d_cache_access_read&quot;,</span>
<span class="quote">&gt;&gt; &gt;&gt; +        &quot;BriefDescription&quot;: &quot;l1d cache access, read&quot;,</span>
<span class="quote">&gt;&gt; &gt;&gt; +     &quot;CPU&quot; :&quot;armv8_pmuv3_0&quot;</span>
<span class="quote">&gt;&gt; &gt;</span>
<span class="quote">&gt;&gt; &gt; Please let&#39;s not hard-code the name like this. Surely we can get rid of this?</span>
<span class="quote">&gt;&gt; &gt;</span>
<span class="quote">&gt;&gt; &gt; The kernel doesn&#39;t currently name PMUs as armv8_pmuv3_*, and as that can</span>
<span class="quote">&gt;&gt; &gt; differ across DT/ACPI and in big.LITTLE, I don&#39;t think it makes sense to</span>
<span class="quote">&gt;&gt; &gt; try to rely one particular string regardless.</span>
<span class="quote">&gt;&gt;</span>
<span class="quote">&gt;&gt; This string/name is fixed for a platform. having name here is essential to</span>
<span class="quote">&gt;&gt; know which devices among pmu (armv8_pmuv3_0, breakpoint, software)</span>
<span class="quote">&gt;&gt; devices, these jevents to be added.</span>
<span class="quote">&gt;&gt; also this json file is specific to a arch/soc/board, it is not a</span>
<span class="quote">&gt;&gt; generic file to be common.</span>
<span class="quote">&gt;</span>
<span class="quote">&gt; This file describe the events of a CPU PMU, and CPUs are not specific to</span>
<span class="quote">&gt; a platform in general. There are many systems using Cortex-A57, for</span>
<span class="quote">&gt; example.</span>
<span class="quote">&gt;</span>
<span class="quote">&gt; Across big.LITTLE SoCs with Cortex-A57, there&#39;s no guarantee as to</span>
<span class="quote">&gt; whether the Cortex-A57 cores would be named armv8_pmuv3_0, or</span>
<span class="quote">&gt; armv8_pmuv3_1, etc. This would depend on the boot CPU, probe order of</span>
<span class="quote">&gt; secondaries, etc.</span>

OK, we may not have complete name however, common part can be used to recognize
the PMU CORE devices from /sys/bus/event_source/devices
i.e we can have CPU id as &quot;armv8_pmuv3&quot;.

same is extended to UNCORE as well.

mapfile.csv file will have entry for both BIG and LITTLE processors event files.
the jevents creates table of pmu_events_map for all entries present in
mapfile.csv file
while lookup, which ever pmu matches the cpuid of pmu_events_map
then corresponding table created from json file is used to add the
jevents to that PMU.
<span class="quote">
&gt;</span>
<span class="quote">&gt; I appreciate that your platform is homnogeneous, and you may not expect</span>
<span class="quote">&gt; the core to be reused in any heterogeneous system. However, I think that</span>
<span class="quote">&gt; if we&#39;re going to make this work for arm64 we should handle the general</span>
<span class="quote">&gt; case, rather than only having it support a limited set of platforms.</span>
<span class="quote">&gt;</span>
<span class="quote">&gt; Currently, we don&#39;t have an &quot;official&quot; way of identifying which PMUs are</span>
<span class="quote">&gt; CPU PMUs, but one way we could idtentify them would be to look at if</span>
<span class="quote">&gt; they have a &quot;cpus&quot; attribute under sysfs (rather than a &quot;cpumask&quot;</span>
<span class="quote">&gt; attribute).</span>
<span class="quote">&gt;</span>
<span class="quote">&gt; Thanks,</span>
<span class="quote">&gt; Mark.</span>

thanks
Ganapat
</pre>
</div>

<div class="comment">
<div class="meta"><a href="/project/LKML/list/?submitter=30282">Mark Rutland</a> - April 6, 2017, 9:55 a.m.</div>
<pre class="content">
On Thu, Apr 06, 2017 at 09:50:33AM +0530, Ganapatrao Kulkarni wrote:
<span class="quote">&gt; On Wed, Apr 5, 2017 at 3:35 PM, Mark Rutland &lt;mark.rutland@arm.com&gt; wrote:</span>
<span class="quote">&gt; &gt; On Wed, Apr 05, 2017 at 02:42:39PM +0530, Ganapatrao Kulkarni wrote:</span>
<span class="quote">&gt; &gt;&gt; On Tue, Apr 4, 2017 at 5:58 PM, Mark Rutland &lt;mark.rutland@arm.com&gt; wrote:</span>
<span class="quote">&gt; &gt;&gt; &gt; On Tue, Apr 04, 2017 at 01:06:43PM +0530, Ganapatrao Kulkarni wrote:</span>
<span class="quote">
&gt; &gt;&gt; &gt;&gt; +     &quot;CPU&quot; :&quot;armv8_pmuv3_0&quot;</span>
<span class="quote">&gt; &gt;&gt; &gt;</span>
<span class="quote">&gt; &gt;&gt; &gt; Please let&#39;s not hard-code the name like this. Surely we can get rid of this?</span>
<span class="quote">&gt; &gt;&gt; &gt;</span>
<span class="quote">&gt; &gt;&gt; &gt; The kernel doesn&#39;t currently name PMUs as armv8_pmuv3_*, and as that can</span>
<span class="quote">&gt; &gt;&gt; &gt; differ across DT/ACPI and in big.LITTLE, I don&#39;t think it makes sense to</span>
<span class="quote">&gt; &gt;&gt; &gt; try to rely one particular string regardless.</span>
<span class="quote">&gt; &gt;&gt;</span>
<span class="quote">&gt; &gt;&gt; This string/name is fixed for a platform. having name here is essential to</span>
<span class="quote">&gt; &gt;&gt; know which devices among pmu (armv8_pmuv3_0, breakpoint, software)</span>
<span class="quote">&gt; &gt;&gt; devices, these jevents to be added.</span>
<span class="quote">&gt; &gt;&gt; also this json file is specific to a arch/soc/board, it is not a</span>
<span class="quote">&gt; &gt;&gt; generic file to be common.</span>
<span class="quote">&gt; &gt;</span>
<span class="quote">&gt; &gt; This file describe the events of a CPU PMU, and CPUs are not specific to</span>
<span class="quote">&gt; &gt; a platform in general. There are many systems using Cortex-A57, for</span>
<span class="quote">&gt; &gt; example.</span>
<span class="quote">&gt; &gt;</span>
<span class="quote">&gt; &gt; Across big.LITTLE SoCs with Cortex-A57, there&#39;s no guarantee as to</span>
<span class="quote">&gt; &gt; whether the Cortex-A57 cores would be named armv8_pmuv3_0, or</span>
<span class="quote">&gt; &gt; armv8_pmuv3_1, etc. This would depend on the boot CPU, probe order of</span>
<span class="quote">&gt; &gt; secondaries, etc.</span>
<span class="quote">&gt; </span>
<span class="quote">&gt; OK, we may not have complete name however, common part can be used to recognize</span>
<span class="quote">&gt; the PMU CORE devices from /sys/bus/event_source/devices</span>
<span class="quote">&gt; i.e we can have CPU id as &quot;armv8_pmuv3&quot;.</span>

For better or worse, that&#39;s not the case on DT systems.

I&#39;d much rather that we identified the CPU PMUs without requiring
particular names (e.g by looking for a &quot;cpus&quot; attribute).
<span class="quote">
&gt; same is extended to UNCORE as well.</span>

Could you elaborate on that? I&#39;m not sure I follow.
<span class="quote">
&gt; mapfile.csv file will have entry for both BIG and LITTLE processors event files.</span>
<span class="quote">&gt; the jevents creates table of pmu_events_map for all entries present in</span>
<span class="quote">&gt; mapfile.csv file</span>
<span class="quote">&gt; while lookup, which ever pmu matches the cpuid of pmu_events_map</span>
<span class="quote">&gt; then corresponding table created from json file is used to add the</span>
<span class="quote">&gt; jevents to that PMU.</span>

Sorry, but I don&#39;t follow how that&#39;s related to the above.

Thanks,
Mark.
</pre>
</div>

<div class="comment">
<div class="meta"><a href="/project/LKML/list/?submitter=106031">Ganapatrao Kulkarni</a> - April 19, 2017, 6:07 p.m.</div>
<pre class="content">
Hi Mark,


On Thu, Apr 6, 2017 at 3:25 PM, Mark Rutland &lt;mark.rutland@arm.com&gt; wrote:
<span class="quote">&gt; On Thu, Apr 06, 2017 at 09:50:33AM +0530, Ganapatrao Kulkarni wrote:</span>
<span class="quote">&gt;&gt; On Wed, Apr 5, 2017 at 3:35 PM, Mark Rutland &lt;mark.rutland@arm.com&gt; wrote:</span>
<span class="quote">&gt;&gt; &gt; On Wed, Apr 05, 2017 at 02:42:39PM +0530, Ganapatrao Kulkarni wrote:</span>
<span class="quote">&gt;&gt; &gt;&gt; On Tue, Apr 4, 2017 at 5:58 PM, Mark Rutland &lt;mark.rutland@arm.com&gt; wrote:</span>
<span class="quote">&gt;&gt; &gt;&gt; &gt; On Tue, Apr 04, 2017 at 01:06:43PM +0530, Ganapatrao Kulkarni wrote:</span>
<span class="quote">&gt;</span>
<span class="quote">&gt;&gt; &gt;&gt; &gt;&gt; +     &quot;CPU&quot; :&quot;armv8_pmuv3_0&quot;</span>
<span class="quote">&gt;&gt; &gt;&gt; &gt;</span>
<span class="quote">&gt;&gt; &gt;&gt; &gt; Please let&#39;s not hard-code the name like this. Surely we can get rid of this?</span>
<span class="quote">&gt;&gt; &gt;&gt; &gt;</span>
<span class="quote">&gt;&gt; &gt;&gt; &gt; The kernel doesn&#39;t currently name PMUs as armv8_pmuv3_*, and as that can</span>
<span class="quote">&gt;&gt; &gt;&gt; &gt; differ across DT/ACPI and in big.LITTLE, I don&#39;t think it makes sense to</span>
<span class="quote">&gt;&gt; &gt;&gt; &gt; try to rely one particular string regardless.</span>
<span class="quote">&gt;&gt; &gt;&gt;</span>
<span class="quote">&gt;&gt; &gt;&gt; This string/name is fixed for a platform. having name here is essential to</span>
<span class="quote">&gt;&gt; &gt;&gt; know which devices among pmu (armv8_pmuv3_0, breakpoint, software)</span>
<span class="quote">&gt;&gt; &gt;&gt; devices, these jevents to be added.</span>
<span class="quote">&gt;&gt; &gt;&gt; also this json file is specific to a arch/soc/board, it is not a</span>
<span class="quote">&gt;&gt; &gt;&gt; generic file to be common.</span>
<span class="quote">&gt;&gt; &gt;</span>
<span class="quote">&gt;&gt; &gt; This file describe the events of a CPU PMU, and CPUs are not specific to</span>
<span class="quote">&gt;&gt; &gt; a platform in general. There are many systems using Cortex-A57, for</span>
<span class="quote">&gt;&gt; &gt; example.</span>
<span class="quote">&gt;&gt; &gt;</span>
<span class="quote">&gt;&gt; &gt; Across big.LITTLE SoCs with Cortex-A57, there&#39;s no guarantee as to</span>
<span class="quote">&gt;&gt; &gt; whether the Cortex-A57 cores would be named armv8_pmuv3_0, or</span>
<span class="quote">&gt;&gt; &gt; armv8_pmuv3_1, etc. This would depend on the boot CPU, probe order of</span>
<span class="quote">&gt;&gt; &gt; secondaries, etc.</span>

some of the applications(perf etc) use sysfs files of perf PMU CORE devices.
at present the names are created as per SOC/platform like
armv8_pmuv3, armv8_cavium_thunder,  armv8_cortex_a57 etc.

cpu_pmu-&gt;name                   = &quot;armv8_cavium_thunder&quot;;

can we please have common name similar to x86(cpu) and call them as
cpu_0 and cpu_1?
<span class="quote">
&gt;&gt;</span>
<span class="quote">&gt;&gt; OK, we may not have complete name however, common part can be used to recognize</span>
<span class="quote">&gt;&gt; the PMU CORE devices from /sys/bus/event_source/devices</span>
<span class="quote">&gt;&gt; i.e we can have CPU id as &quot;armv8_pmuv3&quot;.</span>
<span class="quote">&gt;</span>
<span class="quote">&gt; For better or worse, that&#39;s not the case on DT systems.</span>
<span class="quote">&gt;</span>
<span class="quote">&gt; I&#39;d much rather that we identified the CPU PMUs without requiring</span>
<span class="quote">&gt; particular names (e.g by looking for a &quot;cpus&quot; attribute).</span>
<span class="quote">&gt;</span>
<span class="quote">&gt;&gt; same is extended to UNCORE as well.</span>
<span class="quote">&gt;</span>
<span class="quote">&gt; Could you elaborate on that? I&#39;m not sure I follow.</span>
<span class="quote">&gt;</span>
<span class="quote">&gt;&gt; mapfile.csv file will have entry for both BIG and LITTLE processors event files.</span>
<span class="quote">&gt;&gt; the jevents creates table of pmu_events_map for all entries present in</span>
<span class="quote">&gt;&gt; mapfile.csv file</span>
<span class="quote">&gt;&gt; while lookup, which ever pmu matches the cpuid of pmu_events_map</span>
<span class="quote">&gt;&gt; then corresponding table created from json file is used to add the</span>
<span class="quote">&gt;&gt; jevents to that PMU.</span>
<span class="quote">&gt;</span>
<span class="quote">&gt; Sorry, but I don&#39;t follow how that&#39;s related to the above.</span>
<span class="quote">&gt;</span>
<span class="quote">&gt; Thanks,</span>
<span class="quote">&gt; Mark.</span>

thanks
Ganapat
</pre>
</div>

<div class="comment">
<div class="meta"><a href="/project/LKML/list/?submitter=30282">Mark Rutland</a> - April 20, 2017, 8:53 a.m.</div>
<pre class="content">
On Wed, Apr 19, 2017 at 11:37:31PM +0530, Ganapatrao Kulkarni wrote:
<span class="quote">&gt; Hi Mark,</span>

Hi,
<span class="quote">
&gt; On Thu, Apr 6, 2017 at 3:25 PM, Mark Rutland &lt;mark.rutland@arm.com&gt; wrote:</span>
<span class="quote">&gt; &gt; On Thu, Apr 06, 2017 at 09:50:33AM +0530, Ganapatrao Kulkarni wrote:</span>
<span class="quote">&gt; &gt;&gt; On Wed, Apr 5, 2017 at 3:35 PM, Mark Rutland &lt;mark.rutland@arm.com&gt; wrote:</span>
<span class="quote">&gt; &gt;&gt; &gt; On Wed, Apr 05, 2017 at 02:42:39PM +0530, Ganapatrao Kulkarni wrote:</span>
<span class="quote">&gt; &gt;&gt; &gt;&gt; On Tue, Apr 4, 2017 at 5:58 PM, Mark Rutland &lt;mark.rutland@arm.com&gt; wrote:</span>
<span class="quote">&gt; &gt;&gt; &gt;&gt; &gt; On Tue, Apr 04, 2017 at 01:06:43PM +0530, Ganapatrao Kulkarni wrote:</span>
<span class="quote">&gt; &gt;</span>
<span class="quote">&gt; &gt;&gt; &gt;&gt; &gt;&gt; +     &quot;CPU&quot; :&quot;armv8_pmuv3_0&quot;</span>
<span class="quote">&gt; &gt;&gt; &gt;&gt; &gt;</span>
<span class="quote">&gt; &gt;&gt; &gt;&gt; &gt; Please let&#39;s not hard-code the name like this. Surely we can get rid of this?</span>
<span class="quote">&gt; &gt;&gt; &gt;&gt; &gt;</span>
<span class="quote">&gt; &gt;&gt; &gt;&gt; &gt; The kernel doesn&#39;t currently name PMUs as armv8_pmuv3_*, and as that can</span>
<span class="quote">&gt; &gt;&gt; &gt;&gt; &gt; differ across DT/ACPI and in big.LITTLE, I don&#39;t think it makes sense to</span>
<span class="quote">&gt; &gt;&gt; &gt;&gt; &gt; try to rely one particular string regardless.</span>
<span class="quote">&gt; &gt;&gt; &gt;&gt;</span>
<span class="quote">&gt; &gt;&gt; &gt;&gt; This string/name is fixed for a platform. having name here is essential to</span>
<span class="quote">&gt; &gt;&gt; &gt;&gt; know which devices among pmu (armv8_pmuv3_0, breakpoint, software)</span>
<span class="quote">&gt; &gt;&gt; &gt;&gt; devices, these jevents to be added.</span>
<span class="quote">&gt; &gt;&gt; &gt;&gt; also this json file is specific to a arch/soc/board, it is not a</span>
<span class="quote">&gt; &gt;&gt; &gt;&gt; generic file to be common.</span>
<span class="quote">&gt; &gt;&gt; &gt;</span>
<span class="quote">&gt; &gt;&gt; &gt; This file describe the events of a CPU PMU, and CPUs are not specific to</span>
<span class="quote">&gt; &gt;&gt; &gt; a platform in general. There are many systems using Cortex-A57, for</span>
<span class="quote">&gt; &gt;&gt; &gt; example.</span>
<span class="quote">&gt; &gt;&gt; &gt;</span>
<span class="quote">&gt; &gt;&gt; &gt; Across big.LITTLE SoCs with Cortex-A57, there&#39;s no guarantee as to</span>
<span class="quote">&gt; &gt;&gt; &gt; whether the Cortex-A57 cores would be named armv8_pmuv3_0, or</span>
<span class="quote">&gt; &gt;&gt; &gt; armv8_pmuv3_1, etc. This would depend on the boot CPU, probe order of</span>
<span class="quote">&gt; &gt;&gt; &gt; secondaries, etc.</span>
<span class="quote">&gt; </span>
<span class="quote">&gt; some of the applications(perf etc) use sysfs files of perf PMU CORE devices.</span>
<span class="quote">&gt; at present the names are created as per SOC/platform like</span>
<span class="quote">&gt; armv8_pmuv3, armv8_cavium_thunder,  armv8_cortex_a57 etc.</span>
<span class="quote">&gt; </span>
<span class="quote">&gt; cpu_pmu-&gt;name                   = &quot;armv8_cavium_thunder&quot;;</span>
<span class="quote">&gt; </span>
<span class="quote">&gt; can we please have common name similar to x86(cpu) and call them as</span>
<span class="quote">&gt; cpu_0 and cpu_1?</span>

I don&#39;t see how that helps in this case?

I&#39;d rather that we expose some mechanism to determine whether a PMU is a
CPU PMU, other than the name. Userspace can then throw away the name if
it so wishes, and it doesn&#39;t have the potential to break existing users.

Thanks,
Mark.
</pre>
</div>



<h2>Patch</h2>
<div class="patch">
<pre class="content">
<span class="p_header">diff --git a/tools/perf/pmu-events/arch/arm64/mapfile.csv b/tools/perf/pmu-events/arch/arm64/mapfile.csv</span>
new file mode 100644
<span class="p_header">index 0000000..ba30e43</span>
<span class="p_header">--- /dev/null</span>
<span class="p_header">+++ b/tools/perf/pmu-events/arch/arm64/mapfile.csv</span>
<span class="p_chunk">@@ -0,0 +1,2 @@</span> <span class="p_context"></span>
<span class="p_add">+Family-model,Version,Filename,EventType</span>
<span class="p_add">+0x00000000420f5161,v1,thunderx2,core</span>
<span class="p_header">diff --git a/tools/perf/pmu-events/arch/arm64/thunderx2/implementation-defined.json b/tools/perf/pmu-events/arch/arm64/thunderx2/implementation-defined.json</span>
new file mode 100644
<span class="p_header">index 0000000..360e084</span>
<span class="p_header">--- /dev/null</span>
<span class="p_header">+++ b/tools/perf/pmu-events/arch/arm64/thunderx2/implementation-defined.json</span>
<span class="p_chunk">@@ -0,0 +1,72 @@</span> <span class="p_context"></span>
<span class="p_add">+[</span>
<span class="p_add">+    {</span>
<span class="p_add">+        &quot;PublicDescription&quot;: &quot;Attributable Level 1 data cache access, read&quot;,</span>
<span class="p_add">+        &quot;EventCode&quot;: &quot;0x40&quot;,</span>
<span class="p_add">+        &quot;EventName&quot;: &quot;l1d_cache_access_read&quot;,</span>
<span class="p_add">+        &quot;BriefDescription&quot;: &quot;l1d cache access, read&quot;,</span>
<span class="p_add">+	&quot;CPU&quot; :&quot;armv8_pmuv3_0&quot;</span>
<span class="p_add">+    },</span>
<span class="p_add">+    {</span>
<span class="p_add">+        &quot;PublicDescription&quot;: &quot;Attributable Level 1 data cache access, write &quot;,</span>
<span class="p_add">+        &quot;EventCode&quot;: &quot;0x41&quot;,</span>
<span class="p_add">+        &quot;EventName&quot;: &quot;l1d_cache_access_write&quot;,</span>
<span class="p_add">+        &quot;BriefDescription&quot;: &quot;l1d cache access, write&quot;,</span>
<span class="p_add">+	&quot;CPU&quot; :&quot;armv8_pmuv3_0&quot;</span>
<span class="p_add">+    },</span>
<span class="p_add">+    {</span>
<span class="p_add">+        &quot;PublicDescription&quot;: &quot;Attributable Level 1 data cache refill, read&quot;,</span>
<span class="p_add">+        &quot;EventCode&quot;: &quot;0x42&quot;,</span>
<span class="p_add">+        &quot;EventName&quot;: &quot;l1d_cache_refill_read&quot;,</span>
<span class="p_add">+        &quot;BriefDescription&quot;: &quot;l1d cache refill, read&quot;,</span>
<span class="p_add">+	&quot;CPU&quot; :&quot;armv8_pmuv3_0&quot;</span>
<span class="p_add">+    },</span>
<span class="p_add">+    {</span>
<span class="p_add">+        &quot;PublicDescription&quot;: &quot;Attributable Level 1 data cache refill, write&quot;,</span>
<span class="p_add">+        &quot;EventCode&quot;: &quot;0x43&quot;,</span>
<span class="p_add">+        &quot;EventName&quot;: &quot;l1d_cache_refill_write&quot;,</span>
<span class="p_add">+        &quot;BriefDescription&quot;: &quot;l1d refill, write&quot;,</span>
<span class="p_add">+	&quot;CPU&quot; :&quot;armv8_pmuv3_0&quot;</span>
<span class="p_add">+    },</span>
<span class="p_add">+    {</span>
<span class="p_add">+        &quot;PublicDescription&quot;: &quot;Attributable Level 1 data TLB refill, read&quot;,</span>
<span class="p_add">+        &quot;EventCode&quot;: &quot;0x4C&quot;,</span>
<span class="p_add">+        &quot;EventName&quot;: &quot;l1d_tlb_refill_read&quot;,</span>
<span class="p_add">+        &quot;BriefDescription&quot;: &quot;l1d tlb refill, read&quot;,</span>
<span class="p_add">+	&quot;CPU&quot; :&quot;armv8_pmuv3_0&quot;</span>
<span class="p_add">+    },</span>
<span class="p_add">+    {</span>
<span class="p_add">+        &quot;PublicDescription&quot;: &quot;Attributable Level 1 data TLB refill, write&quot;,</span>
<span class="p_add">+        &quot;EventCode&quot;: &quot;0x4D&quot;,</span>
<span class="p_add">+        &quot;EventName&quot;: &quot;l1d_tlb_refill_write&quot;,</span>
<span class="p_add">+        &quot;BriefDescription&quot;: &quot;l1d tlb refill, write&quot;,</span>
<span class="p_add">+	&quot;CPU&quot; :&quot;armv8_pmuv3_0&quot;</span>
<span class="p_add">+    },</span>
<span class="p_add">+    {</span>
<span class="p_add">+        &quot;PublicDescription&quot;: &quot;Attributable Level 1 data or unified TLB access, read&quot;,</span>
<span class="p_add">+        &quot;EventCode&quot;: &quot;0x4E&quot;,</span>
<span class="p_add">+        &quot;EventName&quot;: &quot;l1d_tlb_read&quot;,</span>
<span class="p_add">+        &quot;BriefDescription&quot;: &quot;l1d tlb, read&quot;,</span>
<span class="p_add">+	&quot;CPU&quot; :&quot;armv8_pmuv3_0&quot;</span>
<span class="p_add">+    },</span>
<span class="p_add">+    {</span>
<span class="p_add">+        &quot;PublicDescription&quot;: &quot;Attributable Level 1 data or unified TLB access, write&quot;,</span>
<span class="p_add">+        &quot;EventCode&quot;: &quot;0x4F&quot;,</span>
<span class="p_add">+        &quot;EventName&quot;: &quot;l1d_tlb_write&quot;,</span>
<span class="p_add">+        &quot;BriefDescription&quot;: &quot;l1d tlb, write&quot;,</span>
<span class="p_add">+	&quot;CPU&quot; :&quot;armv8_pmuv3_0&quot;</span>
<span class="p_add">+    },</span>
<span class="p_add">+    {</span>
<span class="p_add">+        &quot;PublicDescription&quot;: &quot;Bus access, read&quot;,</span>
<span class="p_add">+        &quot;EventCode&quot;: &quot;0x60&quot;,</span>
<span class="p_add">+        &quot;EventName&quot;: &quot;bus_access_read&quot;,</span>
<span class="p_add">+        &quot;BriefDescription&quot;: &quot;Bus access, read&quot;,</span>
<span class="p_add">+	&quot;CPU&quot; :&quot;armv8_pmuv3_0&quot;</span>
<span class="p_add">+   },</span>
<span class="p_add">+   {</span>
<span class="p_add">+        &quot;PublicDescription&quot;: &quot;Bus access, write&quot;,</span>
<span class="p_add">+        &quot;EventCode&quot;: &quot;0x61&quot;,</span>
<span class="p_add">+        &quot;EventName&quot;: &quot;bus_access_write&quot;,</span>
<span class="p_add">+        &quot;BriefDescription&quot;: &quot;Bus access, write&quot;,</span>
<span class="p_add">+	&quot;CPU&quot; :&quot;armv8_pmuv3_0&quot;</span>
<span class="p_add">+   }</span>
<span class="p_add">+]</span>

</pre>
</div>




  </div>
  <div id="footer">
   <a href="http://jk.ozlabs.org/projects/patchwork/">patchwork</a>
   patch tracking system
  </div>
 </body>
</html>



